import{_ as o,C as p,o as r,c as d,j as e,a,E as t,aA as l,w as n}from"./chunks/framework.BYAr3f1p.js";const Ye=JSON.parse('{"title":"List of all functions","description":"","frontmatter":{},"headers":[],"relativePath":"man/listfunctions.md","filePath":"man/listfunctions.md","lastUpdated":null}'),u={name:"man/listfunctions.md"},h={class:"jldocstring custom-block",open:""},c={class:"jldocstring custom-block",open:""},k={class:"jldocstring custom-block",open:""},g={class:"jldocstring custom-block",open:""},y={class:"jldocstring custom-block",open:""},b={class:"jldocstring custom-block",open:""},T={class:"jldocstring custom-block",open:""},f={class:"jldocstring custom-block",open:""},_={class:"jldocstring custom-block",open:""},m={class:"jldocstring custom-block",open:""},E={class:"jldocstring custom-block",open:""},x={class:"jldocstring custom-block",open:""},A={class:"jldocstring custom-block",open:""},R={class:"jldocstring custom-block",open:""},v={class:"jldocstring custom-block",open:""},C={class:"jldocstring custom-block",open:""},j={class:"jldocstring custom-block",open:""},J={class:"jldocstring custom-block",open:""},D={class:"jldocstring custom-block",open:""},F={class:"jldocstring custom-block",open:""},P={class:"jldocstring custom-block",open:""},N={class:"jldocstring custom-block",open:""},V={class:"jldocstring custom-block",open:""},S={class:"jldocstring custom-block",open:""},B={class:"jldocstring custom-block",open:""},I={class:"jldocstring custom-block",open:""},L={class:"jldocstring custom-block",open:""},M={class:"jldocstring custom-block",open:""},w={class:"jldocstring custom-block",open:""},O={class:"jldocstring custom-block",open:""},U={class:"jldocstring custom-block",open:""},z={class:"jldocstring custom-block",open:""},Y={class:"jldocstring custom-block",open:""},q={class:"jldocstring custom-block",open:""},K={class:"jldocstring custom-block",open:""},G={class:"jldocstring custom-block",open:""},W={class:"jldocstring custom-block",open:""},H={class:"jldocstring custom-block",open:""},Q={class:"jldocstring custom-block",open:""},$={class:"jldocstring custom-block",open:""},X={class:"jldocstring custom-block",open:""},Z={class:"jldocstring custom-block",open:""},ss={class:"jldocstring custom-block",open:""},es={class:"jldocstring custom-block",open:""},is={class:"jldocstring custom-block",open:""},ts={class:"jldocstring custom-block",open:""},as={class:"jldocstring custom-block",open:""},ls={class:"jldocstring custom-block",open:""},ns={class:"jldocstring custom-block",open:""},os={class:"jldocstring custom-block",open:""},ps={class:"jldocstring custom-block",open:""},rs={class:"jldocstring custom-block",open:""},ds={class:"jldocstring custom-block",open:""},us={class:"jldocstring custom-block",open:""},hs={class:"jldocstring custom-block",open:""},cs={class:"jldocstring custom-block",open:""},ks={class:"jldocstring custom-block",open:""},gs={class:"jldocstring custom-block",open:""},ys={class:"jldocstring custom-block",open:""},bs={class:"jldocstring custom-block",open:""},Ts={class:"jldocstring custom-block",open:""},fs={class:"jldocstring custom-block",open:""},_s={class:"jldocstring custom-block",open:""},ms={class:"jldocstring custom-block",open:""},Es={class:"jldocstring custom-block",open:""},xs={class:"jldocstring custom-block",open:""},As={class:"jldocstring custom-block",open:""},Rs={class:"jldocstring custom-block",open:""},vs={class:"jldocstring custom-block",open:""},Cs={class:"jldocstring custom-block",open:""},js={class:"jldocstring custom-block",open:""},Js={class:"jldocstring custom-block",open:""},Ds={class:"jldocstring custom-block",open:""},Fs={class:"jldocstring custom-block",open:""},Ps={class:"jldocstring custom-block",open:""},Ns={class:"jldocstring custom-block",open:""},Vs={class:"jldocstring custom-block",open:""},Ss={class:"jldocstring custom-block",open:""},Bs={class:"jldocstring custom-block",open:""},Is={class:"jldocstring custom-block",open:""},Ls={class:"jldocstring custom-block",open:""},Ms={class:"jldocstring custom-block",open:""},ws={class:"jldocstring custom-block",open:""},Os={class:"jldocstring custom-block",open:""},Us={class:"jldocstring custom-block",open:""},zs={class:"jldocstring custom-block",open:""},Ys={class:"jldocstring custom-block",open:""},qs={class:"jldocstring custom-block",open:""},Ks={class:"jldocstring custom-block",open:""},Gs={class:"jldocstring custom-block",open:""},Ws={class:"jldocstring custom-block",open:""},Hs={class:"jldocstring custom-block",open:""},Qs={class:"jldocstring custom-block",open:""},$s={class:"jldocstring custom-block",open:""},Xs={class:"jldocstring custom-block",open:""},Zs={class:"jldocstring custom-block",open:""},se={class:"jldocstring custom-block",open:""},ee={class:"jldocstring custom-block",open:""},ie={class:"jldocstring custom-block",open:""},te={class:"jldocstring custom-block",open:""},ae={class:"jldocstring custom-block",open:""},le={class:"jldocstring custom-block",open:""},ne={class:"jldocstring custom-block",open:""},oe={class:"jldocstring custom-block",open:""},pe={class:"jldocstring custom-block",open:""},re={class:"jldocstring custom-block",open:""},de={class:"jldocstring custom-block",open:""},ue={class:"jldocstring custom-block",open:""},he={class:"jldocstring custom-block",open:""},ce={class:"jldocstring custom-block",open:""},ke={class:"jldocstring custom-block",open:""},ge={class:"jldocstring custom-block",open:""},ye={class:"jldocstring custom-block",open:""},be={class:"jldocstring custom-block",open:""},Te={class:"jldocstring custom-block",open:""},fe={class:"jldocstring custom-block",open:""},_e={class:"jldocstring custom-block",open:""},me={class:"jldocstring custom-block",open:""},Ee={class:"jldocstring custom-block",open:""},xe={class:"jldocstring custom-block",open:""},Ae={class:"jldocstring custom-block",open:""},Re={class:"jldocstring custom-block",open:""},ve={class:"jldocstring custom-block",open:""},Ce={class:"jldocstring custom-block",open:""},je={class:"jldocstring custom-block",open:""},Je={class:"jldocstring custom-block",open:""},De={class:"jldocstring custom-block",open:""},Fe={class:"jldocstring custom-block",open:""},Pe={class:"jldocstring custom-block",open:""},Ne={class:"jldocstring custom-block",open:""},Ve={class:"jldocstring custom-block",open:""},Se={class:"jldocstring custom-block",open:""},Be={class:"jldocstring custom-block",open:""};function Ie(Le,s,Me,we,Oe,Ue){const i=p("Badge");return r(),d("div",null,[s[532]||(s[532]=e("h1",{id:"List-of-all-functions",tabindex:"-1"},[a("List of all functions "),e("a",{class:"header-anchor",href:"#List-of-all-functions","aria-label":'Permalink to "List of all functions {#List-of-all-functions}"'},"​")],-1)),s[533]||(s[533]=e("p",null,"Here an overview of all functions:",-1)),e("details",h,[e("summary",null,[s[0]||(s[0]=e("a",{id:"JustRelax.DYREL",href:"#JustRelax.DYREL"},[e("span",{class:"jlbinding"},"JustRelax.DYREL")],-1)),s[1]||(s[1]=a()),t(i,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[3]||(s[3]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DYREL{T, F}</span></span></code></pre></div><p>Structure containing parameters and arrays for the DYREL (Dynamic Relaxation) solver.</p><p><strong>Fields</strong></p><ul><li><p><code>γ_eff</code>: Effective penalty parameter.</p></li><li><p><code>Dx</code>, <code>Dy</code>, <code>Dz</code>: Diagonal preconditioners for velocity updates in x, y, (and z) directions.</p></li><li><p><code>λmaxVx</code>, <code>λmaxVy</code>, <code>λmaxVz</code>: Maximum eigenvalues for stability calculation.</p></li><li><p><code>dVxdτ</code>, <code>dVydτ</code>, <code>dVzdτ</code>: Pseudo-time step related damping terms.</p></li><li><p><code>dτVx</code>, <code>dτVy</code>, <code>dτVz</code>: Pseudo-time steps for velocity fields.</p></li><li><p><code>dVx</code>, <code>dVy</code>, <code>dVz</code>: Velocity increments for the current iteration.</p></li><li><p><code>βVx</code>, <code>βVy</code>, <code>βVz</code>: Damping coefficients for momentum equation.</p></li><li><p><code>cVx</code>, <code>cVy</code>, <code>cVz</code>: Damping coefficients related to dynamic relaxation.</p></li><li><p><code>αVx</code>, <code>αVy</code>, <code>αVz</code>: Scaling factors for damping.</p></li><li><p><code>ηb</code>: Bulk viscosity field.</p></li><li><p><code>CFL</code>: Courant-Friedrichs-Lewy number.</p></li><li><p><code>ϵ</code>: General convergence tolerance.</p></li><li><p><code>ϵ_vel</code>: Velocity convergence tolerance.</p></li><li><p><code>c_fact</code>: Damping scaling factor.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[2]||(s[2]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/types.jl#L1-L21",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",c,[e("summary",null,[s[4]||(s[4]=e("a",{id:"JustRelax.Geometry",href:"#JustRelax.Geometry"},[e("span",{class:"jlbinding"},"JustRelax.Geometry")],-1)),s[5]||(s[5]=a()),t(i,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[7]||(s[7]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Geometry{nDim,T}</span></span></code></pre></div><p>A struct representing the geometry of a topological object in nDim dimensions.</p><p><strong>Arguments</strong></p><ul><li><p><code>nDim</code>: The number of dimensions of the topological object.</p></li><li><p><code>T</code>: The type of the elements in the topological object.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[6]||(s[6]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/topology/Topology.jl#L15-L23",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",k,[e("summary",null,[s[8]||(s[8]=e("a",{id:"JustRelax.velocity_grids-Union{Tuple{T}, Tuple{Any, Any, Tuple{T, T}}} where T",href:"#JustRelax.velocity_grids-Union{Tuple{T}, Tuple{Any, Any, Tuple{T, T}}} where T"},[e("span",{class:"jlbinding"},"JustRelax.velocity_grids")],-1)),s[9]||(s[9]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[11]||(s[11]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity_grids</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xci, xvi, di</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N,T}</span></span></code></pre></div><p>Compute the velocity grids for N dimensionional problems.</p><p><strong>Arguments</strong></p><ul><li><p><code>xci</code>: The x-coordinate of the cell centers.</p></li><li><p><code>xvi</code>: The x-coordinate of the cell vertices.</p></li><li><p><code>di</code>: A tuple containing the cell dimensions.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[10]||(s[10]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/topology/Topology.jl#L124-L133",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",g,[e("summary",null,[s[12]||(s[12]=e("a",{id:"JustRelax.versioninfo",href:"#JustRelax.versioninfo"},[e("span",{class:"jlbinding"},"JustRelax.versioninfo")],-1)),s[13]||(s[13]=a()),t(i,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[15]||(s[15]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">versioninfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; verbose</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Print information about the version of JustRelax in use. The output includes:</p><ul><li><p>JustRelax version and installation method</p></li><li><p>Git commit information (if available)</p></li><li><p>Platform information</p></li><li><p>Julia version</p></li><li><p>Key dependencies (verbose mode)</p></li><li><p>Environment variables (verbose mode)</p></li></ul><p>The output is controlled with boolean keyword arguments:</p><ul><li><code>verbose</code>: print all additional information including dependencies and environment</li></ul><p>See also: <code>Base.versioninfo()</code>.</p>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[14]||(s[14]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/JustRelax.jl#L51-L67",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",y,[e("summary",null,[s[16]||(s[16]=e("a",{id:"JustRelax.JustRelax2D.DYREL!-Tuple{JustRelax.DYREL, JustRelax.StokesArrays, Vararg{Any, 4}}",href:"#JustRelax.JustRelax2D.DYREL!-Tuple{JustRelax.DYREL, JustRelax.StokesArrays, Vararg{Any, 4}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.DYREL!")],-1)),s[17]||(s[17]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[19]||(s[19]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyrel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, stokes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rheology, phase_ratios, di, dt; CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, γfact</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Updates the fields of the <code>DYREL</code> struct in-place for the current time step.</p><p>This function recomputes:</p><ul><li><p>Bulk viscosity and penalty parameter <code>γ_eff</code>.</p></li><li><p>Gershgorin estimates for eigenvalues and preconditioners.</p></li><li><p>Damping coefficients.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>dyrel</code>: <code>JustRelax.DYREL</code> struct to modify.</p></li><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> containing current simulation state.</p></li><li><p><code>rheology</code>, <code>phase_ratios</code>: Material properties.</p></li><li><p><code>di</code>: Grid spacing.</p></li><li><p><code>dt</code>: Current time step.</p></li><li><p><code>CFL</code>: Courant number (default: 0.99).</p></li><li><p><code>γfact</code>: Penalty factor (default: 20.0).</p></li></ul><p>Returns <code>nothing</code>.</p>',7)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[18]||(s[18]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L144-L164",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",b,[e("summary",null,[s[20]||(s[20]=e("a",{id:"JustRelax.JustRelax2D.DYREL-Tuple{JustRelax.StokesArrays, Vararg{Any, 4}}",href:"#JustRelax.JustRelax2D.DYREL-Tuple{JustRelax.StokesArrays, Vararg{Any, 4}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.DYREL")],-1)),s[21]||(s[21]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[23]||(s[23]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, rheology, phase_ratios, di, dt; ϵ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ϵ_vel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, c_fat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, γfact</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Constructs and initializes a <code>DYREL</code> object based on existing Stokes fields.</p><p>This function:</p><ol><li><p>Allocates zero-initialized arrays using grid dimensions from <code>stokes</code>.</p></li><li><p>Computes initial bulk viscosity and penalty parameters.</p></li><li><p>Computes Gershgorin estimates for eigenvalues and preconditioners.</p></li><li><p>Updates damping coefficients.</p></li></ol><p><strong>Arguments</strong></p><ul><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> struct.</p></li><li><p><code>rheology</code>: Material properties.</p></li><li><p><code>phase_ratios</code>: Phase fraction information.</p></li><li><p><code>di</code>: Grid spacing tuple.</p></li><li><p><code>dt</code>: Time step.</p></li><li><p><code>γfact</code>: Factor for penalty parameter calculation (default: 20.0).</p></li></ul>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[22]||(s[22]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L105-L123",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",T,[e("summary",null,[s[24]||(s[24]=e("a",{id:"JustRelax.JustRelax2D.DYREL-Tuple{Tuple{T, T} where T}",href:"#JustRelax.JustRelax2D.DYREL-Tuple{Tuple{T, T} where T}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.DYREL")],-1)),s[25]||(s[25]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[27]||(s[27]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; ϵ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ϵ_vel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, c_fat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> N</span></span></code></pre></div><p>Creates a new <code>DYREL</code> struct with fields initialized to zero.</p><p><strong>Arguments</strong></p><ul><li><p><code>ni</code>: Tuple containing the grid dimensions <code>(nx, ny)</code> for 2D or <code>(nx, ny, nz)</code> for 3D.</p></li><li><p><code>ϵ</code>: General convergence tolerance.</p></li><li><p><code>ϵ_vel</code>: Velocity convergence tolerance.</p></li><li><p><code>CFL</code>: Courant-Friedrichs-Lewy number.</p></li><li><p><code>c_fat</code>: Damping scaling factor.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[26]||(s[26]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L1-L12",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",f,[e("summary",null,[s[28]||(s[28]=e("a",{id:"JustRelax.JustRelax2D.StokesArrays-Union{Tuple{NTuple{N, Integer}}, Tuple{N}} where N",href:"#JustRelax.JustRelax2D.StokesArrays-Union{Tuple{NTuple{N, Integer}}, Tuple{N}} where N"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.StokesArrays")],-1)),s[29]||(s[29]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[31]||(s[31]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N}</span></span></code></pre></div><p>Create the Stokes arrays object in 2D or 3D.</p><p><strong>Fields</strong></p><ul><li><p><code>P</code>: Pressure field</p></li><li><p><code>P0</code>: Previous pressure field</p></li><li><p><code>∇V</code>: Velocity gradient</p></li><li><p><code>V</code>: Velocity fields</p></li><li><p><code>Q</code>: Volumetric source/sink term e.g. <code>ΔV/V_tot [m³/m³]</code></p></li><li><p><code>U</code>: Displacement fields</p></li><li><p><code>ω</code>: Vorticity field</p></li><li><p><code>τ</code>: Stress tensors</p></li><li><p><code>τ_o</code>: Old stress tensors</p></li><li><p><code>ε</code>: Strain rate tensors</p></li><li><p><code>ε_pl</code>: Plastic strain rate tensors</p></li><li><p><code>EII_pl</code>: Second invariant of the accumulated plastic strain</p></li><li><p><code>viscosity</code>: Viscosity fields</p></li><li><p><code>R</code>: Residual fields</p></li><li><p><code>Δε</code>: Strain increment tensor</p></li><li><p><code>∇U</code>: Displacement gradient</p></li><li><p><code>λ</code> : plastic multiplier @ centers</p></li><li><p><code>λv</code> : plastic multiplier @ vertices</p></li><li><p><code>ΔPψ</code> : pressure correction in dilatant case</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[30]||(s[30]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/types/constructors/stokes.jl#L138-L163",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",_,[e("summary",null,[s[32]||(s[32]=e("a",{id:"JustRelax.JustRelax2D.WENO_advection!-NTuple{5, Any}",href:"#JustRelax.JustRelax2D.WENO_advection!-NTuple{5, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.WENO_advection!")],-1)),s[33]||(s[33]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[35]||(s[35]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WENO_advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u, Vxi, weno, di, ni, dt)</span></span></code></pre></div><p>Perform the advection step of the Weighted Essentially Non-Oscillatory (WENO) scheme for the solution of hyperbolic partial differential equations.</p><p><strong>Arguments</strong></p><ul><li><p><code>u</code>: field to be advected.</p></li><li><p><code>Vxi</code>: velocity field.</p></li><li><p><code>weno</code>: structure containing the WENO scheme parameters and temporary variables.</p></li><li><p><code>di</code>: grid spacing.</p></li><li><p><code>ni</code>: number of grid points.</p></li><li><p><code>dt</code>: time step.</p></li></ul><p><strong>Description</strong></p><p>The function approximates the advected fluxes using the WENO scheme and use a strong-stability preserving (SSP) Runge-Kutta method of order 3 for the time integration.</p>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[34]||(s[34]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/advection/weno5.jl#L178-L193",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",m,[e("summary",null,[s[36]||(s[36]=e("a",{id:"JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}",href:"#JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D._heatdiffusion_PT!")],-1)),s[37]||(s[37]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[39]||(s[39]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatdiffusion_PT!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(thermal, pt_thermal, K, ρCp, dt, di; iterMax, nout, verbose)</span></span></code></pre></div><p>Heat diffusion solver using Pseudo-Transient iterations. Both <code>K</code> and <code>ρCp</code> are n-dimensional arrays.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[38]||(s[38]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/thermal_diffusion/DiffusionPT_solver.jl#L9-L13",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",E,[e("summary",null,[s[40]||(s[40]=e("a",{id:"JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}",href:"#JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D._heatdiffusion_PT!")],-1)),s[41]||(s[41]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[43]||(s[43]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatdiffusion_PT!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(thermal, pt_thermal, rheology, dt, di; iterMax, nout, verbose)</span></span></code></pre></div><p>Heat diffusion solver using Pseudo-Transient iterations.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[42]||(s[42]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/thermal_diffusion/DiffusionPT_solver.jl#L114-L118",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",x,[e("summary",null,[s[44]||(s[44]=e("a",{id:"JustRelax.JustRelax2D.allzero-Union{NTuple{N, T}, Tuple{N}, Tuple{T}} where {T, N}",href:"#JustRelax.JustRelax2D.allzero-Union{NTuple{N, T}, Tuple{N}, Tuple{T}} where {T, N}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.allzero")],-1)),s[45]||(s[45]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[47]||(s[47]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">allzero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vararg{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T,N}</span></span></code></pre></div><p>Check if all elements in <code>x</code> are zero.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vararg{T,N}</code>: The input array.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if all elements in <code>x</code> are zero, <code>false</code> otherwise.</li></ul>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[46]||(s[46]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L479-L489",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",A,[e("summary",null,[s[48]||(s[48]=e("a",{id:"JustRelax.JustRelax2D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}",href:"#JustRelax.JustRelax2D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.assign!")],-1)),s[49]||(s[49]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[51]||(s[51]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">assign!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T,N}</span></span></code></pre></div><p>Assigns the values of array <code>A</code> to array <code>B</code> in parallel.</p><p><strong>Arguments</strong></p><ul><li><p><code>B::AbstractArray{T,N}</code>: The destination array.</p></li><li><p><code>A::AbstractArray{T,N}</code>: The source array.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[50]||(s[50]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L519-L527",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",R,[e("summary",null,[s[52]||(s[52]=e("a",{id:"JustRelax.JustRelax2D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Any, NTuple{N, MaterialParams}, Any, Any, Any, Any, NamedTuple}} where N",href:"#JustRelax.JustRelax2D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Any, NTuple{N, MaterialParams}, Any, Any, Any, Any, NamedTuple}} where N"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_P!")],-1)),s[53]||(s[53]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[55]||(s[55]=l("<p>compute_P!(P, P0, RP, ∇V, Q, ΔTc, η, rheology::NTuple{N,MaterialParams}, phase_ratio::C, dt, r, θ_dτ)</p><p>Compute the pressure field <code>P</code> and the residual <code>RP</code> for the compressible case. This function introduces thermal stresses after the implementation of Kiss et al. (2023).</p><p><strong>Arguments</strong></p><ul><li><p><code>P</code>: pressure field</p></li><li><p><code>RP</code>: residual field</p></li><li><p><code>∇V</code>: divergence of the velocity field</p></li><li><p><code>Q</code>: volumetric source/sink term which should have the properties of <code>dV/V_tot [m³/m³]</code> normalized per cell, default is zero.</p></li><li><p><code>ΔTc</code>: temperature difference on the cell center, to account for thermal stresses. The thermal expansivity <code>α</code> is computed from the material parameters.</p></li><li><p><code>η</code>: viscosity field</p></li><li><p><code>rheology</code>: material parameters</p></li><li><p><code>phase_ratio</code>: phase field</p></li></ul>",4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[54]||(s[54]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/stokes/PressureKernels.jl#L28-L42",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",v,[e("summary",null,[s[56]||(s[56]=e("a",{id:"JustRelax.JustRelax2D.compute_bulk_viscosity_and_penalty!-NTuple{6, Any}",href:"#JustRelax.JustRelax2D.compute_bulk_viscosity_and_penalty!-NTuple{6, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_bulk_viscosity_and_penalty!")],-1)),s[57]||(s[57]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[59]||(s[59]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_bulk_viscosity_and_penalty!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyrel, stokes, rheology, phase_ratios, γfact, dt)</span></span></code></pre></div><p>Computes the bulk viscosity <code>ηb</code> and the effective penalty parameter <code>γ_eff</code>.</p><ol><li><strong>Bulk Viscosity (<code>ηb</code>)</strong>: Computed based on the bulk modulus of the material phases.</li></ol><ul><li><p>If <code>Kb</code> is infinite (incompressible), <code>ηb</code> defaults to <code>γfact * η_mean</code>.</p></li><li><p>Otherwise <code>ηb = Kb * dt</code>.</p></li></ul><ol start="2"><li><strong>Penalty Parameter (<code>γ_eff</code>)</strong>: A combination of numerical (<code>γ_num</code>) and physical (<code>γ_phy</code>) penalty terms.</li></ol><ul><li><p><code>γ_num = γfact * η_mean</code></p></li><li><p><code>γ_phy = Kb</code> (or related term)</p></li><li><p><code>γ_eff = (γ_phy * γ_num) / (γ_phy + γ_num)</code></p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>dyrel</code>: <code>JustRelax.DYREL</code> struct to update.</p></li><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code>.</p></li><li><p><code>rheology</code>: Material properties.</p></li><li><p><code>phase_ratios</code>: Phase fraction information.</p></li><li><p><code>γfact</code>: Numerical factor for penalty parameter (default: 20.0).</p></li><li><p><code>dt</code>: Time step.</p></li></ul><p>This function parallelizes the computation across grid cells.</p>',9)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[58]||(s[58]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L193-L216",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",C,[e("summary",null,[s[60]||(s[60]=e("a",{id:"JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any, Any}",href:"#JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_buoyancy")],-1)),s[61]||(s[61]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[63]||(s[63]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology, args, phase_ratios)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The rheology used to compute the buoyancy forces.</p></li><li><p><code>args</code>: Additional arguments required by the rheology.</p></li><li><p><code>phase_ratios</code>: The ratios of the different phases.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[62]||(s[62]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L137-L146",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",j,[e("summary",null,[s[64]||(s[64]=e("a",{id:"JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any}",href:"#JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_buoyancy")],-1)),s[65]||(s[65]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[67]||(s[67]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology, args)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology and arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The rheology used to compute the buoyancy forces.</p></li><li><p><code>args</code>: Additional arguments required for the computation.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[66]||(s[66]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L124-L132",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",J,[e("summary",null,[s[68]||(s[68]=e("a",{id:"JustRelax.JustRelax2D.compute_buoyancy-Tuple{MaterialParams, Any, Any}",href:"#JustRelax.JustRelax2D.compute_buoyancy-Tuple{MaterialParams, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_buoyancy")],-1)),s[69]||(s[69]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[71]||(s[71]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaterialParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args, phase_ratios)</span></span></code></pre></div><p>Compute the buoyancy forces for a given set of material parameters, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The material parameters.</p></li><li><p><code>args</code>: The arguments.</p></li><li><p><code>phase_ratios</code>: The phase ratios.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[70]||(s[70]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L110-L119",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",D,[e("summary",null,[s[72]||(s[72]=e("a",{id:"JustRelax.JustRelax2D.compute_buoyancy-Tuple{MaterialParams, Any}",href:"#JustRelax.JustRelax2D.compute_buoyancy-Tuple{MaterialParams, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_buoyancy")],-1)),s[73]||(s[73]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[75]||(s[75]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaterialParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology parameters and arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology::MaterialParams</code>: The material parameters for the rheology.</p></li><li><p><code>args</code>: The arguments for the computation.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[74]||(s[74]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L97-L105",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",F,[e("summary",null,[s[76]||(s[76]=e("a",{id:"JustRelax.JustRelax2D.compute_dt-Tuple{JustRelax.StokesArrays, Vararg{Any}}",href:"#JustRelax.JustRelax2D.compute_dt-Tuple{JustRelax.StokesArrays, Vararg{Any}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_dt")],-1)),s[77]||(s[77]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[79]||(s[79]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_dt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the time step <code>dt</code> for the simulation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[78]||(s[78]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L445-L449",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",P,[e("summary",null,[s[80]||(s[80]=e("a",{id:"JustRelax.JustRelax2D.compute_maxloc!-Tuple{Any, Any}",href:"#JustRelax.JustRelax2D.compute_maxloc!-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_maxloc!")],-1)),s[81]||(s[81]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[83]||(s[83]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maxloc!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B, A; window)</span></span></code></pre></div><p>Compute the maximum value of <code>A</code> in the <code>window = (width_x, width_y, width_z)</code> and store the result in <code>B</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[82]||(s[82]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L371-L375",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",N,[e("summary",null,[s[84]||(s[84]=e("a",{id:"JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, Any, Any}",href:"#JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_ρg!")],-1)),s[85]||(s[85]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[87]||(s[87]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_ρg!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρg, rheology, args)</span></span></code></pre></div><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[86]||(s[86]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L1-L5",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",V,[e("summary",null,[s[88]||(s[88]=e("a",{id:"JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, JustPIC.PhaseRatios, Any, Any}",href:"#JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, JustPIC.PhaseRatios, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.compute_ρg!")],-1)),s[89]||(s[89]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[91]||(s[91]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_ρg!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρg, phase_ratios, rheology, args)</span></span></code></pre></div><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>. The <code>phase_ratios</code> are used to compute the density of the composite rheology.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[90]||(s[90]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L31-L36",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",S,[e("summary",null,[s[92]||(s[92]=e("a",{id:"JustRelax.JustRelax2D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T",href:"#JustRelax.JustRelax2D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.continuation_log")],-1)),s[93]||(s[93]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[95]||(s[95]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">continuation_log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x_new, x_old, ν)</span></span></code></pre></div><p>Do a continuation step <code>exp((1-ν)*log(x_old) + ν*log(x_new))</code> with damping parameter <code>ν</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[94]||(s[94]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L499-L503",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",B,[e("summary",null,[s[96]||(s[96]=e("a",{id:"JustRelax.JustRelax2D.flow_bcs!-Tuple{Any, Any}",href:"#JustRelax.JustRelax2D.flow_bcs!-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.flow_bcs!")],-1)),s[97]||(s[97]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[99]||(s[99]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flow_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VelocityBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[98]||(s[98]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L42-L46",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",I,[e("summary",null,[s[100]||(s[100]=e("a",{id:"JustRelax.JustRelax2D.flow_bcs!-Tuple{CPUBackendTrait, Any, DisplacementBoundaryConditions}",href:"#JustRelax.JustRelax2D.flow_bcs!-Tuple{CPUBackendTrait, Any, DisplacementBoundaryConditions}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.flow_bcs!")],-1)),s[101]||(s[101]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[103]||(s[103]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flow_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DisplacementBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[102]||(s[102]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L53-L57",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",L,[e("summary",null,[s[104]||(s[104]=e("a",{id:"JustRelax.JustRelax2D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, NTuple{N, AbstractMaterialParamsStruct}, Any}} where {N, F}",href:"#JustRelax.JustRelax2D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, NTuple{N, AbstractMaterialParamsStruct}, Any}} where {N, F}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.fn_ratio")],-1)),s[105]||(s[105]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[107]||(s[107]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fn_ratio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractMaterialParamsStruct}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ratio) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N, F}</span></span></code></pre></div><p>Average the function <code>fn</code> over the material phases in <code>rheology</code> using the phase ratios <code>ratio</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[106]||(s[106]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/phases.jl#L1-L5",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",M,[e("summary",null,[s[108]||(s[108]=e("a",{id:"JustRelax.JustRelax2D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}",href:"#JustRelax.JustRelax2D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.interp_Vx_on_Vy!")],-1)),s[109]||(s[109]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[111]||(s[111]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">interp_Vx_on_Vy!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx_on_Vy, Vx)</span></span></code></pre></div><p>Interpolates the values of <code>Vx</code> onto the grid points of <code>Vy</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>Vx_on_Vy::AbstractArray</code>: <code>Vx</code> at <code>Vy</code> grid points.</p></li><li><p><code>Vx::AbstractArray</code>: <code>Vx</code> at its staggered grid points.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[110]||(s[110]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L1-L9",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",w,[e("summary",null,[s[112]||(s[112]=e("a",{id:"JustRelax.JustRelax2D.isvalid_c-Tuple{JustRelax.RockRatio, Any, Any}",href:"#JustRelax.JustRelax2D.isvalid_c-Tuple{JustRelax.RockRatio, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.isvalid_c")],-1)),s[113]||(s[113]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[115]||(s[115]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.center[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[114]||(s[114]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L114-L122",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",O,[e("summary",null,[s[116]||(s[116]=e("a",{id:"JustRelax.JustRelax2D.isvalid_v-Tuple{JustRelax.RockRatio, Any, Any}",href:"#JustRelax.JustRelax2D.isvalid_v-Tuple{JustRelax.RockRatio, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.isvalid_v")],-1)),s[117]||(s[117]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[119]||(s[119]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.vertex[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[118]||(s[118]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L138-L146",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",U,[e("summary",null,[s[120]||(s[120]=e("a",{id:"JustRelax.JustRelax2D.isvalid_vx-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N",href:"#JustRelax.JustRelax2D.isvalid_vx-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.isvalid_vx")],-1)),s[121]||(s[121]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[123]||(s[123]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_vx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.Vx[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[122]||(s[122]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L161-L169",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",z,[e("summary",null,[s[124]||(s[124]=e("a",{id:"JustRelax.JustRelax2D.isvalid_vz-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N",href:"#JustRelax.JustRelax2D.isvalid_vz-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.isvalid_vz")],-1)),s[125]||(s[125]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[127]||(s[127]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_vz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.Vz[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[126]||(s[126]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L206-L214",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Y,[e("summary",null,[s[128]||(s[128]=e("a",{id:"JustRelax.JustRelax2D.solve_DYREL!-Tuple{JustRelax.StokesArrays, Vararg{Any}}",href:"#JustRelax.JustRelax2D.solve_DYREL!-Tuple{JustRelax.StokesArrays, Vararg{Any}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.solve_DYREL!")],-1)),s[129]||(s[129]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[131]||(s[131]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve_DYREL!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs)</span></span></code></pre></div><p>Internal solver implementation for the 2D DYREL method on the CPU.</p><p><strong>Arguments (in the following order)</strong></p><ul><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> containing the simulation fields.</p></li><li><p><code>ρg</code>: buoyancy forces arrays.</p></li><li><p><code>dyrel</code>: DYREL-specific parameters and fields.</p></li><li><p><code>flow_bcs</code>: <code>AbstractFlowBoundaryConditions</code> defining velocity boundary conditions.</p></li><li><p><code>phase_ratios</code>: <code>JustPIC.PhaseRatios</code> for material phase tracking.</p></li><li><p><code>rheology</code>: Material properties and rheological laws.</p></li><li><p><code>args</code>: Tuple of additional arguments needed to update viscosity, stress, and buoyancy forces.</p></li><li><p><code>di</code>: Grid spacing tuple <code>(dx, dy)</code>.</p></li><li><p><code>dt</code>: Time step.</p></li><li><p><code>igg</code>: <code>IGG</code> object for global grid information (MPI).</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>viscosity_cutoff</code>: Limits for viscosity <code>(min, max)</code>. Default: <code>(-Inf, Inf)</code>.</p></li><li><p><code>viscosity_relaxation</code>: Relaxation factor for viscosity updates. Default: <code>1.0e-2</code>.</p></li><li><p><code>λ_relaxation_DR</code>: Relaxation factor for dynamic relaxation. Default: <code>1</code>.</p></li><li><p><code>λ_relaxation_PH</code>: Relaxation factor for Powell-Hestenes iterations. Default: <code>1</code>.</p></li><li><p><code>iterMax</code>: Maximum number of iterations. Default: <code>50.0e3</code>.</p></li><li><p><code>nout</code>: Output frequency for residuals. Default: <code>100</code>.</p></li><li><p><code>rel_drop</code>: Relative residual drop tolerance. Default: <code>1.0e-2</code>.</p></li><li><p><code>verbose_PH</code>: Print Powell-Hestenes iteration info. Default: <code>true</code>.</p></li><li><p><code>verbose_DR</code>: Print Dynamic Relaxation iteration info. Default: <code>true</code>.</p></li><li><p><code>linear_viscosity</code>: Whether to use linear viscosity. Default: <code>false</code>.</p></li></ul>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[130]||(s[130]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/DYREL2D.jl#L2-L30",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",q,[e("summary",null,[s[132]||(s[132]=e("a",{id:"JustRelax.JustRelax2D.take-Tuple{String}",href:"#JustRelax.JustRelax2D.take-Tuple{String}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.take")],-1)),s[133]||(s[133]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[135]||(s[135]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">take</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fldr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Create folder <code>fldr</code> if it does not exist.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[134]||(s[134]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L492-L496",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",K,[e("summary",null,[s[136]||(s[136]=e("a",{id:"JustRelax.JustRelax2D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}",href:"#JustRelax.JustRelax2D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.tensor_invariant!")],-1)),s[137]||(s[137]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[139]||(s[139]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tensor_invariant!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.SymmetricTensor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the tensor invariant of the given symmetric tensor <code>A</code>.</p><p><strong>Arguments</strong></p><ul><li><code>A::JustRelax.SymmetricTensor</code>: The input symmetric tensor.</li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[138]||(s[138]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/stokes/StressKernels.jl#L411-L418",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",G,[e("summary",null,[s[140]||(s[140]=e("a",{id:"JustRelax.JustRelax2D.thermal_bcs!-Tuple{Any, Any}",href:"#JustRelax.JustRelax2D.thermal_bcs!-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.thermal_bcs!")],-1)),s[141]||(s[141]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[143]||(s[143]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">thermal_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TemperatureBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed heat boundary conditions <code>bc</code> on the <code>T</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[142]||(s[142]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L19-L23",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",W,[e("summary",null,[s[144]||(s[144]=e("a",{id:"JustRelax.JustRelax2D.update_dτV_α_β!-Union{Tuple{T}, Tuple{N}, Tuple{NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, Real}} where {N, T}",href:"#JustRelax.JustRelax2D.update_dτV_α_β!-Union{Tuple{T}, Tuple{N}, Tuple{NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, Real}} where {N, T}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.update_dτV_α_β!")],-1)),s[145]||(s[145]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[147]||(s[147]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_dτV_α_β!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dτV, βV, αV, cV, λmaxV, CFL_v)</span></span></code></pre></div><p>Generic N-dimensional version (2D and 3D) for updating pseudo-time step and acceleration parameters.</p><p>Computes the pseudo-time step <code>dτV</code> from the maximum eigenvalue estimate <code>λmaxV</code> and CFL number, then updates the damping parameters <code>βV</code> and acceleration parameters <code>αV</code> accordingly.</p><p><strong>Arguments</strong></p><ul><li><p><code>dτV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of pseudo-time steps for each velocity component</p></li><li><p><code>βV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of damping parameters β for each velocity component</p></li><li><p><code>αV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of acceleration parameters α for each velocity component</p></li><li><p><code>cV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of preconditioner diagonal entries for each velocity component</p></li><li><p><code>λmaxV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of maximum eigenvalue estimates for each velocity component</p></li><li><p><code>CFL_v::Real</code>: CFL number for velocity</p></li></ul>',5)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[146]||(s[146]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/Gershgorin.jl#L166-L181",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",H,[e("summary",null,[s[148]||(s[148]=e("a",{id:"JustRelax.JustRelax2D.update_phase_ratios_2D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T<:AbstractMatrix, N}",href:"#JustRelax.JustRelax2D.update_phase_ratios_2D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T<:AbstractMatrix, N}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.update_phase_ratios_2D!")],-1)),s[149]||(s[149]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[151]||(s[151]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustPIC.PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_arrays</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractMatrix}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, xvi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {B, T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, N}</span></span></code></pre></div><p>JustRelax routine based on <code>JustPIC._2D.update_phase_ratios!</code> or <code>JustPIC._3D.update_phase_ratios!</code>. Update the phase ratios in <code>phase_ratios</code> using the provided <code>phase_arrays</code>, <code>xci</code>, and <code>xvi</code>. The phase arrays need to be AbstractArrays and have values between 0 and 1.</p><p>#Example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx, ny </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_arrays </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (phase_1, phase_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Advect both phase arrays and update phase ratios</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phase_ratios, phase_arrays, xci, xvi)</span></span></code></pre></div>`,4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[150]||(s[150]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/PhaseRatios.jl#L1-L22",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Q,[e("summary",null,[s[152]||(s[152]=e("a",{id:"JustRelax.JustRelax2D.update_phase_ratios_3D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T<:AbstractArray, N}",href:"#JustRelax.JustRelax2D.update_phase_ratios_3D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T<:AbstractArray, N}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.update_phase_ratios_3D!")],-1)),s[153]||(s[153]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[155]||(s[155]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustPIC.PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_arrays</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, xvi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {B, T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, N}</span></span></code></pre></div><p>JustRelax routine based on <code>JustPIC._2D.update_phase_ratios!</code> or <code>JustPIC._3D.update_phase_ratios!</code>. Update the phase ratios in <code>phase_ratios</code> using the provided <code>phase_arrays</code>, <code>xci</code>, and <code>xvi</code>. The phase arrays need to be AbstractArrays and have values between 0 and 1.</p><p>#Example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx, ny, nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_arrays </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (phase_1, phase_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Advect both phase arrays and update phase ratios</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phase_ratios, phase_arrays, xci, xvi)</span></span></code></pre></div>`,4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[154]||(s[154]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/PhaseRatios.jl#L36-L57",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",$,[e("summary",null,[s[156]||(s[156]=e("a",{id:"JustRelax.JustRelax2D.update_rock_ratio!-Union{Tuple{T}, Tuple{JustRelax.RockRatio{T, 2}, Any, Any}} where T",href:"#JustRelax.JustRelax2D.update_rock_ratio!-Union{Tuple{T}, Tuple{JustRelax.RockRatio{T, 2}, Any, Any}} where T"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.update_rock_ratio!")],-1)),s[157]||(s[157]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[159]||(s[159]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_rock_ratio!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_ratios, air_phase)</span></span></code></pre></div><p>Update the rock ratio <code>ϕ</code> based on the provided <code>phase_ratios</code> and <code>air_phase</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The rock ratio object to be updated.</p></li><li><p><code>phase_ratios</code>: The ratios of different phases present.</p></li><li><p><code>air_phase</code>: The phase representing air.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[158]||(s[158]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L38-L47",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",X,[e("summary",null,[s[160]||(s[160]=e("a",{id:"JustRelax.JustRelax2D.update_α_β!-Union{Tuple{T}, Tuple{N}, NTuple{4, NTuple{N, AbstractArray{T, N}}}} where {N, T}",href:"#JustRelax.JustRelax2D.update_α_β!-Union{Tuple{T}, Tuple{N}, NTuple{4, NTuple{N, AbstractArray{T, N}}}} where {N, T}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.update_α_β!")],-1)),s[161]||(s[161]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[163]||(s[163]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_α_β!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(βV, αV, dτV, cV)</span></span></code></pre></div><p>Generic N-dimensional version (2D and 3D) of the acceleration parameters update.</p><p>Updates the damping parameters <code>βV</code> and <code>αV</code> for each velocity component based on the pseudo-time step <code>dτV</code> and the preconditioner diagonal <code>cV</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>βV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of damping parameters β for each velocity component</p></li><li><p><code>αV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of acceleration parameters α for each velocity component</p></li><li><p><code>dτV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of pseudo-time steps for each velocity component</p></li><li><p><code>cV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of preconditioner diagonal entries for each velocity component</p></li></ul>',5)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[162]||(s[162]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/Gershgorin.jl#L123-L136",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Z,[e("summary",null,[s[164]||(s[164]=e("a",{id:"JustRelax.JustRelax2D.velocity2vertex!-NTuple{6, Any}",href:"#JustRelax.JustRelax2D.velocity2vertex!-NTuple{6, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.velocity2vertex!")],-1)),s[165]||(s[165]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[167]||(s[167]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity2vertex!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx_v, Vy_v, Vz_v, Vx, Vy, Vz)</span></span></code></pre></div><p>In-place interpolation of the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes onto the pre-allocated <code>Vx_d</code>, <code>Vy_d</code>, <code>Vz_d</code> 3D arrays located at the grid vertices.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[166]||(s[166]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L229-L234",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ss,[e("summary",null,[s[168]||(s[168]=e("a",{id:"JustRelax.JustRelax2D.velocity2vertex-Tuple{Any, Any, Any}",href:"#JustRelax.JustRelax2D.velocity2vertex-Tuple{Any, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.velocity2vertex")],-1)),s[169]||(s[169]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[171]||(s[171]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity2vertex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx, Vy, Vz)</span></span></code></pre></div><p>Interpolate the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes onto the grid vertices.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[170]||(s[170]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L209-L214",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",es,[e("summary",null,[s[172]||(s[172]=e("a",{id:"JustRelax.JustRelax2D.@add-Tuple{Any, Vararg{Any}}",href:"#JustRelax.JustRelax2D.@add-Tuple{Any, Vararg{Any}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@add")],-1)),s[173]||(s[173]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[175]||(s[175]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(I, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Add <code>I</code> to the scalars in <code>args</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[174]||(s[174]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L52-L56",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",is,[e("summary",null,[s[176]||(s[176]=e("a",{id:"JustRelax.JustRelax2D.@copy-Tuple{Any, Any}",href:"#JustRelax.JustRelax2D.@copy-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@copy")],-1)),s[177]||(s[177]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[179]||(s[179]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B, A)</span></span></code></pre></div><p>convenience macro to copy data from the array <code>A</code> into array <code>B</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[178]||(s[178]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L16-L20",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ts,[e("summary",null,[s[180]||(s[180]=e("a",{id:"JustRelax.JustRelax2D.@displacement-Tuple{Any}",href:"#JustRelax.JustRelax2D.@displacement-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@displacement")],-1)),s[181]||(s[181]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[183]||(s[183]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@displacement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(U)</span></span></code></pre></div><p>Unpacks the displacement arrays <code>U</code> from the StokesArrays <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[182]||(s[182]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L94-L98",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",as,[e("summary",null,[s[184]||(s[184]=e("a",{id:"JustRelax.JustRelax2D.@idx-Tuple",href:"#JustRelax.JustRelax2D.@idx-Tuple"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@idx")],-1)),s[185]||(s[185]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[187]||(s[187]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Make a linear range from <code>1</code> to <code>args[i]</code>, with <code>i ∈ [1, ..., n]</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[186]||(s[186]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L2-L6",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ls,[e("summary",null,[s[188]||(s[188]=e("a",{id:"JustRelax.JustRelax2D.@normal-Tuple{Any}",href:"#JustRelax.JustRelax2D.@normal-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@normal")],-1)),s[189]||(s[189]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[191]||(s[191]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@normal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the normal components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[190]||(s[190]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L259-L264",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ns,[e("summary",null,[s[192]||(s[192]=e("a",{id:"JustRelax.JustRelax2D.@plastic_strain-Tuple{Any}",href:"#JustRelax.JustRelax2D.@plastic_strain-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@plastic_strain")],-1)),s[193]||(s[193]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[195]||(s[195]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@plastic_strain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the plastic strain rate tensor <code>ε_pl</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[194]||(s[194]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L166-L171",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",os,[e("summary",null,[s[196]||(s[196]=e("a",{id:"JustRelax.JustRelax2D.@qT-Tuple{Any}",href:"#JustRelax.JustRelax2D.@qT-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@qT")],-1)),s[197]||(s[197]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[199]||(s[199]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@qT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the flux arrays <code>qT_i</code> from the ThermalArrays <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[198]||(s[198]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L110-L114",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ps,[e("summary",null,[s[200]||(s[200]=e("a",{id:"JustRelax.JustRelax2D.@qT2-Tuple{Any}",href:"#JustRelax.JustRelax2D.@qT2-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@qT2")],-1)),s[201]||(s[201]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[203]||(s[203]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@qT2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the flux arrays <code>qT2_i</code> from the ThermalArrays <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[202]||(s[202]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L125-L129",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",rs,[e("summary",null,[s[204]||(s[204]=e("a",{id:"JustRelax.JustRelax2D.@residuals-Tuple{Any}",href:"#JustRelax.JustRelax2D.@residuals-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@residuals")],-1)),s[205]||(s[205]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[207]||(s[207]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@residuals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the momentum residuals from <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[206]||(s[206]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L347-L351",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ds,[e("summary",null,[s[208]||(s[208]=e("a",{id:"JustRelax.JustRelax2D.@shear-Tuple{Any}",href:"#JustRelax.JustRelax2D.@shear-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@shear")],-1)),s[209]||(s[209]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[211]||(s[211]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@shear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[210]||(s[210]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L213-L218",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",us,[e("summary",null,[s[212]||(s[212]=e("a",{id:"JustRelax.JustRelax2D.@shear_center-Tuple{Any}",href:"#JustRelax.JustRelax2D.@shear_center-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@shear_center")],-1)),s[213]||(s[213]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[215]||(s[215]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@shear_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[214]||(s[214]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L236-L241",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",hs,[e("summary",null,[s[216]||(s[216]=e("a",{id:"JustRelax.JustRelax2D.@strain-Tuple{Any}",href:"#JustRelax.JustRelax2D.@strain-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@strain")],-1)),s[217]||(s[217]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[219]||(s[219]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[218]||(s[218]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L142-L147",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",cs,[e("summary",null,[s[220]||(s[220]=e("a",{id:"JustRelax.JustRelax2D.@strain_center-Tuple{Any}",href:"#JustRelax.JustRelax2D.@strain_center-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@strain_center")],-1)),s[221]||(s[221]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[223]||(s[223]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[222]||(s[222]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L282-L287",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ks,[e("summary",null,[s[224]||(s[224]=e("a",{id:"JustRelax.JustRelax2D.@strain_increment-Tuple{Any}",href:"#JustRelax.JustRelax2D.@strain_increment-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@strain_increment")],-1)),s[225]||(s[225]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[227]||(s[227]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain_increment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[226]||(s[226]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L154-L159",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",gs,[e("summary",null,[s[228]||(s[228]=e("a",{id:"JustRelax.JustRelax2D.@stress-Tuple{Any}",href:"#JustRelax.JustRelax2D.@stress-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@stress")],-1)),s[229]||(s[229]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[231]||(s[231]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@stress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[230]||(s[230]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L178-L183",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ys,[e("summary",null,[s[232]||(s[232]=e("a",{id:"JustRelax.JustRelax2D.@stress_center-Tuple{Any}",href:"#JustRelax.JustRelax2D.@stress_center-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@stress_center")],-1)),s[233]||(s[233]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[235]||(s[235]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@stress_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[234]||(s[234]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L294-L299",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",bs,[e("summary",null,[s[236]||(s[236]=e("a",{id:"JustRelax.JustRelax2D.@tensor-Tuple{Any}",href:"#JustRelax.JustRelax2D.@tensor-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@tensor")],-1)),s[237]||(s[237]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[239]||(s[239]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@tensor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[238]||(s[238]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L190-L195",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ts,[e("summary",null,[s[240]||(s[240]=e("a",{id:"JustRelax.JustRelax2D.@tensor_center-Tuple{Any}",href:"#JustRelax.JustRelax2D.@tensor_center-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@tensor_center")],-1)),s[241]||(s[241]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[243]||(s[243]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@tensor_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[242]||(s[242]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L306-L311",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",fs,[e("summary",null,[s[244]||(s[244]=e("a",{id:"JustRelax.JustRelax2D.@tensor_vertex-Tuple{Any}",href:"#JustRelax.JustRelax2D.@tensor_vertex-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@tensor_vertex")],-1)),s[245]||(s[245]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[247]||(s[247]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tensor_vertex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the vertices of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[246]||(s[246]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L329-L334",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",_s,[e("summary",null,[s[248]||(s[248]=e("a",{id:"JustRelax.JustRelax2D.@velocity-Tuple{Any}",href:"#JustRelax.JustRelax2D.@velocity-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax2D.@velocity")],-1)),s[249]||(s[249]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[251]||(s[251]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@velocity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the velocity arrays <code>V</code> from the StokesArrays <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[250]||(s[250]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L79-L83",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ms,[e("summary",null,[s[252]||(s[252]=e("a",{id:"JustRelax.JustRelax3D.DYREL!-Tuple{JustRelax.DYREL, JustRelax.StokesArrays, Vararg{Any, 4}}",href:"#JustRelax.JustRelax3D.DYREL!-Tuple{JustRelax.DYREL, JustRelax.StokesArrays, Vararg{Any, 4}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.DYREL!")],-1)),s[253]||(s[253]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[255]||(s[255]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyrel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, stokes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rheology, phase_ratios, di, dt; CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, γfact</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Updates the fields of the <code>DYREL</code> struct in-place for the current time step.</p><p>This function recomputes:</p><ul><li><p>Bulk viscosity and penalty parameter <code>γ_eff</code>.</p></li><li><p>Gershgorin estimates for eigenvalues and preconditioners.</p></li><li><p>Damping coefficients.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>dyrel</code>: <code>JustRelax.DYREL</code> struct to modify.</p></li><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> containing current simulation state.</p></li><li><p><code>rheology</code>, <code>phase_ratios</code>: Material properties.</p></li><li><p><code>di</code>: Grid spacing.</p></li><li><p><code>dt</code>: Current time step.</p></li><li><p><code>CFL</code>: Courant number (default: 0.99).</p></li><li><p><code>γfact</code>: Penalty factor (default: 20.0).</p></li></ul><p>Returns <code>nothing</code>.</p>',7)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[254]||(s[254]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L144-L164",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Es,[e("summary",null,[s[256]||(s[256]=e("a",{id:"JustRelax.JustRelax3D.DYREL-Tuple{JustRelax.StokesArrays, Vararg{Any, 4}}",href:"#JustRelax.JustRelax3D.DYREL-Tuple{JustRelax.StokesArrays, Vararg{Any, 4}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.DYREL")],-1)),s[257]||(s[257]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[259]||(s[259]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, rheology, phase_ratios, di, dt; ϵ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ϵ_vel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, c_fat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, γfact</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Constructs and initializes a <code>DYREL</code> object based on existing Stokes fields.</p><p>This function:</p><ol><li><p>Allocates zero-initialized arrays using grid dimensions from <code>stokes</code>.</p></li><li><p>Computes initial bulk viscosity and penalty parameters.</p></li><li><p>Computes Gershgorin estimates for eigenvalues and preconditioners.</p></li><li><p>Updates damping coefficients.</p></li></ol><p><strong>Arguments</strong></p><ul><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> struct.</p></li><li><p><code>rheology</code>: Material properties.</p></li><li><p><code>phase_ratios</code>: Phase fraction information.</p></li><li><p><code>di</code>: Grid spacing tuple.</p></li><li><p><code>dt</code>: Time step.</p></li><li><p><code>γfact</code>: Factor for penalty parameter calculation (default: 20.0).</p></li></ul>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[258]||(s[258]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L105-L123",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",xs,[e("summary",null,[s[260]||(s[260]=e("a",{id:"JustRelax.JustRelax3D.DYREL-Tuple{Tuple{T, T} where T}",href:"#JustRelax.JustRelax3D.DYREL-Tuple{Tuple{T, T} where T}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.DYREL")],-1)),s[261]||(s[261]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[263]||(s[263]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; ϵ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ϵ_vel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, c_fat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> N</span></span></code></pre></div><p>Creates a new <code>DYREL</code> struct with fields initialized to zero.</p><p><strong>Arguments</strong></p><ul><li><p><code>ni</code>: Tuple containing the grid dimensions <code>(nx, ny)</code> for 2D or <code>(nx, ny, nz)</code> for 3D.</p></li><li><p><code>ϵ</code>: General convergence tolerance.</p></li><li><p><code>ϵ_vel</code>: Velocity convergence tolerance.</p></li><li><p><code>CFL</code>: Courant-Friedrichs-Lewy number.</p></li><li><p><code>c_fat</code>: Damping scaling factor.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[262]||(s[262]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L1-L12",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",As,[e("summary",null,[s[264]||(s[264]=e("a",{id:"JustRelax.JustRelax3D.StokesArrays-Union{Tuple{NTuple{N, Integer}}, Tuple{N}} where N",href:"#JustRelax.JustRelax3D.StokesArrays-Union{Tuple{NTuple{N, Integer}}, Tuple{N}} where N"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.StokesArrays")],-1)),s[265]||(s[265]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[267]||(s[267]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N}</span></span></code></pre></div><p>Create the Stokes arrays object in 2D or 3D.</p><p><strong>Fields</strong></p><ul><li><p><code>P</code>: Pressure field</p></li><li><p><code>P0</code>: Previous pressure field</p></li><li><p><code>∇V</code>: Velocity gradient</p></li><li><p><code>V</code>: Velocity fields</p></li><li><p><code>Q</code>: Volumetric source/sink term e.g. <code>ΔV/V_tot [m³/m³]</code></p></li><li><p><code>U</code>: Displacement fields</p></li><li><p><code>ω</code>: Vorticity field</p></li><li><p><code>τ</code>: Stress tensors</p></li><li><p><code>τ_o</code>: Old stress tensors</p></li><li><p><code>ε</code>: Strain rate tensors</p></li><li><p><code>ε_pl</code>: Plastic strain rate tensors</p></li><li><p><code>EII_pl</code>: Second invariant of the accumulated plastic strain</p></li><li><p><code>viscosity</code>: Viscosity fields</p></li><li><p><code>R</code>: Residual fields</p></li><li><p><code>Δε</code>: Strain increment tensor</p></li><li><p><code>∇U</code>: Displacement gradient</p></li><li><p><code>λ</code> : plastic multiplier @ centers</p></li><li><p><code>λv</code> : plastic multiplier @ vertices</p></li><li><p><code>ΔPψ</code> : pressure correction in dilatant case</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[266]||(s[266]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/types/constructors/stokes.jl#L138-L163",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Rs,[e("summary",null,[s[268]||(s[268]=e("a",{id:"JustRelax.JustRelax3D.WENO_advection!-NTuple{5, Any}",href:"#JustRelax.JustRelax3D.WENO_advection!-NTuple{5, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.WENO_advection!")],-1)),s[269]||(s[269]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[271]||(s[271]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WENO_advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u, Vxi, weno, di, ni, dt)</span></span></code></pre></div><p>Perform the advection step of the Weighted Essentially Non-Oscillatory (WENO) scheme for the solution of hyperbolic partial differential equations.</p><p><strong>Arguments</strong></p><ul><li><p><code>u</code>: field to be advected.</p></li><li><p><code>Vxi</code>: velocity field.</p></li><li><p><code>weno</code>: structure containing the WENO scheme parameters and temporary variables.</p></li><li><p><code>di</code>: grid spacing.</p></li><li><p><code>ni</code>: number of grid points.</p></li><li><p><code>dt</code>: time step.</p></li></ul><p><strong>Description</strong></p><p>The function approximates the advected fluxes using the WENO scheme and use a strong-stability preserving (SSP) Runge-Kutta method of order 3 for the time integration.</p>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[270]||(s[270]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/advection/weno5.jl#L178-L193",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",vs,[e("summary",null,[s[272]||(s[272]=e("a",{id:"JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}",href:"#JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D._heatdiffusion_PT!")],-1)),s[273]||(s[273]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[275]||(s[275]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatdiffusion_PT!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(thermal, pt_thermal, K, ρCp, dt, di; iterMax, nout, verbose)</span></span></code></pre></div><p>Heat diffusion solver using Pseudo-Transient iterations. Both <code>K</code> and <code>ρCp</code> are n-dimensional arrays.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[274]||(s[274]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/thermal_diffusion/DiffusionPT_solver.jl#L9-L13",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Cs,[e("summary",null,[s[276]||(s[276]=e("a",{id:"JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}",href:"#JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D._heatdiffusion_PT!")],-1)),s[277]||(s[277]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[279]||(s[279]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatdiffusion_PT!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(thermal, pt_thermal, rheology, dt, di; iterMax, nout, verbose)</span></span></code></pre></div><p>Heat diffusion solver using Pseudo-Transient iterations.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[278]||(s[278]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/thermal_diffusion/DiffusionPT_solver.jl#L114-L118",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",js,[e("summary",null,[s[280]||(s[280]=e("a",{id:"JustRelax.JustRelax3D.allzero-Union{NTuple{N, T}, Tuple{N}, Tuple{T}} where {T, N}",href:"#JustRelax.JustRelax3D.allzero-Union{NTuple{N, T}, Tuple{N}, Tuple{T}} where {T, N}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.allzero")],-1)),s[281]||(s[281]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[283]||(s[283]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">allzero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vararg{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T,N}</span></span></code></pre></div><p>Check if all elements in <code>x</code> are zero.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vararg{T,N}</code>: The input array.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if all elements in <code>x</code> are zero, <code>false</code> otherwise.</li></ul>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[282]||(s[282]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L479-L489",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Js,[e("summary",null,[s[284]||(s[284]=e("a",{id:"JustRelax.JustRelax3D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}",href:"#JustRelax.JustRelax3D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.assign!")],-1)),s[285]||(s[285]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[287]||(s[287]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">assign!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T,N}</span></span></code></pre></div><p>Assigns the values of array <code>A</code> to array <code>B</code> in parallel.</p><p><strong>Arguments</strong></p><ul><li><p><code>B::AbstractArray{T,N}</code>: The destination array.</p></li><li><p><code>A::AbstractArray{T,N}</code>: The source array.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[286]||(s[286]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L519-L527",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ds,[e("summary",null,[s[288]||(s[288]=e("a",{id:"JustRelax.JustRelax3D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Any, NTuple{N, MaterialParams}, Any, Any, Any, Any, NamedTuple}} where N",href:"#JustRelax.JustRelax3D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Any, NTuple{N, MaterialParams}, Any, Any, Any, Any, NamedTuple}} where N"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_P!")],-1)),s[289]||(s[289]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[291]||(s[291]=l("<p>compute_P!(P, P0, RP, ∇V, Q, ΔTc, η, rheology::NTuple{N,MaterialParams}, phase_ratio::C, dt, r, θ_dτ)</p><p>Compute the pressure field <code>P</code> and the residual <code>RP</code> for the compressible case. This function introduces thermal stresses after the implementation of Kiss et al. (2023).</p><p><strong>Arguments</strong></p><ul><li><p><code>P</code>: pressure field</p></li><li><p><code>RP</code>: residual field</p></li><li><p><code>∇V</code>: divergence of the velocity field</p></li><li><p><code>Q</code>: volumetric source/sink term which should have the properties of <code>dV/V_tot [m³/m³]</code> normalized per cell, default is zero.</p></li><li><p><code>ΔTc</code>: temperature difference on the cell center, to account for thermal stresses. The thermal expansivity <code>α</code> is computed from the material parameters.</p></li><li><p><code>η</code>: viscosity field</p></li><li><p><code>rheology</code>: material parameters</p></li><li><p><code>phase_ratio</code>: phase field</p></li></ul>",4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[290]||(s[290]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/stokes/PressureKernels.jl#L28-L42",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Fs,[e("summary",null,[s[292]||(s[292]=e("a",{id:"JustRelax.JustRelax3D.compute_bulk_viscosity_and_penalty!-NTuple{6, Any}",href:"#JustRelax.JustRelax3D.compute_bulk_viscosity_and_penalty!-NTuple{6, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_bulk_viscosity_and_penalty!")],-1)),s[293]||(s[293]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[295]||(s[295]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_bulk_viscosity_and_penalty!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyrel, stokes, rheology, phase_ratios, γfact, dt)</span></span></code></pre></div><p>Computes the bulk viscosity <code>ηb</code> and the effective penalty parameter <code>γ_eff</code>.</p><ol><li><strong>Bulk Viscosity (<code>ηb</code>)</strong>: Computed based on the bulk modulus of the material phases.</li></ol><ul><li><p>If <code>Kb</code> is infinite (incompressible), <code>ηb</code> defaults to <code>γfact * η_mean</code>.</p></li><li><p>Otherwise <code>ηb = Kb * dt</code>.</p></li></ul><ol start="2"><li><strong>Penalty Parameter (<code>γ_eff</code>)</strong>: A combination of numerical (<code>γ_num</code>) and physical (<code>γ_phy</code>) penalty terms.</li></ol><ul><li><p><code>γ_num = γfact * η_mean</code></p></li><li><p><code>γ_phy = Kb</code> (or related term)</p></li><li><p><code>γ_eff = (γ_phy * γ_num) / (γ_phy + γ_num)</code></p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>dyrel</code>: <code>JustRelax.DYREL</code> struct to update.</p></li><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code>.</p></li><li><p><code>rheology</code>: Material properties.</p></li><li><p><code>phase_ratios</code>: Phase fraction information.</p></li><li><p><code>γfact</code>: Numerical factor for penalty parameter (default: 20.0).</p></li><li><p><code>dt</code>: Time step.</p></li></ul><p>This function parallelizes the computation across grid cells.</p>',9)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[294]||(s[294]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L193-L216",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ps,[e("summary",null,[s[296]||(s[296]=e("a",{id:"JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any, Any}",href:"#JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_buoyancy")],-1)),s[297]||(s[297]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[299]||(s[299]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology, args, phase_ratios)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The rheology used to compute the buoyancy forces.</p></li><li><p><code>args</code>: Additional arguments required by the rheology.</p></li><li><p><code>phase_ratios</code>: The ratios of the different phases.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[298]||(s[298]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L137-L146",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ns,[e("summary",null,[s[300]||(s[300]=e("a",{id:"JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any}",href:"#JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_buoyancy")],-1)),s[301]||(s[301]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[303]||(s[303]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology, args)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology and arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The rheology used to compute the buoyancy forces.</p></li><li><p><code>args</code>: Additional arguments required for the computation.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[302]||(s[302]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L124-L132",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Vs,[e("summary",null,[s[304]||(s[304]=e("a",{id:"JustRelax.JustRelax3D.compute_buoyancy-Tuple{MaterialParams, Any, Any}",href:"#JustRelax.JustRelax3D.compute_buoyancy-Tuple{MaterialParams, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_buoyancy")],-1)),s[305]||(s[305]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[307]||(s[307]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaterialParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args, phase_ratios)</span></span></code></pre></div><p>Compute the buoyancy forces for a given set of material parameters, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The material parameters.</p></li><li><p><code>args</code>: The arguments.</p></li><li><p><code>phase_ratios</code>: The phase ratios.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[306]||(s[306]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L110-L119",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ss,[e("summary",null,[s[308]||(s[308]=e("a",{id:"JustRelax.JustRelax3D.compute_buoyancy-Tuple{MaterialParams, Any}",href:"#JustRelax.JustRelax3D.compute_buoyancy-Tuple{MaterialParams, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_buoyancy")],-1)),s[309]||(s[309]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[311]||(s[311]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaterialParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology parameters and arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology::MaterialParams</code>: The material parameters for the rheology.</p></li><li><p><code>args</code>: The arguments for the computation.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[310]||(s[310]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L97-L105",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Bs,[e("summary",null,[s[312]||(s[312]=e("a",{id:"JustRelax.JustRelax3D.compute_dt-Tuple{JustRelax.StokesArrays, Vararg{Any}}",href:"#JustRelax.JustRelax3D.compute_dt-Tuple{JustRelax.StokesArrays, Vararg{Any}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_dt")],-1)),s[313]||(s[313]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[315]||(s[315]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_dt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the time step <code>dt</code> for the simulation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[314]||(s[314]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L445-L449",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Is,[e("summary",null,[s[316]||(s[316]=e("a",{id:"JustRelax.JustRelax3D.compute_maxloc!-Tuple{Any, Any}",href:"#JustRelax.JustRelax3D.compute_maxloc!-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_maxloc!")],-1)),s[317]||(s[317]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[319]||(s[319]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maxloc!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B, A; window)</span></span></code></pre></div><p>Compute the maximum value of <code>A</code> in the <code>window = (width_x, width_y, width_z)</code> and store the result in <code>B</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[318]||(s[318]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L371-L375",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ls,[e("summary",null,[s[320]||(s[320]=e("a",{id:"JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, Any, Any}",href:"#JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_ρg!")],-1)),s[321]||(s[321]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[323]||(s[323]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_ρg!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρg, rheology, args)</span></span></code></pre></div><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[322]||(s[322]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L1-L5",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ms,[e("summary",null,[s[324]||(s[324]=e("a",{id:"JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, JustPIC.PhaseRatios, Any, Any}",href:"#JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, JustPIC.PhaseRatios, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.compute_ρg!")],-1)),s[325]||(s[325]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[327]||(s[327]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_ρg!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρg, phase_ratios, rheology, args)</span></span></code></pre></div><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>. The <code>phase_ratios</code> are used to compute the density of the composite rheology.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[326]||(s[326]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L31-L36",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ws,[e("summary",null,[s[328]||(s[328]=e("a",{id:"JustRelax.JustRelax3D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T",href:"#JustRelax.JustRelax3D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.continuation_log")],-1)),s[329]||(s[329]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[331]||(s[331]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">continuation_log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x_new, x_old, ν)</span></span></code></pre></div><p>Do a continuation step <code>exp((1-ν)*log(x_old) + ν*log(x_new))</code> with damping parameter <code>ν</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[330]||(s[330]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L499-L503",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Os,[e("summary",null,[s[332]||(s[332]=e("a",{id:"JustRelax.JustRelax3D.flow_bcs!-Tuple{Any, Any}",href:"#JustRelax.JustRelax3D.flow_bcs!-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.flow_bcs!")],-1)),s[333]||(s[333]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[335]||(s[335]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flow_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VelocityBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[334]||(s[334]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L42-L46",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Us,[e("summary",null,[s[336]||(s[336]=e("a",{id:"JustRelax.JustRelax3D.flow_bcs!-Tuple{CPUBackendTrait, Any, DisplacementBoundaryConditions}",href:"#JustRelax.JustRelax3D.flow_bcs!-Tuple{CPUBackendTrait, Any, DisplacementBoundaryConditions}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.flow_bcs!")],-1)),s[337]||(s[337]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[339]||(s[339]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flow_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DisplacementBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[338]||(s[338]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L53-L57",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",zs,[e("summary",null,[s[340]||(s[340]=e("a",{id:"JustRelax.JustRelax3D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, NTuple{N, AbstractMaterialParamsStruct}, Any}} where {N, F}",href:"#JustRelax.JustRelax3D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, NTuple{N, AbstractMaterialParamsStruct}, Any}} where {N, F}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.fn_ratio")],-1)),s[341]||(s[341]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[343]||(s[343]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fn_ratio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractMaterialParamsStruct}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ratio) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N, F}</span></span></code></pre></div><p>Average the function <code>fn</code> over the material phases in <code>rheology</code> using the phase ratios <code>ratio</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[342]||(s[342]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/phases.jl#L1-L5",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ys,[e("summary",null,[s[344]||(s[344]=e("a",{id:"JustRelax.JustRelax3D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}",href:"#JustRelax.JustRelax3D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.interp_Vx_on_Vy!")],-1)),s[345]||(s[345]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[347]||(s[347]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">interp_Vx_on_Vy!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx_on_Vy, Vx)</span></span></code></pre></div><p>Interpolates the values of <code>Vx</code> onto the grid points of <code>Vy</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>Vx_on_Vy::AbstractArray</code>: <code>Vx</code> at <code>Vy</code> grid points.</p></li><li><p><code>Vx::AbstractArray</code>: <code>Vx</code> at its staggered grid points.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[346]||(s[346]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L1-L9",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",qs,[e("summary",null,[s[348]||(s[348]=e("a",{id:"JustRelax.JustRelax3D.isvalid_c-Tuple{JustRelax.RockRatio, Any, Any}",href:"#JustRelax.JustRelax3D.isvalid_c-Tuple{JustRelax.RockRatio, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.isvalid_c")],-1)),s[349]||(s[349]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[351]||(s[351]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.center[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[350]||(s[350]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L114-L122",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ks,[e("summary",null,[s[352]||(s[352]=e("a",{id:"JustRelax.JustRelax3D.isvalid_v-Tuple{JustRelax.RockRatio, Any, Any}",href:"#JustRelax.JustRelax3D.isvalid_v-Tuple{JustRelax.RockRatio, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.isvalid_v")],-1)),s[353]||(s[353]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[355]||(s[355]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.vertex[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[354]||(s[354]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L138-L146",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Gs,[e("summary",null,[s[356]||(s[356]=e("a",{id:"JustRelax.JustRelax3D.isvalid_vx-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N",href:"#JustRelax.JustRelax3D.isvalid_vx-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.isvalid_vx")],-1)),s[357]||(s[357]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[359]||(s[359]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_vx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.Vx[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[358]||(s[358]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L161-L169",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ws,[e("summary",null,[s[360]||(s[360]=e("a",{id:"JustRelax.JustRelax3D.isvalid_vz-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N",href:"#JustRelax.JustRelax3D.isvalid_vz-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.isvalid_vz")],-1)),s[361]||(s[361]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[363]||(s[363]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_vz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.Vz[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[362]||(s[362]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L206-L214",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Hs,[e("summary",null,[s[364]||(s[364]=e("a",{id:"JustRelax.JustRelax3D.take-Tuple{String}",href:"#JustRelax.JustRelax3D.take-Tuple{String}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.take")],-1)),s[365]||(s[365]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[367]||(s[367]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">take</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fldr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Create folder <code>fldr</code> if it does not exist.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[366]||(s[366]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L492-L496",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Qs,[e("summary",null,[s[368]||(s[368]=e("a",{id:"JustRelax.JustRelax3D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}",href:"#JustRelax.JustRelax3D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.tensor_invariant!")],-1)),s[369]||(s[369]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[371]||(s[371]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tensor_invariant!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.SymmetricTensor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the tensor invariant of the given symmetric tensor <code>A</code>.</p><p><strong>Arguments</strong></p><ul><li><code>A::JustRelax.SymmetricTensor</code>: The input symmetric tensor.</li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[370]||(s[370]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/stokes/StressKernels.jl#L411-L418",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",$s,[e("summary",null,[s[372]||(s[372]=e("a",{id:"JustRelax.JustRelax3D.thermal_bcs!-Tuple{Any, Any}",href:"#JustRelax.JustRelax3D.thermal_bcs!-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.thermal_bcs!")],-1)),s[373]||(s[373]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[375]||(s[375]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">thermal_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TemperatureBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed heat boundary conditions <code>bc</code> on the <code>T</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[374]||(s[374]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L19-L23",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Xs,[e("summary",null,[s[376]||(s[376]=e("a",{id:"JustRelax.JustRelax3D.update_dτV_α_β!-Union{Tuple{T}, Tuple{N}, Tuple{NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, Real}} where {N, T}",href:"#JustRelax.JustRelax3D.update_dτV_α_β!-Union{Tuple{T}, Tuple{N}, Tuple{NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, Real}} where {N, T}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.update_dτV_α_β!")],-1)),s[377]||(s[377]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[379]||(s[379]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_dτV_α_β!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dτV, βV, αV, cV, λmaxV, CFL_v)</span></span></code></pre></div><p>Generic N-dimensional version (2D and 3D) for updating pseudo-time step and acceleration parameters.</p><p>Computes the pseudo-time step <code>dτV</code> from the maximum eigenvalue estimate <code>λmaxV</code> and CFL number, then updates the damping parameters <code>βV</code> and acceleration parameters <code>αV</code> accordingly.</p><p><strong>Arguments</strong></p><ul><li><p><code>dτV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of pseudo-time steps for each velocity component</p></li><li><p><code>βV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of damping parameters β for each velocity component</p></li><li><p><code>αV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of acceleration parameters α for each velocity component</p></li><li><p><code>cV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of preconditioner diagonal entries for each velocity component</p></li><li><p><code>λmaxV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of maximum eigenvalue estimates for each velocity component</p></li><li><p><code>CFL_v::Real</code>: CFL number for velocity</p></li></ul>',5)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[378]||(s[378]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/Gershgorin.jl#L166-L181",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Zs,[e("summary",null,[s[380]||(s[380]=e("a",{id:"JustRelax.JustRelax3D.update_phase_ratios_2D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T<:AbstractMatrix, N}",href:"#JustRelax.JustRelax3D.update_phase_ratios_2D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T<:AbstractMatrix, N}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.update_phase_ratios_2D!")],-1)),s[381]||(s[381]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[383]||(s[383]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustPIC.PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_arrays</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractMatrix}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, xvi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {B, T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, N}</span></span></code></pre></div><p>JustRelax routine based on <code>JustPIC._2D.update_phase_ratios!</code> or <code>JustPIC._3D.update_phase_ratios!</code>. Update the phase ratios in <code>phase_ratios</code> using the provided <code>phase_arrays</code>, <code>xci</code>, and <code>xvi</code>. The phase arrays need to be AbstractArrays and have values between 0 and 1.</p><p>#Example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx, ny </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_arrays </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (phase_1, phase_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Advect both phase arrays and update phase ratios</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phase_ratios, phase_arrays, xci, xvi)</span></span></code></pre></div>`,4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[382]||(s[382]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/PhaseRatios.jl#L1-L22",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",se,[e("summary",null,[s[384]||(s[384]=e("a",{id:"JustRelax.JustRelax3D.update_phase_ratios_3D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T<:AbstractArray, N}",href:"#JustRelax.JustRelax3D.update_phase_ratios_3D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T<:AbstractArray, N}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.update_phase_ratios_3D!")],-1)),s[385]||(s[385]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[387]||(s[387]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustPIC.PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_arrays</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, xvi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {B, T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, N}</span></span></code></pre></div><p>JustRelax routine based on <code>JustPIC._2D.update_phase_ratios!</code> or <code>JustPIC._3D.update_phase_ratios!</code>. Update the phase ratios in <code>phase_ratios</code> using the provided <code>phase_arrays</code>, <code>xci</code>, and <code>xvi</code>. The phase arrays need to be AbstractArrays and have values between 0 and 1.</p><p>#Example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx, ny, nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_arrays </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (phase_1, phase_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Advect both phase arrays and update phase ratios</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phase_ratios, phase_arrays, xci, xvi)</span></span></code></pre></div>`,4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[386]||(s[386]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/PhaseRatios.jl#L36-L57",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ee,[e("summary",null,[s[388]||(s[388]=e("a",{id:"JustRelax.JustRelax3D.update_rock_ratio!-Union{Tuple{T}, Tuple{JustRelax.RockRatio{T, 2}, Any, Any}} where T",href:"#JustRelax.JustRelax3D.update_rock_ratio!-Union{Tuple{T}, Tuple{JustRelax.RockRatio{T, 2}, Any, Any}} where T"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.update_rock_ratio!")],-1)),s[389]||(s[389]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[391]||(s[391]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_rock_ratio!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_ratios, air_phase)</span></span></code></pre></div><p>Update the rock ratio <code>ϕ</code> based on the provided <code>phase_ratios</code> and <code>air_phase</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The rock ratio object to be updated.</p></li><li><p><code>phase_ratios</code>: The ratios of different phases present.</p></li><li><p><code>air_phase</code>: The phase representing air.</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[390]||(s[390]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L38-L47",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ie,[e("summary",null,[s[392]||(s[392]=e("a",{id:"JustRelax.JustRelax3D.update_α_β!-Union{Tuple{T}, Tuple{N}, NTuple{4, NTuple{N, AbstractArray{T, N}}}} where {N, T}",href:"#JustRelax.JustRelax3D.update_α_β!-Union{Tuple{T}, Tuple{N}, NTuple{4, NTuple{N, AbstractArray{T, N}}}} where {N, T}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.update_α_β!")],-1)),s[393]||(s[393]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[395]||(s[395]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_α_β!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(βV, αV, dτV, cV)</span></span></code></pre></div><p>Generic N-dimensional version (2D and 3D) of the acceleration parameters update.</p><p>Updates the damping parameters <code>βV</code> and <code>αV</code> for each velocity component based on the pseudo-time step <code>dτV</code> and the preconditioner diagonal <code>cV</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>βV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of damping parameters β for each velocity component</p></li><li><p><code>αV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of acceleration parameters α for each velocity component</p></li><li><p><code>dτV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of pseudo-time steps for each velocity component</p></li><li><p><code>cV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of preconditioner diagonal entries for each velocity component</p></li></ul>',5)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[394]||(s[394]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/Gershgorin.jl#L123-L136",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",te,[e("summary",null,[s[396]||(s[396]=e("a",{id:"JustRelax.JustRelax3D.velocity2vertex!-NTuple{6, Any}",href:"#JustRelax.JustRelax3D.velocity2vertex!-NTuple{6, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.velocity2vertex!")],-1)),s[397]||(s[397]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[399]||(s[399]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity2vertex!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx_v, Vy_v, Vz_v, Vx, Vy, Vz)</span></span></code></pre></div><p>In-place interpolation of the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes onto the pre-allocated <code>Vx_d</code>, <code>Vy_d</code>, <code>Vz_d</code> 3D arrays located at the grid vertices.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[398]||(s[398]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L229-L234",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ae,[e("summary",null,[s[400]||(s[400]=e("a",{id:"JustRelax.JustRelax3D.velocity2vertex-Tuple{Any, Any, Any}",href:"#JustRelax.JustRelax3D.velocity2vertex-Tuple{Any, Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.velocity2vertex")],-1)),s[401]||(s[401]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[403]||(s[403]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity2vertex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx, Vy, Vz)</span></span></code></pre></div><p>Interpolate the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes onto the grid vertices.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[402]||(s[402]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L209-L214",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",le,[e("summary",null,[s[404]||(s[404]=e("a",{id:"JustRelax.JustRelax3D.@add-Tuple{Any, Vararg{Any}}",href:"#JustRelax.JustRelax3D.@add-Tuple{Any, Vararg{Any}}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@add")],-1)),s[405]||(s[405]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[407]||(s[407]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(I, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Add <code>I</code> to the scalars in <code>args</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[406]||(s[406]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L52-L56",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ne,[e("summary",null,[s[408]||(s[408]=e("a",{id:"JustRelax.JustRelax3D.@copy-Tuple{Any, Any}",href:"#JustRelax.JustRelax3D.@copy-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@copy")],-1)),s[409]||(s[409]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[411]||(s[411]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B, A)</span></span></code></pre></div><p>convenience macro to copy data from the array <code>A</code> into array <code>B</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[410]||(s[410]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L16-L20",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",oe,[e("summary",null,[s[412]||(s[412]=e("a",{id:"JustRelax.JustRelax3D.@displacement-Tuple{Any}",href:"#JustRelax.JustRelax3D.@displacement-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@displacement")],-1)),s[413]||(s[413]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[415]||(s[415]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@displacement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(U)</span></span></code></pre></div><p>Unpacks the displacement arrays <code>U</code> from the StokesArrays <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[414]||(s[414]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L94-L98",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",pe,[e("summary",null,[s[416]||(s[416]=e("a",{id:"JustRelax.JustRelax3D.@idx-Tuple",href:"#JustRelax.JustRelax3D.@idx-Tuple"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@idx")],-1)),s[417]||(s[417]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[419]||(s[419]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Make a linear range from <code>1</code> to <code>args[i]</code>, with <code>i ∈ [1, ..., n]</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[418]||(s[418]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L2-L6",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",re,[e("summary",null,[s[420]||(s[420]=e("a",{id:"JustRelax.JustRelax3D.@normal-Tuple{Any}",href:"#JustRelax.JustRelax3D.@normal-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@normal")],-1)),s[421]||(s[421]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[423]||(s[423]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@normal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the normal components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[422]||(s[422]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L259-L264",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",de,[e("summary",null,[s[424]||(s[424]=e("a",{id:"JustRelax.JustRelax3D.@plastic_strain-Tuple{Any}",href:"#JustRelax.JustRelax3D.@plastic_strain-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@plastic_strain")],-1)),s[425]||(s[425]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[427]||(s[427]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@plastic_strain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the plastic strain rate tensor <code>ε_pl</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[426]||(s[426]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L166-L171",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ue,[e("summary",null,[s[428]||(s[428]=e("a",{id:"JustRelax.JustRelax3D.@qT-Tuple{Any}",href:"#JustRelax.JustRelax3D.@qT-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@qT")],-1)),s[429]||(s[429]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[431]||(s[431]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@qT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the flux arrays <code>qT_i</code> from the ThermalArrays <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[430]||(s[430]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L110-L114",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",he,[e("summary",null,[s[432]||(s[432]=e("a",{id:"JustRelax.JustRelax3D.@qT2-Tuple{Any}",href:"#JustRelax.JustRelax3D.@qT2-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@qT2")],-1)),s[433]||(s[433]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[435]||(s[435]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@qT2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the flux arrays <code>qT2_i</code> from the ThermalArrays <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[434]||(s[434]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L125-L129",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ce,[e("summary",null,[s[436]||(s[436]=e("a",{id:"JustRelax.JustRelax3D.@residuals-Tuple{Any}",href:"#JustRelax.JustRelax3D.@residuals-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@residuals")],-1)),s[437]||(s[437]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[439]||(s[439]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@residuals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the momentum residuals from <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[438]||(s[438]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L347-L351",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ke,[e("summary",null,[s[440]||(s[440]=e("a",{id:"JustRelax.JustRelax3D.@shear-Tuple{Any}",href:"#JustRelax.JustRelax3D.@shear-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@shear")],-1)),s[441]||(s[441]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[443]||(s[443]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@shear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[442]||(s[442]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L213-L218",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ge,[e("summary",null,[s[444]||(s[444]=e("a",{id:"JustRelax.JustRelax3D.@shear_center-Tuple{Any}",href:"#JustRelax.JustRelax3D.@shear_center-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@shear_center")],-1)),s[445]||(s[445]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[447]||(s[447]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@shear_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[446]||(s[446]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L236-L241",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ye,[e("summary",null,[s[448]||(s[448]=e("a",{id:"JustRelax.JustRelax3D.@strain-Tuple{Any}",href:"#JustRelax.JustRelax3D.@strain-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@strain")],-1)),s[449]||(s[449]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[451]||(s[451]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[450]||(s[450]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L142-L147",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",be,[e("summary",null,[s[452]||(s[452]=e("a",{id:"JustRelax.JustRelax3D.@strain_center-Tuple{Any}",href:"#JustRelax.JustRelax3D.@strain_center-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@strain_center")],-1)),s[453]||(s[453]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[455]||(s[455]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[454]||(s[454]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L282-L287",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Te,[e("summary",null,[s[456]||(s[456]=e("a",{id:"JustRelax.JustRelax3D.@strain_increment-Tuple{Any}",href:"#JustRelax.JustRelax3D.@strain_increment-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@strain_increment")],-1)),s[457]||(s[457]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[459]||(s[459]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain_increment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[458]||(s[458]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L154-L159",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",fe,[e("summary",null,[s[460]||(s[460]=e("a",{id:"JustRelax.JustRelax3D.@stress-Tuple{Any}",href:"#JustRelax.JustRelax3D.@stress-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@stress")],-1)),s[461]||(s[461]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[463]||(s[463]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@stress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[462]||(s[462]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L178-L183",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",_e,[e("summary",null,[s[464]||(s[464]=e("a",{id:"JustRelax.JustRelax3D.@stress_center-Tuple{Any}",href:"#JustRelax.JustRelax3D.@stress_center-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@stress_center")],-1)),s[465]||(s[465]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[467]||(s[467]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@stress_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[466]||(s[466]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L294-L299",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",me,[e("summary",null,[s[468]||(s[468]=e("a",{id:"JustRelax.JustRelax3D.@tensor-Tuple{Any}",href:"#JustRelax.JustRelax3D.@tensor-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@tensor")],-1)),s[469]||(s[469]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[471]||(s[471]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@tensor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[470]||(s[470]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L190-L195",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ee,[e("summary",null,[s[472]||(s[472]=e("a",{id:"JustRelax.JustRelax3D.@tensor_center-Tuple{Any}",href:"#JustRelax.JustRelax3D.@tensor_center-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@tensor_center")],-1)),s[473]||(s[473]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[475]||(s[475]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@tensor_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[474]||(s[474]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L306-L311",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",xe,[e("summary",null,[s[476]||(s[476]=e("a",{id:"JustRelax.JustRelax3D.@tensor_vertex-Tuple{Any}",href:"#JustRelax.JustRelax3D.@tensor_vertex-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@tensor_vertex")],-1)),s[477]||(s[477]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[479]||(s[479]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tensor_vertex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the vertices of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[478]||(s[478]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L329-L334",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ae,[e("summary",null,[s[480]||(s[480]=e("a",{id:"JustRelax.JustRelax3D.@velocity-Tuple{Any}",href:"#JustRelax.JustRelax3D.@velocity-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.JustRelax3D.@velocity")],-1)),s[481]||(s[481]=a()),t(i,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),s[483]||(s[483]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@velocity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the velocity arrays <code>V</code> from the StokesArrays <code>A</code>.</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[482]||(s[482]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L79-L83",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Re,[e("summary",null,[s[484]||(s[484]=e("a",{id:"JustRelax.DataIO.checkpoint_name-Tuple{Any}",href:"#JustRelax.DataIO.checkpoint_name-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.checkpoint_name")],-1)),s[485]||(s[485]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[487]||(s[487]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">checkpointing_jld2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dst, stokes, thermal, time, timestep, igg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save necessary data in <code>dst</code> as a jld2 file to restart the model from the state at <code>time</code>. If run in parallel, the file will be named after the corresponidng rank e.g. <code>checkpoint0000.jld2</code> and thus can be loaded by the processor while restarting the simulation. If you want to restart your simulation from the checkpoint you can use load() and specify the MPI rank by providing a dollar sign and the rank number.</p><p><strong>Arguments</strong></p><ul><li><p><code>dst</code>: The destination directory where the checkpoint file will be saved.</p></li><li><p><code>stokes</code>: The stokes flow variables to be saved.</p></li><li><p><code>thermal</code>: (Optional) The thermal variables to be saved.</p></li><li><p><code>time</code>: The current simulation time.</p></li><li><p><code>timestep</code>: The current timestep.</p></li><li><p><code>igg</code>: (Optional) The IGG struct for parallel runs.</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code>: Additional variables to be saved in the checkpoint file. These will be added to the base checkpoint data. <strong>Example</strong><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span></code></pre></div></li></ul>',6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[486]||(s[486]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/JLD2.jl#L1-L36",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",ve,[e("summary",null,[s[488]||(s[488]=e("a",{id:"JustRelax.DataIO.checkpointing_hdf5-NTuple{5, Any}",href:"#JustRelax.DataIO.checkpointing_hdf5-NTuple{5, Any}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.checkpointing_hdf5")],-1)),s[489]||(s[489]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[491]||(s[491]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">checkpointing_hdf5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dst, stokes, T, η, time, timestep)</span></span></code></pre></div><p>Save necessary data in <code>dst</code> as and HDF5 file to restart the model from the state at <code>time</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[490]||(s[490]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/H5.jl#L28-L32",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ce,[e("summary",null,[s[492]||(s[492]=e("a",{id:"JustRelax.DataIO.load_checkpoint_hdf5-Tuple{Any}",href:"#JustRelax.DataIO.load_checkpoint_hdf5-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.load_checkpoint_hdf5")],-1)),s[493]||(s[493]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[495]||(s[495]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">load_checkpoint_hdf5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file_path)</span></span></code></pre></div><p>Load the state of the simulation from an .h5 file.</p><p><strong>Arguments</strong></p><ul><li><code>file_path</code>: The path to the .h5 file.</li></ul><p><strong>Returns</strong></p><ul><li><p><code>P</code>: The loaded state of the pressure variable.</p></li><li><p><code>T</code>: The loaded state of the temperature variable.</p></li><li><p><code>Vx</code>: The loaded state of the x-component of the velocity variable.</p></li><li><p><code>Vy</code>: The loaded state of the y-component of the velocity variable.</p></li><li><p><code>Vz</code>: The loaded state of the z-component of the velocity variable.</p></li><li><p><code>η</code>: The loaded state of the viscosity variable.</p></li><li><p><code>t</code>: The loaded simulation time.</p></li><li><p><code>dt</code>: The loaded simulation time.</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define the path to the .h5 file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;path/to/your/file.h5&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use the load_checkpoint function to load the variables from the file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P, T, Vx, Vy, Vz, η, t, dt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`load_checkpoint(file_path)\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\`</span></span></code></pre></div>`,8)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[494]||(s[494]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/H5.jl#L62-L88",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",je,[e("summary",null,[s[496]||(s[496]=e("a",{id:"JustRelax.DataIO.load_checkpoint_jld2-Tuple{Any}",href:"#JustRelax.DataIO.load_checkpoint_jld2-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.load_checkpoint_jld2")],-1)),s[497]||(s[497]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[499]||(s[499]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">load_checkpoint_jld2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file_path)</span></span></code></pre></div><p>Load the state of the simulation from a .jld2 file.</p><p><strong>Arguments</strong></p><ul><li><code>file_path</code>: The path to the .jld2 file.</li></ul><p><strong>Returns</strong></p><ul><li><p><code>stokes</code>: The loaded state of the stokes variable.</p></li><li><p><code>thermal</code>: The loaded state of the thermal variable. Can be <code>nothing</code> if not present in the file.</p></li><li><p><code>time</code>: The loaded simulation time.</p></li><li><p><code>timestep</code>: The loaded time step.</p></li><li><p><code>igg</code>: The IGG struct if needed for parallel runs.</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">stokes, thermal, time, timestep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> load_checkpoint_jld2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;path/to/checkpoint.jld2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, igg)</span></span></code></pre></div><p>or without thermal</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">stokes, _, time, timestep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> load_checkpoint_jld2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;path/to/checkpoint.jld2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>',10)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[498]||(s[498]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/JLD2.jl#L101-L124",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Je,[e("summary",null,[s[500]||(s[500]=e("a",{id:"JustRelax.DataIO.metadata-Tuple{Any, Any, Vararg{Any}}",href:"#JustRelax.DataIO.metadata-Tuple{Any, Any, Vararg{Any}}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.metadata")],-1)),s[501]||(s[501]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[503]||(s[503]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(src, dst, files</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Copy <code>files...</code>, Manifest.toml, and Project.toml from <code>src</code> to <code>dst</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[502]||(s[502]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/DataIO.jl#L32-L36",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",De,[e("summary",null,[s[504]||(s[504]=e("a",{id:"JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Any, Vararg{Any, N}}} where N",href:"#JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Any, Vararg{Any, N}}} where N"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.save_hdf5")],-1)),s[505]||(s[505]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[507]||(s[507]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> save_hdf5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dst, fname, data)</span></span></code></pre></div><p>Save <code>data</code> as the <code>fname.h5</code> HDF5 file in the folder <code>dst</code></p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[506]||(s[506]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/H5.jl#L107-L111",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Fe,[e("summary",null,[s[508]||(s[508]=e("a",{id:"JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Vararg{Any, N}}} where N",href:"#JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Vararg{Any, N}}} where N"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.save_hdf5")],-1)),s[509]||(s[509]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[511]||(s[511]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> save_hdf5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname, data)</span></span></code></pre></div><p>Save <code>data</code> as the <code>fname.h5</code> HDF5 file</p>',2)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[510]||(s[510]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/H5.jl#L133-L137",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Pe,[e("summary",null,[s[512]||(s[512]=e("a",{id:"JustRelax.DataIO.save_marker_chain-Tuple{String, Any}",href:"#JustRelax.DataIO.save_marker_chain-Tuple{String, Any}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.save_marker_chain")],-1)),s[513]||(s[513]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[515]||(s[515]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_marker_chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, chain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MarkerChain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; conversion</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0e3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save a vector of points as a line in a VTK file.</p><p><strong>Arguments</strong></p><ul><li><p><code>fname::String</code>: The name of the VTK file to save. The extension <code>.vtk</code> will be appended to the name.</p></li><li><p><code>chain::MarkerChain</code>: Marker chain object from JustPIC.jl.</p></li><li><p><code>conversion</code>: Conversion factor for coordinates (default: 1.0e3)</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename for time series</p></li><li><p><code>t::Number</code>: Time value (default: 0.0)</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[514]||(s[514]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L212-L223",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ne,[e("summary",null,[s[516]||(s[516]=e("a",{id:"JustRelax.DataIO.save_particles-Tuple{Any, Any}",href:"#JustRelax.DataIO.save_particles-Tuple{Any, Any}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.save_particles")],-1)),s[517]||(s[517]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[519]||(s[519]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles{B, 2}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pPhases; conversion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./particles&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> B</span></span></code></pre></div><p>Save particle data and their material phase to a VTK file.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles::Particles{B, 2}</code>: The particle data, where <code>B</code> is the type of the particle coordinates.</p></li><li><p><code>pPhases</code>: The phases of the particles.</p></li><li><p><code>conversion</code>: A conversion factor for the particle coordinates (default is 1e3).</p></li><li><p><code>fname::String</code>: The name of the VTK file to save (default is &quot;./particles&quot;).</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename for time series</p></li><li><p><code>t::Number</code>: Time value (default: 0.0)</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[518]||(s[518]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L250-L262",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Ve,[e("summary",null,[s[520]||(s[520]=e("a",{id:"JustRelax.DataIO.save_particles-Tuple{Any}",href:"#JustRelax.DataIO.save_particles-Tuple{Any}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.save_particles")],-1)),s[521]||(s[521]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[523]||(s[523]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles{B, 2}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; conversion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./particles&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> B</span></span></code></pre></div><p>Save particle data to a VTK file.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles::Particles{B, 2}</code>: The particle data, where <code>B</code> is the type of the particle coordinates.</p></li><li><p><code>conversion</code>: A conversion factor for the particle coordinates (default is 1e3).</p></li><li><p><code>fname::String</code>: The name of the VTK file to save (default is &quot;./particles&quot;).</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename for time series</p></li><li><p><code>t::Number</code>: Time value (default: 0.0)</p></li></ul>',4)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[522]||(s[522]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L328-L339",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Se,[e("summary",null,[s[524]||(s[524]=e("a",{id:"JustRelax.DataIO.save_vtk-Union{Tuple{T}, Tuple{N}, Tuple{String, Any, Any, NamedTuple, NamedTuple, NTuple{N, T}}} where {N, T}",href:"#JustRelax.DataIO.save_vtk-Union{Tuple{T}, Tuple{N}, Tuple{String, Any, Any, NamedTuple, NamedTuple, NTuple{N, T}}} where {N, T}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.save_vtk")],-1)),s[525]||(s[525]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[527]||(s[527]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xvi, xci, data_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data_c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save VTK data with multiblock format containing both vertex and cell data.</p><p><strong>Arguments</strong></p><ul><li><p><code>fname::String</code>: The filename for the VTK file (without extension)</p></li><li><p><code>xvi</code>: Vertex coordinates (tuple of coordinate arrays)</p></li><li><p><code>xci</code>: Cell center coordinates (tuple of coordinate arrays)</p></li><li><p><code>data_v::NamedTuple</code>: Data defined at vertices</p></li><li><p><code>data_c::NamedTuple</code>: Data defined at cell centers</p></li><li><p><code>velocity::NTuple{N, T}</code>: Velocity field as a tuple of N-dimensional arrays</p></li><li><p><code>t::Number</code>: Time value (default: 0)</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename. If provided, the VTK file will be added to a time series collection. WriteVTK.jl automatically handles creating new collections or appending to existing ones.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Basic usage (backward compatible)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;output&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xvi, xci, data_v, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With ParaView collection for time series</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestep_001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xvi, xci, data_v, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;simulation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestep_002&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xvi, xci, data_v, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;simulation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># This creates simulation.pvd containing the time series</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Time series example</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">times </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i, t) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(times)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    fname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;timestep_</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(lpad(i, 3, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;0&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">))</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname, xvi, xci, data_v, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;full_simulation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div>`,6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[526]||(s[526]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L44-L76",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),e("details",Be,[e("summary",null,[s[528]||(s[528]=e("a",{id:"JustRelax.DataIO.save_vtk-Union{Tuple{T}, Tuple{N}, Tuple{String, Any, NamedTuple, NTuple{N, T}}} where {N, T}",href:"#JustRelax.DataIO.save_vtk-Union{Tuple{T}, Tuple{N}, Tuple{String, Any, NamedTuple, NTuple{N, T}}} where {N, T}"},[e("span",{class:"jlbinding"},"JustRelax.DataIO.save_vtk")],-1)),s[529]||(s[529]=a()),t(i,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),s[531]||(s[531]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, data_c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save VTK data with cell-centered data and velocity field.</p><p><strong>Arguments</strong></p><ul><li><p><code>fname::String</code>: The filename for the VTK file (without extension)</p></li><li><p><code>xci</code>: Cell center coordinates (tuple of coordinate arrays)</p></li><li><p><code>data_c::NamedTuple</code>: Data defined at cell centers</p></li><li><p><code>velocity::NTuple{N, T}</code>: Velocity field as a tuple of N-dimensional arrays</p></li><li><p><code>t::Number</code>: Time value (default: nothing)</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename. If provided, the VTK file will be added to a time series collection. WriteVTK.jl automatically handles creating new collections or appending to existing ones.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Basic usage</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;output&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With ParaView collection</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestep_001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;simulation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,6)),t(i,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[530]||(s[530]=[e("a",{href:"https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L129-L150",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const qe=o(u,[["render",Ie]]);export{Ye as __pageData,qe as default};
