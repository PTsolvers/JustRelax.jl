<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>List of all functions | JustRelax.jl</title>
    <meta name="description" content="Documentation for JustRelax.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/JustRelax.jl/previews/PR442/assets/style.BY1T4Z4B.css" as="style">
    <link rel="preload stylesheet" href="/JustRelax.jl/previews/PR442/vp-icons.css" as="style">
    
    <script type="module" src="/JustRelax.jl/previews/PR442/assets/app.CCavL1eO.js"></script>
    <link rel="preload" href="/JustRelax.jl/previews/PR442/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/JustRelax.jl/previews/PR442/assets/chunks/theme.BxVfb9gt.js">
    <link rel="modulepreload" href="/JustRelax.jl/previews/PR442/assets/chunks/framework.BYAr3f1p.js">
    <link rel="modulepreload" href="/JustRelax.jl/previews/PR442/assets/man_listfunctions.md._kcH8PR9.lean.js">
    <link rel="icon" href="/JustRelax.jl/previews/PR442/favicon.ico">
    <script src="/JustRelax.jl/versions.js"></script>
    <script src="/JustRelax.jl/previews/PR442/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/JustRelax.jl/previews/PR442/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/JustRelax.jl/previews/PR442/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>JustRelax.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/JustRelax.jl/previews/PR442/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/JustRelax.jl/previews/PR442/man/installation" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Documentation</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/JustRelax.jl/previews/PR442/man/listfunctions" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>API</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/PTsolvers/JustRelax.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/PTsolvers/JustRelax.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Home</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>User guide</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/installation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Installation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/backend" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Backend</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Equations</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/equations_basic" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Governing equations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/constitutive_equations" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Constitutive equations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/equations_APT" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>APT equations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/equations_discretization" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Discretization</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/boundary_conditions" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Boundary conditions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/advection" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Advection</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Examples</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/Blankenbach" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Blankenbach</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/ShearBands" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Shear Bands</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Subduction 2D</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/subduction2D/setup" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Model setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/subduction2D/rheology" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Rheology</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/subduction2D/subduction2D" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Setting up the model</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Plume 3D</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/plume3D/rheology" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Rheology</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/plume3D/plume3D" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Setting up the model</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/DYREL" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Self-tuned APT solver</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Checkpointing/Restart</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/checkpointing" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Checkpointing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/restart" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Restart</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 has-active" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/listfunctions" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>List of functions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>References</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/JustPIC" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>JustPIC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/GeoParams" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>GeoParams</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/authors" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Authors</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/contributing" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Contributing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/code_of_conduct" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Code of Conduct</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/security" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Security</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR442/man/license" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>License</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _JustRelax_jl_previews_PR442_man_listfunctions" data-v-83890dd9><div><h1 id="List-of-all-functions" tabindex="-1">List of all functions <a class="header-anchor" href="#List-of-all-functions" aria-label="Permalink to &quot;List of all functions {#List-of-all-functions}&quot;">​</a></h1><p>Here an overview of all functions:</p><details class="jldocstring custom-block" open><summary><a id="JustRelax.DYREL" href="#JustRelax.DYREL"><span class="jlbinding">JustRelax.DYREL</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DYREL{T, F}</span></span></code></pre></div><p>Structure containing parameters and arrays for the DYREL (Dynamic Relaxation) solver.</p><p><strong>Fields</strong></p><ul><li><p><code>γ_eff</code>: Effective penalty parameter.</p></li><li><p><code>Dx</code>, <code>Dy</code>, <code>Dz</code>: Diagonal preconditioners for velocity updates in x, y, (and z) directions.</p></li><li><p><code>λmaxVx</code>, <code>λmaxVy</code>, <code>λmaxVz</code>: Maximum eigenvalues for stability calculation.</p></li><li><p><code>dVxdτ</code>, <code>dVydτ</code>, <code>dVzdτ</code>: Pseudo-time step related damping terms.</p></li><li><p><code>dτVx</code>, <code>dτVy</code>, <code>dτVz</code>: Pseudo-time steps for velocity fields.</p></li><li><p><code>dVx</code>, <code>dVy</code>, <code>dVz</code>: Velocity increments for the current iteration.</p></li><li><p><code>βVx</code>, <code>βVy</code>, <code>βVz</code>: Damping coefficients for momentum equation.</p></li><li><p><code>cVx</code>, <code>cVy</code>, <code>cVz</code>: Damping coefficients related to dynamic relaxation.</p></li><li><p><code>αVx</code>, <code>αVy</code>, <code>αVz</code>: Scaling factors for damping.</p></li><li><p><code>ηb</code>: Bulk viscosity field.</p></li><li><p><code>CFL</code>: Courant-Friedrichs-Lewy number.</p></li><li><p><code>ϵ</code>: General convergence tolerance.</p></li><li><p><code>ϵ_vel</code>: Velocity convergence tolerance.</p></li><li><p><code>c_fact</code>: Damping scaling factor.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/types.jl#L1-L21" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.Geometry" href="#JustRelax.Geometry"><span class="jlbinding">JustRelax.Geometry</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Geometry{nDim,T}</span></span></code></pre></div><p>A struct representing the geometry of a topological object in nDim dimensions.</p><p><strong>Arguments</strong></p><ul><li><p><code>nDim</code>: The number of dimensions of the topological object.</p></li><li><p><code>T</code>: The type of the elements in the topological object.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/topology/Topology.jl#L15-L23" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.velocity_grids-Union{Tuple{T}, Tuple{Any, Any, Tuple{T, T}}} where T" href="#JustRelax.velocity_grids-Union{Tuple{T}, Tuple{Any, Any, Tuple{T, T}}} where T"><span class="jlbinding">JustRelax.velocity_grids</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity_grids</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(xci, xvi, di</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N,T}</span></span></code></pre></div><p>Compute the velocity grids for N dimensionional problems.</p><p><strong>Arguments</strong></p><ul><li><p><code>xci</code>: The x-coordinate of the cell centers.</p></li><li><p><code>xvi</code>: The x-coordinate of the cell vertices.</p></li><li><p><code>di</code>: A tuple containing the cell dimensions.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/topology/Topology.jl#L124-L133" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.versioninfo" href="#JustRelax.versioninfo"><span class="jlbinding">JustRelax.versioninfo</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">versioninfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(io</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">stdout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; verbose</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Print information about the version of JustRelax in use. The output includes:</p><ul><li><p>JustRelax version and installation method</p></li><li><p>Git commit information (if available)</p></li><li><p>Platform information</p></li><li><p>Julia version</p></li><li><p>Key dependencies (verbose mode)</p></li><li><p>Environment variables (verbose mode)</p></li></ul><p>The output is controlled with boolean keyword arguments:</p><ul><li><code>verbose</code>: print all additional information including dependencies and environment</li></ul><p>See also: <code>Base.versioninfo()</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/JustRelax.jl#L51-L67" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.DYREL!-Tuple{JustRelax.DYREL, JustRelax.StokesArrays, Vararg{Any, 4}}" href="#JustRelax.JustRelax2D.DYREL!-Tuple{JustRelax.DYREL, JustRelax.StokesArrays, Vararg{Any, 4}}"><span class="jlbinding">JustRelax.JustRelax2D.DYREL!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyrel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, stokes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rheology, phase_ratios, di, dt; CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, γfact</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Updates the fields of the <code>DYREL</code> struct in-place for the current time step.</p><p>This function recomputes:</p><ul><li><p>Bulk viscosity and penalty parameter <code>γ_eff</code>.</p></li><li><p>Gershgorin estimates for eigenvalues and preconditioners.</p></li><li><p>Damping coefficients.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>dyrel</code>: <code>JustRelax.DYREL</code> struct to modify.</p></li><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> containing current simulation state.</p></li><li><p><code>rheology</code>, <code>phase_ratios</code>: Material properties.</p></li><li><p><code>di</code>: Grid spacing.</p></li><li><p><code>dt</code>: Current time step.</p></li><li><p><code>CFL</code>: Courant number (default: 0.99).</p></li><li><p><code>γfact</code>: Penalty factor (default: 20.0).</p></li></ul><p>Returns <code>nothing</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L144-L164" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.DYREL-Tuple{JustRelax.StokesArrays, Vararg{Any, 4}}" href="#JustRelax.JustRelax2D.DYREL-Tuple{JustRelax.StokesArrays, Vararg{Any, 4}}"><span class="jlbinding">JustRelax.JustRelax2D.DYREL</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, rheology, phase_ratios, di, dt; ϵ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ϵ_vel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, c_fat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, γfact</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Constructs and initializes a <code>DYREL</code> object based on existing Stokes fields.</p><p>This function:</p><ol><li><p>Allocates zero-initialized arrays using grid dimensions from <code>stokes</code>.</p></li><li><p>Computes initial bulk viscosity and penalty parameters.</p></li><li><p>Computes Gershgorin estimates for eigenvalues and preconditioners.</p></li><li><p>Updates damping coefficients.</p></li></ol><p><strong>Arguments</strong></p><ul><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> struct.</p></li><li><p><code>rheology</code>: Material properties.</p></li><li><p><code>phase_ratios</code>: Phase fraction information.</p></li><li><p><code>di</code>: Grid spacing tuple.</p></li><li><p><code>dt</code>: Time step.</p></li><li><p><code>γfact</code>: Factor for penalty parameter calculation (default: 20.0).</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L105-L123" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.DYREL-Tuple{Tuple{T, T} where T}" href="#JustRelax.JustRelax2D.DYREL-Tuple{Tuple{T, T} where T}"><span class="jlbinding">JustRelax.JustRelax2D.DYREL</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; ϵ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ϵ_vel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, c_fat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> N</span></span></code></pre></div><p>Creates a new <code>DYREL</code> struct with fields initialized to zero.</p><p><strong>Arguments</strong></p><ul><li><p><code>ni</code>: Tuple containing the grid dimensions <code>(nx, ny)</code> for 2D or <code>(nx, ny, nz)</code> for 3D.</p></li><li><p><code>ϵ</code>: General convergence tolerance.</p></li><li><p><code>ϵ_vel</code>: Velocity convergence tolerance.</p></li><li><p><code>CFL</code>: Courant-Friedrichs-Lewy number.</p></li><li><p><code>c_fat</code>: Damping scaling factor.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L1-L12" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.StokesArrays-Union{Tuple{NTuple{N, Integer}}, Tuple{N}} where N" href="#JustRelax.JustRelax2D.StokesArrays-Union{Tuple{NTuple{N, Integer}}, Tuple{N}} where N"><span class="jlbinding">JustRelax.JustRelax2D.StokesArrays</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N}</span></span></code></pre></div><p>Create the Stokes arrays object in 2D or 3D.</p><p><strong>Fields</strong></p><ul><li><p><code>P</code>: Pressure field</p></li><li><p><code>P0</code>: Previous pressure field</p></li><li><p><code>∇V</code>: Velocity gradient</p></li><li><p><code>V</code>: Velocity fields</p></li><li><p><code>Q</code>: Volumetric source/sink term e.g. <code>ΔV/V_tot [m³/m³]</code></p></li><li><p><code>U</code>: Displacement fields</p></li><li><p><code>ω</code>: Vorticity field</p></li><li><p><code>τ</code>: Stress tensors</p></li><li><p><code>τ_o</code>: Old stress tensors</p></li><li><p><code>ε</code>: Strain rate tensors</p></li><li><p><code>ε_pl</code>: Plastic strain rate tensors</p></li><li><p><code>EII_pl</code>: Second invariant of the accumulated plastic strain</p></li><li><p><code>viscosity</code>: Viscosity fields</p></li><li><p><code>R</code>: Residual fields</p></li><li><p><code>Δε</code>: Strain increment tensor</p></li><li><p><code>∇U</code>: Displacement gradient</p></li><li><p><code>λ</code> : plastic multiplier @ centers</p></li><li><p><code>λv</code> : plastic multiplier @ vertices</p></li><li><p><code>ΔPψ</code> : pressure correction in dilatant case</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/types/constructors/stokes.jl#L138-L163" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.WENO_advection!-NTuple{5, Any}" href="#JustRelax.JustRelax2D.WENO_advection!-NTuple{5, Any}"><span class="jlbinding">JustRelax.JustRelax2D.WENO_advection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WENO_advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u, Vxi, weno, di, ni, dt)</span></span></code></pre></div><p>Perform the advection step of the Weighted Essentially Non-Oscillatory (WENO) scheme for the solution of hyperbolic partial differential equations.</p><p><strong>Arguments</strong></p><ul><li><p><code>u</code>: field to be advected.</p></li><li><p><code>Vxi</code>: velocity field.</p></li><li><p><code>weno</code>: structure containing the WENO scheme parameters and temporary variables.</p></li><li><p><code>di</code>: grid spacing.</p></li><li><p><code>ni</code>: number of grid points.</p></li><li><p><code>dt</code>: time step.</p></li></ul><p><strong>Description</strong></p><p>The function approximates the advected fluxes using the WENO scheme and use a strong-stability preserving (SSP) Runge-Kutta method of order 3 for the time integration.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/advection/weno5.jl#L178-L193" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}" href="#JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D._heatdiffusion_PT!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatdiffusion_PT!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(thermal, pt_thermal, K, ρCp, dt, di; iterMax, nout, verbose)</span></span></code></pre></div><p>Heat diffusion solver using Pseudo-Transient iterations. Both <code>K</code> and <code>ρCp</code> are n-dimensional arrays.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/thermal_diffusion/DiffusionPT_solver.jl#L9-L13" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}" href="#JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D._heatdiffusion_PT!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatdiffusion_PT!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(thermal, pt_thermal, rheology, dt, di; iterMax, nout, verbose)</span></span></code></pre></div><p>Heat diffusion solver using Pseudo-Transient iterations.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/thermal_diffusion/DiffusionPT_solver.jl#L114-L118" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.allzero-Union{NTuple{N, T}, Tuple{N}, Tuple{T}} where {T, N}" href="#JustRelax.JustRelax2D.allzero-Union{NTuple{N, T}, Tuple{N}, Tuple{T}} where {T, N}"><span class="jlbinding">JustRelax.JustRelax2D.allzero</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">allzero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vararg{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T,N}</span></span></code></pre></div><p>Check if all elements in <code>x</code> are zero.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vararg{T,N}</code>: The input array.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if all elements in <code>x</code> are zero, <code>false</code> otherwise.</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L479-L489" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}" href="#JustRelax.JustRelax2D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}"><span class="jlbinding">JustRelax.JustRelax2D.assign!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">assign!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T,N}</span></span></code></pre></div><p>Assigns the values of array <code>A</code> to array <code>B</code> in parallel.</p><p><strong>Arguments</strong></p><ul><li><p><code>B::AbstractArray{T,N}</code>: The destination array.</p></li><li><p><code>A::AbstractArray{T,N}</code>: The source array.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L519-L527" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Any, NTuple{N, MaterialParams}, Any, Any, Any, Any, NamedTuple}} where N" href="#JustRelax.JustRelax2D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Any, NTuple{N, MaterialParams}, Any, Any, Any, Any, NamedTuple}} where N"><span class="jlbinding">JustRelax.JustRelax2D.compute_P!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>compute_P!(P, P0, RP, ∇V, Q, ΔTc, η, rheology::NTuple{N,MaterialParams}, phase_ratio::C, dt, r, θ_dτ)</p><p>Compute the pressure field <code>P</code> and the residual <code>RP</code> for the compressible case. This function introduces thermal stresses after the implementation of Kiss et al. (2023).</p><p><strong>Arguments</strong></p><ul><li><p><code>P</code>: pressure field</p></li><li><p><code>RP</code>: residual field</p></li><li><p><code>∇V</code>: divergence of the velocity field</p></li><li><p><code>Q</code>: volumetric source/sink term which should have the properties of <code>dV/V_tot [m³/m³]</code> normalized per cell, default is zero.</p></li><li><p><code>ΔTc</code>: temperature difference on the cell center, to account for thermal stresses. The thermal expansivity <code>α</code> is computed from the material parameters.</p></li><li><p><code>η</code>: viscosity field</p></li><li><p><code>rheology</code>: material parameters</p></li><li><p><code>phase_ratio</code>: phase field</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/stokes/PressureKernels.jl#L28-L42" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_bulk_viscosity_and_penalty!-NTuple{6, Any}" href="#JustRelax.JustRelax2D.compute_bulk_viscosity_and_penalty!-NTuple{6, Any}"><span class="jlbinding">JustRelax.JustRelax2D.compute_bulk_viscosity_and_penalty!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_bulk_viscosity_and_penalty!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyrel, stokes, rheology, phase_ratios, γfact, dt)</span></span></code></pre></div><p>Computes the bulk viscosity <code>ηb</code> and the effective penalty parameter <code>γ_eff</code>.</p><ol><li><strong>Bulk Viscosity (<code>ηb</code>)</strong>: Computed based on the bulk modulus of the material phases.</li></ol><ul><li><p>If <code>Kb</code> is infinite (incompressible), <code>ηb</code> defaults to <code>γfact * η_mean</code>.</p></li><li><p>Otherwise <code>ηb = Kb * dt</code>.</p></li></ul><ol start="2"><li><strong>Penalty Parameter (<code>γ_eff</code>)</strong>: A combination of numerical (<code>γ_num</code>) and physical (<code>γ_phy</code>) penalty terms.</li></ol><ul><li><p><code>γ_num = γfact * η_mean</code></p></li><li><p><code>γ_phy = Kb</code> (or related term)</p></li><li><p><code>γ_eff = (γ_phy * γ_num) / (γ_phy + γ_num)</code></p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>dyrel</code>: <code>JustRelax.DYREL</code> struct to update.</p></li><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code>.</p></li><li><p><code>rheology</code>: Material properties.</p></li><li><p><code>phase_ratios</code>: Phase fraction information.</p></li><li><p><code>γfact</code>: Numerical factor for penalty parameter (default: 20.0).</p></li><li><p><code>dt</code>: Time step.</p></li></ul><p>This function parallelizes the computation across grid cells.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L193-L216" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.compute_buoyancy</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology, args, phase_ratios)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The rheology used to compute the buoyancy forces.</p></li><li><p><code>args</code>: Additional arguments required by the rheology.</p></li><li><p><code>phase_ratios</code>: The ratios of the different phases.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L137-L146" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.compute_buoyancy</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology, args)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology and arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The rheology used to compute the buoyancy forces.</p></li><li><p><code>args</code>: Additional arguments required for the computation.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L124-L132" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_buoyancy-Tuple{MaterialParams, Any, Any}" href="#JustRelax.JustRelax2D.compute_buoyancy-Tuple{MaterialParams, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.compute_buoyancy</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaterialParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args, phase_ratios)</span></span></code></pre></div><p>Compute the buoyancy forces for a given set of material parameters, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The material parameters.</p></li><li><p><code>args</code>: The arguments.</p></li><li><p><code>phase_ratios</code>: The phase ratios.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L110-L119" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_buoyancy-Tuple{MaterialParams, Any}" href="#JustRelax.JustRelax2D.compute_buoyancy-Tuple{MaterialParams, Any}"><span class="jlbinding">JustRelax.JustRelax2D.compute_buoyancy</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaterialParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology parameters and arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology::MaterialParams</code>: The material parameters for the rheology.</p></li><li><p><code>args</code>: The arguments for the computation.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L97-L105" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_dt-Tuple{JustRelax.StokesArrays, Vararg{Any}}" href="#JustRelax.JustRelax2D.compute_dt-Tuple{JustRelax.StokesArrays, Vararg{Any}}"><span class="jlbinding">JustRelax.JustRelax2D.compute_dt</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_dt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the time step <code>dt</code> for the simulation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L445-L449" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_maxloc!-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.compute_maxloc!-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.compute_maxloc!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maxloc!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B, A; window)</span></span></code></pre></div><p>Compute the maximum value of <code>A</code> in the <code>window = (width_x, width_y, width_z)</code> and store the result in <code>B</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L371-L375" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.compute_ρg!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_ρg!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρg, rheology, args)</span></span></code></pre></div><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L1-L5" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, JustPIC.PhaseRatios, Any, Any}" href="#JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, JustPIC.PhaseRatios, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.compute_ρg!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_ρg!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρg, phase_ratios, rheology, args)</span></span></code></pre></div><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>. The <code>phase_ratios</code> are used to compute the density of the composite rheology.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L31-L36" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T" href="#JustRelax.JustRelax2D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T"><span class="jlbinding">JustRelax.JustRelax2D.continuation_log</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">continuation_log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x_new, x_old, ν)</span></span></code></pre></div><p>Do a continuation step <code>exp((1-ν)*log(x_old) + ν*log(x_new))</code> with damping parameter <code>ν</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L499-L503" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.flow_bcs!-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.flow_bcs!-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.flow_bcs!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flow_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VelocityBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L42-L46" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.flow_bcs!-Tuple{CPUBackendTrait, Any, DisplacementBoundaryConditions}" href="#JustRelax.JustRelax2D.flow_bcs!-Tuple{CPUBackendTrait, Any, DisplacementBoundaryConditions}"><span class="jlbinding">JustRelax.JustRelax2D.flow_bcs!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flow_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DisplacementBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L53-L57" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, NTuple{N, AbstractMaterialParamsStruct}, Any}} where {N, F}" href="#JustRelax.JustRelax2D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, NTuple{N, AbstractMaterialParamsStruct}, Any}} where {N, F}"><span class="jlbinding">JustRelax.JustRelax2D.fn_ratio</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fn_ratio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractMaterialParamsStruct}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ratio) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N, F}</span></span></code></pre></div><p>Average the function <code>fn</code> over the material phases in <code>rheology</code> using the phase ratios <code>ratio</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/phases.jl#L1-L5" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}" href="#JustRelax.JustRelax2D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}"><span class="jlbinding">JustRelax.JustRelax2D.interp_Vx_on_Vy!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">interp_Vx_on_Vy!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx_on_Vy, Vx)</span></span></code></pre></div><p>Interpolates the values of <code>Vx</code> onto the grid points of <code>Vy</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>Vx_on_Vy::AbstractArray</code>: <code>Vx</code> at <code>Vy</code> grid points.</p></li><li><p><code>Vx::AbstractArray</code>: <code>Vx</code> at its staggered grid points.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L1-L9" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.isvalid_c-Tuple{JustRelax.RockRatio, Any, Any}" href="#JustRelax.JustRelax2D.isvalid_c-Tuple{JustRelax.RockRatio, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.isvalid_c</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.center[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L114-L122" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.isvalid_v-Tuple{JustRelax.RockRatio, Any, Any}" href="#JustRelax.JustRelax2D.isvalid_v-Tuple{JustRelax.RockRatio, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.isvalid_v</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.vertex[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L138-L146" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.isvalid_vx-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N" href="#JustRelax.JustRelax2D.isvalid_vx-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N"><span class="jlbinding">JustRelax.JustRelax2D.isvalid_vx</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_vx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.Vx[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L161-L169" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.isvalid_vz-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N" href="#JustRelax.JustRelax2D.isvalid_vz-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N"><span class="jlbinding">JustRelax.JustRelax2D.isvalid_vz</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_vz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.Vz[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L206-L214" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.solve_DYREL!-Tuple{JustRelax.StokesArrays, Vararg{Any}}" href="#JustRelax.JustRelax2D.solve_DYREL!-Tuple{JustRelax.StokesArrays, Vararg{Any}}"><span class="jlbinding">JustRelax.JustRelax2D.solve_DYREL!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">solve_DYREL!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs)</span></span></code></pre></div><p>Internal solver implementation for the 2D DYREL method on the CPU.</p><p><strong>Arguments (in the following order)</strong></p><ul><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> containing the simulation fields.</p></li><li><p><code>ρg</code>: buoyancy forces arrays.</p></li><li><p><code>dyrel</code>: DYREL-specific parameters and fields.</p></li><li><p><code>flow_bcs</code>: <code>AbstractFlowBoundaryConditions</code> defining velocity boundary conditions.</p></li><li><p><code>phase_ratios</code>: <code>JustPIC.PhaseRatios</code> for material phase tracking.</p></li><li><p><code>rheology</code>: Material properties and rheological laws.</p></li><li><p><code>args</code>: Tuple of additional arguments needed to update viscosity, stress, and buoyancy forces.</p></li><li><p><code>di</code>: Grid spacing tuple <code>(dx, dy)</code>.</p></li><li><p><code>dt</code>: Time step.</p></li><li><p><code>igg</code>: <code>IGG</code> object for global grid information (MPI).</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>viscosity_cutoff</code>: Limits for viscosity <code>(min, max)</code>. Default: <code>(-Inf, Inf)</code>.</p></li><li><p><code>viscosity_relaxation</code>: Relaxation factor for viscosity updates. Default: <code>1.0e-2</code>.</p></li><li><p><code>λ_relaxation_DR</code>: Relaxation factor for dynamic relaxation. Default: <code>1</code>.</p></li><li><p><code>λ_relaxation_PH</code>: Relaxation factor for Powell-Hestenes iterations. Default: <code>1</code>.</p></li><li><p><code>iterMax</code>: Maximum number of iterations. Default: <code>50.0e3</code>.</p></li><li><p><code>nout</code>: Output frequency for residuals. Default: <code>100</code>.</p></li><li><p><code>rel_drop</code>: Relative residual drop tolerance. Default: <code>1.0e-2</code>.</p></li><li><p><code>verbose_PH</code>: Print Powell-Hestenes iteration info. Default: <code>true</code>.</p></li><li><p><code>verbose_DR</code>: Print Dynamic Relaxation iteration info. Default: <code>true</code>.</p></li><li><p><code>linear_viscosity</code>: Whether to use linear viscosity. Default: <code>false</code>.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/DYREL2D.jl#L2-L30" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.take-Tuple{String}" href="#JustRelax.JustRelax2D.take-Tuple{String}"><span class="jlbinding">JustRelax.JustRelax2D.take</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">take</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fldr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Create folder <code>fldr</code> if it does not exist.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L492-L496" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}" href="#JustRelax.JustRelax2D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}"><span class="jlbinding">JustRelax.JustRelax2D.tensor_invariant!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tensor_invariant!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.SymmetricTensor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the tensor invariant of the given symmetric tensor <code>A</code>.</p><p><strong>Arguments</strong></p><ul><li><code>A::JustRelax.SymmetricTensor</code>: The input symmetric tensor.</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/stokes/StressKernels.jl#L411-L418" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.thermal_bcs!-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.thermal_bcs!-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.thermal_bcs!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">thermal_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TemperatureBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed heat boundary conditions <code>bc</code> on the <code>T</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L19-L23" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.update_dτV_α_β!-Union{Tuple{T}, Tuple{N}, Tuple{NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, Real}} where {N, T}" href="#JustRelax.JustRelax2D.update_dτV_α_β!-Union{Tuple{T}, Tuple{N}, Tuple{NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, Real}} where {N, T}"><span class="jlbinding">JustRelax.JustRelax2D.update_dτV_α_β!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_dτV_α_β!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dτV, βV, αV, cV, λmaxV, CFL_v)</span></span></code></pre></div><p>Generic N-dimensional version (2D and 3D) for updating pseudo-time step and acceleration parameters.</p><p>Computes the pseudo-time step <code>dτV</code> from the maximum eigenvalue estimate <code>λmaxV</code> and CFL number, then updates the damping parameters <code>βV</code> and acceleration parameters <code>αV</code> accordingly.</p><p><strong>Arguments</strong></p><ul><li><p><code>dτV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of pseudo-time steps for each velocity component</p></li><li><p><code>βV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of damping parameters β for each velocity component</p></li><li><p><code>αV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of acceleration parameters α for each velocity component</p></li><li><p><code>cV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of preconditioner diagonal entries for each velocity component</p></li><li><p><code>λmaxV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of maximum eigenvalue estimates for each velocity component</p></li><li><p><code>CFL_v::Real</code>: CFL number for velocity</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/Gershgorin.jl#L166-L181" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.update_phase_ratios_2D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T&lt;:AbstractMatrix, N}" href="#JustRelax.JustRelax2D.update_phase_ratios_2D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T&lt;:AbstractMatrix, N}"><span class="jlbinding">JustRelax.JustRelax2D.update_phase_ratios_2D!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustPIC.PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_arrays</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractMatrix}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, xvi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {B, T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, N}</span></span></code></pre></div><p>JustRelax routine based on <code>JustPIC._2D.update_phase_ratios!</code> or <code>JustPIC._3D.update_phase_ratios!</code>. Update the phase ratios in <code>phase_ratios</code> using the provided <code>phase_arrays</code>, <code>xci</code>, and <code>xvi</code>. The phase arrays need to be AbstractArrays and have values between 0 and 1.</p><p>#Example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx, ny </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_arrays </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (phase_1, phase_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Advect both phase arrays and update phase ratios</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phase_ratios, phase_arrays, xci, xvi)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/PhaseRatios.jl#L1-L22" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.update_phase_ratios_3D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T&lt;:AbstractArray, N}" href="#JustRelax.JustRelax2D.update_phase_ratios_3D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T&lt;:AbstractArray, N}"><span class="jlbinding">JustRelax.JustRelax2D.update_phase_ratios_3D!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustPIC.PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_arrays</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, xvi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {B, T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, N}</span></span></code></pre></div><p>JustRelax routine based on <code>JustPIC._2D.update_phase_ratios!</code> or <code>JustPIC._3D.update_phase_ratios!</code>. Update the phase ratios in <code>phase_ratios</code> using the provided <code>phase_arrays</code>, <code>xci</code>, and <code>xvi</code>. The phase arrays need to be AbstractArrays and have values between 0 and 1.</p><p>#Example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx, ny, nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_arrays </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (phase_1, phase_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Advect both phase arrays and update phase ratios</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phase_ratios, phase_arrays, xci, xvi)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/PhaseRatios.jl#L36-L57" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.update_rock_ratio!-Union{Tuple{T}, Tuple{JustRelax.RockRatio{T, 2}, Any, Any}} where T" href="#JustRelax.JustRelax2D.update_rock_ratio!-Union{Tuple{T}, Tuple{JustRelax.RockRatio{T, 2}, Any, Any}} where T"><span class="jlbinding">JustRelax.JustRelax2D.update_rock_ratio!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_rock_ratio!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_ratios, air_phase)</span></span></code></pre></div><p>Update the rock ratio <code>ϕ</code> based on the provided <code>phase_ratios</code> and <code>air_phase</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The rock ratio object to be updated.</p></li><li><p><code>phase_ratios</code>: The ratios of different phases present.</p></li><li><p><code>air_phase</code>: The phase representing air.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L38-L47" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.update_α_β!-Union{Tuple{T}, Tuple{N}, NTuple{4, NTuple{N, AbstractArray{T, N}}}} where {N, T}" href="#JustRelax.JustRelax2D.update_α_β!-Union{Tuple{T}, Tuple{N}, NTuple{4, NTuple{N, AbstractArray{T, N}}}} where {N, T}"><span class="jlbinding">JustRelax.JustRelax2D.update_α_β!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_α_β!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(βV, αV, dτV, cV)</span></span></code></pre></div><p>Generic N-dimensional version (2D and 3D) of the acceleration parameters update.</p><p>Updates the damping parameters <code>βV</code> and <code>αV</code> for each velocity component based on the pseudo-time step <code>dτV</code> and the preconditioner diagonal <code>cV</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>βV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of damping parameters β for each velocity component</p></li><li><p><code>αV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of acceleration parameters α for each velocity component</p></li><li><p><code>dτV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of pseudo-time steps for each velocity component</p></li><li><p><code>cV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of preconditioner diagonal entries for each velocity component</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/Gershgorin.jl#L123-L136" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.velocity2vertex!-NTuple{6, Any}" href="#JustRelax.JustRelax2D.velocity2vertex!-NTuple{6, Any}"><span class="jlbinding">JustRelax.JustRelax2D.velocity2vertex!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity2vertex!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx_v, Vy_v, Vz_v, Vx, Vy, Vz)</span></span></code></pre></div><p>In-place interpolation of the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes onto the pre-allocated <code>Vx_d</code>, <code>Vy_d</code>, <code>Vz_d</code> 3D arrays located at the grid vertices.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L229-L234" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.velocity2vertex-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax2D.velocity2vertex-Tuple{Any, Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.velocity2vertex</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity2vertex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx, Vy, Vz)</span></span></code></pre></div><p>Interpolate the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes onto the grid vertices.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L209-L214" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@add-Tuple{Any, Vararg{Any}}" href="#JustRelax.JustRelax2D.@add-Tuple{Any, Vararg{Any}}"><span class="jlbinding">JustRelax.JustRelax2D.@add</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(I, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Add <code>I</code> to the scalars in <code>args</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L52-L56" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@copy-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.@copy-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax2D.@copy</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B, A)</span></span></code></pre></div><p>convenience macro to copy data from the array <code>A</code> into array <code>B</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L16-L20" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@displacement-Tuple{Any}" href="#JustRelax.JustRelax2D.@displacement-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@displacement</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@displacement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(U)</span></span></code></pre></div><p>Unpacks the displacement arrays <code>U</code> from the StokesArrays <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L94-L98" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@idx-Tuple" href="#JustRelax.JustRelax2D.@idx-Tuple"><span class="jlbinding">JustRelax.JustRelax2D.@idx</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Make a linear range from <code>1</code> to <code>args[i]</code>, with <code>i ∈ [1, ..., n]</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L2-L6" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@normal-Tuple{Any}" href="#JustRelax.JustRelax2D.@normal-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@normal</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@normal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the normal components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L259-L264" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@plastic_strain-Tuple{Any}" href="#JustRelax.JustRelax2D.@plastic_strain-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@plastic_strain</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@plastic_strain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the plastic strain rate tensor <code>ε_pl</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L166-L171" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@qT-Tuple{Any}" href="#JustRelax.JustRelax2D.@qT-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@qT</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@qT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the flux arrays <code>qT_i</code> from the ThermalArrays <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L110-L114" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@qT2-Tuple{Any}" href="#JustRelax.JustRelax2D.@qT2-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@qT2</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@qT2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the flux arrays <code>qT2_i</code> from the ThermalArrays <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L125-L129" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@residuals-Tuple{Any}" href="#JustRelax.JustRelax2D.@residuals-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@residuals</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@residuals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the momentum residuals from <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L347-L351" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@shear-Tuple{Any}" href="#JustRelax.JustRelax2D.@shear-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@shear</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@shear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L213-L218" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@shear_center-Tuple{Any}" href="#JustRelax.JustRelax2D.@shear_center-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@shear_center</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@shear_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L236-L241" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@strain-Tuple{Any}" href="#JustRelax.JustRelax2D.@strain-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@strain</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L142-L147" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@strain_center-Tuple{Any}" href="#JustRelax.JustRelax2D.@strain_center-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@strain_center</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L282-L287" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@strain_increment-Tuple{Any}" href="#JustRelax.JustRelax2D.@strain_increment-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@strain_increment</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain_increment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L154-L159" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@stress-Tuple{Any}" href="#JustRelax.JustRelax2D.@stress-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@stress</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@stress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L178-L183" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@stress_center-Tuple{Any}" href="#JustRelax.JustRelax2D.@stress_center-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@stress_center</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@stress_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L294-L299" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@tensor-Tuple{Any}" href="#JustRelax.JustRelax2D.@tensor-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@tensor</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@tensor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L190-L195" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@tensor_center-Tuple{Any}" href="#JustRelax.JustRelax2D.@tensor_center-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@tensor_center</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@tensor_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L306-L311" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@tensor_vertex-Tuple{Any}" href="#JustRelax.JustRelax2D.@tensor_vertex-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@tensor_vertex</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tensor_vertex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the vertices of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L329-L334" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax2D.@velocity-Tuple{Any}" href="#JustRelax.JustRelax2D.@velocity-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax2D.@velocity</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@velocity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the velocity arrays <code>V</code> from the StokesArrays <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L79-L83" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.DYREL!-Tuple{JustRelax.DYREL, JustRelax.StokesArrays, Vararg{Any, 4}}" href="#JustRelax.JustRelax3D.DYREL!-Tuple{JustRelax.DYREL, JustRelax.StokesArrays, Vararg{Any, 4}}"><span class="jlbinding">JustRelax.JustRelax3D.DYREL!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyrel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, stokes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rheology, phase_ratios, di, dt; CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, γfact</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Updates the fields of the <code>DYREL</code> struct in-place for the current time step.</p><p>This function recomputes:</p><ul><li><p>Bulk viscosity and penalty parameter <code>γ_eff</code>.</p></li><li><p>Gershgorin estimates for eigenvalues and preconditioners.</p></li><li><p>Damping coefficients.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>dyrel</code>: <code>JustRelax.DYREL</code> struct to modify.</p></li><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> containing current simulation state.</p></li><li><p><code>rheology</code>, <code>phase_ratios</code>: Material properties.</p></li><li><p><code>di</code>: Grid spacing.</p></li><li><p><code>dt</code>: Current time step.</p></li><li><p><code>CFL</code>: Courant number (default: 0.99).</p></li><li><p><code>γfact</code>: Penalty factor (default: 20.0).</p></li></ul><p>Returns <code>nothing</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L144-L164" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.DYREL-Tuple{JustRelax.StokesArrays, Vararg{Any, 4}}" href="#JustRelax.JustRelax3D.DYREL-Tuple{JustRelax.StokesArrays, Vararg{Any, 4}}"><span class="jlbinding">JustRelax.JustRelax3D.DYREL</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, rheology, phase_ratios, di, dt; ϵ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ϵ_vel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, c_fat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, γfact</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Constructs and initializes a <code>DYREL</code> object based on existing Stokes fields.</p><p>This function:</p><ol><li><p>Allocates zero-initialized arrays using grid dimensions from <code>stokes</code>.</p></li><li><p>Computes initial bulk viscosity and penalty parameters.</p></li><li><p>Computes Gershgorin estimates for eigenvalues and preconditioners.</p></li><li><p>Updates damping coefficients.</p></li></ol><p><strong>Arguments</strong></p><ul><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code> struct.</p></li><li><p><code>rheology</code>: Material properties.</p></li><li><p><code>phase_ratios</code>: Phase fraction information.</p></li><li><p><code>di</code>: Grid spacing tuple.</p></li><li><p><code>dt</code>: Time step.</p></li><li><p><code>γfact</code>: Factor for penalty parameter calculation (default: 20.0).</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L105-L123" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.DYREL-Tuple{Tuple{T, T} where T}" href="#JustRelax.JustRelax3D.DYREL-Tuple{Tuple{T, T} where T}"><span class="jlbinding">JustRelax.JustRelax3D.DYREL</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DYREL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; ϵ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ϵ_vel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CFL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, c_fat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> N</span></span></code></pre></div><p>Creates a new <code>DYREL</code> struct with fields initialized to zero.</p><p><strong>Arguments</strong></p><ul><li><p><code>ni</code>: Tuple containing the grid dimensions <code>(nx, ny)</code> for 2D or <code>(nx, ny, nz)</code> for 3D.</p></li><li><p><code>ϵ</code>: General convergence tolerance.</p></li><li><p><code>ϵ_vel</code>: Velocity convergence tolerance.</p></li><li><p><code>CFL</code>: Courant-Friedrichs-Lewy number.</p></li><li><p><code>c_fat</code>: Damping scaling factor.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L1-L12" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.StokesArrays-Union{Tuple{NTuple{N, Integer}}, Tuple{N}} where N" href="#JustRelax.JustRelax3D.StokesArrays-Union{Tuple{NTuple{N, Integer}}, Tuple{N}} where N"><span class="jlbinding">JustRelax.JustRelax3D.StokesArrays</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ni</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,Integer}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N}</span></span></code></pre></div><p>Create the Stokes arrays object in 2D or 3D.</p><p><strong>Fields</strong></p><ul><li><p><code>P</code>: Pressure field</p></li><li><p><code>P0</code>: Previous pressure field</p></li><li><p><code>∇V</code>: Velocity gradient</p></li><li><p><code>V</code>: Velocity fields</p></li><li><p><code>Q</code>: Volumetric source/sink term e.g. <code>ΔV/V_tot [m³/m³]</code></p></li><li><p><code>U</code>: Displacement fields</p></li><li><p><code>ω</code>: Vorticity field</p></li><li><p><code>τ</code>: Stress tensors</p></li><li><p><code>τ_o</code>: Old stress tensors</p></li><li><p><code>ε</code>: Strain rate tensors</p></li><li><p><code>ε_pl</code>: Plastic strain rate tensors</p></li><li><p><code>EII_pl</code>: Second invariant of the accumulated plastic strain</p></li><li><p><code>viscosity</code>: Viscosity fields</p></li><li><p><code>R</code>: Residual fields</p></li><li><p><code>Δε</code>: Strain increment tensor</p></li><li><p><code>∇U</code>: Displacement gradient</p></li><li><p><code>λ</code> : plastic multiplier @ centers</p></li><li><p><code>λv</code> : plastic multiplier @ vertices</p></li><li><p><code>ΔPψ</code> : pressure correction in dilatant case</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/types/constructors/stokes.jl#L138-L163" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.WENO_advection!-NTuple{5, Any}" href="#JustRelax.JustRelax3D.WENO_advection!-NTuple{5, Any}"><span class="jlbinding">JustRelax.JustRelax3D.WENO_advection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WENO_advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(u, Vxi, weno, di, ni, dt)</span></span></code></pre></div><p>Perform the advection step of the Weighted Essentially Non-Oscillatory (WENO) scheme for the solution of hyperbolic partial differential equations.</p><p><strong>Arguments</strong></p><ul><li><p><code>u</code>: field to be advected.</p></li><li><p><code>Vxi</code>: velocity field.</p></li><li><p><code>weno</code>: structure containing the WENO scheme parameters and temporary variables.</p></li><li><p><code>di</code>: grid spacing.</p></li><li><p><code>ni</code>: number of grid points.</p></li><li><p><code>dt</code>: time step.</p></li></ul><p><strong>Description</strong></p><p>The function approximates the advected fluxes using the WENO scheme and use a strong-stability preserving (SSP) Runge-Kutta method of order 3 for the time integration.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/advection/weno5.jl#L178-L193" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}" href="#JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D._heatdiffusion_PT!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatdiffusion_PT!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(thermal, pt_thermal, K, ρCp, dt, di; iterMax, nout, verbose)</span></span></code></pre></div><p>Heat diffusion solver using Pseudo-Transient iterations. Both <code>K</code> and <code>ρCp</code> are n-dimensional arrays.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/thermal_diffusion/DiffusionPT_solver.jl#L9-L13" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}" href="#JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D._heatdiffusion_PT!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">heatdiffusion_PT!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(thermal, pt_thermal, rheology, dt, di; iterMax, nout, verbose)</span></span></code></pre></div><p>Heat diffusion solver using Pseudo-Transient iterations.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/thermal_diffusion/DiffusionPT_solver.jl#L114-L118" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.allzero-Union{NTuple{N, T}, Tuple{N}, Tuple{T}} where {T, N}" href="#JustRelax.JustRelax3D.allzero-Union{NTuple{N, T}, Tuple{N}, Tuple{T}} where {T, N}"><span class="jlbinding">JustRelax.JustRelax3D.allzero</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">allzero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vararg{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T,N}</span></span></code></pre></div><p>Check if all elements in <code>x</code> are zero.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vararg{T,N}</code>: The input array.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if all elements in <code>x</code> are zero, <code>false</code> otherwise.</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L479-L489" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}" href="#JustRelax.JustRelax3D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}"><span class="jlbinding">JustRelax.JustRelax3D.assign!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">assign!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T,N}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {T,N}</span></span></code></pre></div><p>Assigns the values of array <code>A</code> to array <code>B</code> in parallel.</p><p><strong>Arguments</strong></p><ul><li><p><code>B::AbstractArray{T,N}</code>: The destination array.</p></li><li><p><code>A::AbstractArray{T,N}</code>: The source array.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L519-L527" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Any, NTuple{N, MaterialParams}, Any, Any, Any, Any, NamedTuple}} where N" href="#JustRelax.JustRelax3D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Any, NTuple{N, MaterialParams}, Any, Any, Any, Any, NamedTuple}} where N"><span class="jlbinding">JustRelax.JustRelax3D.compute_P!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><p>compute_P!(P, P0, RP, ∇V, Q, ΔTc, η, rheology::NTuple{N,MaterialParams}, phase_ratio::C, dt, r, θ_dτ)</p><p>Compute the pressure field <code>P</code> and the residual <code>RP</code> for the compressible case. This function introduces thermal stresses after the implementation of Kiss et al. (2023).</p><p><strong>Arguments</strong></p><ul><li><p><code>P</code>: pressure field</p></li><li><p><code>RP</code>: residual field</p></li><li><p><code>∇V</code>: divergence of the velocity field</p></li><li><p><code>Q</code>: volumetric source/sink term which should have the properties of <code>dV/V_tot [m³/m³]</code> normalized per cell, default is zero.</p></li><li><p><code>ΔTc</code>: temperature difference on the cell center, to account for thermal stresses. The thermal expansivity <code>α</code> is computed from the material parameters.</p></li><li><p><code>η</code>: viscosity field</p></li><li><p><code>rheology</code>: material parameters</p></li><li><p><code>phase_ratio</code>: phase field</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/stokes/PressureKernels.jl#L28-L42" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_bulk_viscosity_and_penalty!-NTuple{6, Any}" href="#JustRelax.JustRelax3D.compute_bulk_viscosity_and_penalty!-NTuple{6, Any}"><span class="jlbinding">JustRelax.JustRelax3D.compute_bulk_viscosity_and_penalty!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_bulk_viscosity_and_penalty!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dyrel, stokes, rheology, phase_ratios, γfact, dt)</span></span></code></pre></div><p>Computes the bulk viscosity <code>ηb</code> and the effective penalty parameter <code>γ_eff</code>.</p><ol><li><strong>Bulk Viscosity (<code>ηb</code>)</strong>: Computed based on the bulk modulus of the material phases.</li></ol><ul><li><p>If <code>Kb</code> is infinite (incompressible), <code>ηb</code> defaults to <code>γfact * η_mean</code>.</p></li><li><p>Otherwise <code>ηb = Kb * dt</code>.</p></li></ul><ol start="2"><li><strong>Penalty Parameter (<code>γ_eff</code>)</strong>: A combination of numerical (<code>γ_num</code>) and physical (<code>γ_phy</code>) penalty terms.</li></ol><ul><li><p><code>γ_num = γfact * η_mean</code></p></li><li><p><code>γ_phy = Kb</code> (or related term)</p></li><li><p><code>γ_eff = (γ_phy * γ_num) / (γ_phy + γ_num)</code></p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>dyrel</code>: <code>JustRelax.DYREL</code> struct to update.</p></li><li><p><code>stokes</code>: <code>JustRelax.StokesArrays</code>.</p></li><li><p><code>rheology</code>: Material properties.</p></li><li><p><code>phase_ratios</code>: Phase fraction information.</p></li><li><p><code>γfact</code>: Numerical factor for penalty parameter (default: 20.0).</p></li><li><p><code>dt</code>: Time step.</p></li></ul><p>This function parallelizes the computation across grid cells.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/constructors.jl#L193-L216" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.compute_buoyancy</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology, args, phase_ratios)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The rheology used to compute the buoyancy forces.</p></li><li><p><code>args</code>: Additional arguments required by the rheology.</p></li><li><p><code>phase_ratios</code>: The ratios of the different phases.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L137-L146" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.compute_buoyancy</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology, args)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology and arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The rheology used to compute the buoyancy forces.</p></li><li><p><code>args</code>: Additional arguments required for the computation.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L124-L132" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_buoyancy-Tuple{MaterialParams, Any, Any}" href="#JustRelax.JustRelax3D.compute_buoyancy-Tuple{MaterialParams, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.compute_buoyancy</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaterialParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args, phase_ratios)</span></span></code></pre></div><p>Compute the buoyancy forces for a given set of material parameters, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology</code>: The material parameters.</p></li><li><p><code>args</code>: The arguments.</p></li><li><p><code>phase_ratios</code>: The phase ratios.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L110-L119" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_buoyancy-Tuple{MaterialParams, Any}" href="#JustRelax.JustRelax3D.compute_buoyancy-Tuple{MaterialParams, Any}"><span class="jlbinding">JustRelax.JustRelax3D.compute_buoyancy</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_buoyancy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaterialParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args)</span></span></code></pre></div><p>Compute the buoyancy forces based on the given rheology parameters and arguments.</p><p><strong>Arguments</strong></p><ul><li><p><code>rheology::MaterialParams</code>: The material parameters for the rheology.</p></li><li><p><code>args</code>: The arguments for the computation.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L97-L105" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_dt-Tuple{JustRelax.StokesArrays, Vararg{Any}}" href="#JustRelax.JustRelax3D.compute_dt-Tuple{JustRelax.StokesArrays, Vararg{Any}}"><span class="jlbinding">JustRelax.JustRelax3D.compute_dt</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_dt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.StokesArrays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the time step <code>dt</code> for the simulation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L445-L449" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_maxloc!-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.compute_maxloc!-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.compute_maxloc!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maxloc!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B, A; window)</span></span></code></pre></div><p>Compute the maximum value of <code>A</code> in the <code>window = (width_x, width_y, width_z)</code> and store the result in <code>B</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L371-L375" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.compute_ρg!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_ρg!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρg, rheology, args)</span></span></code></pre></div><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L1-L5" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, JustPIC.PhaseRatios, Any, Any}" href="#JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, JustPIC.PhaseRatios, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.compute_ρg!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compute_ρg!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ρg, phase_ratios, rheology, args)</span></span></code></pre></div><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>. The <code>phase_ratios</code> are used to compute the density of the composite rheology.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/rheology/BuoyancyForces.jl#L31-L36" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T" href="#JustRelax.JustRelax3D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T"><span class="jlbinding">JustRelax.JustRelax3D.continuation_log</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">continuation_log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x_new, x_old, ν)</span></span></code></pre></div><p>Do a continuation step <code>exp((1-ν)*log(x_old) + ν*log(x_new))</code> with damping parameter <code>ν</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L499-L503" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.flow_bcs!-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.flow_bcs!-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.flow_bcs!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flow_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VelocityBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L42-L46" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.flow_bcs!-Tuple{CPUBackendTrait, Any, DisplacementBoundaryConditions}" href="#JustRelax.JustRelax3D.flow_bcs!-Tuple{CPUBackendTrait, Any, DisplacementBoundaryConditions}"><span class="jlbinding">JustRelax.JustRelax3D.flow_bcs!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flow_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(stokes, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DisplacementBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L53-L57" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, NTuple{N, AbstractMaterialParamsStruct}, Any}} where {N, F}" href="#JustRelax.JustRelax3D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, NTuple{N, AbstractMaterialParamsStruct}, Any}} where {N, F}"><span class="jlbinding">JustRelax.JustRelax3D.fn_ratio</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fn_ratio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rheology</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractMaterialParamsStruct}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ratio) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N, F}</span></span></code></pre></div><p>Average the function <code>fn</code> over the material phases in <code>rheology</code> using the phase ratios <code>ratio</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/phases.jl#L1-L5" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}" href="#JustRelax.JustRelax3D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}"><span class="jlbinding">JustRelax.JustRelax3D.interp_Vx_on_Vy!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">interp_Vx_on_Vy!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx_on_Vy, Vx)</span></span></code></pre></div><p>Interpolates the values of <code>Vx</code> onto the grid points of <code>Vy</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>Vx_on_Vy::AbstractArray</code>: <code>Vx</code> at <code>Vy</code> grid points.</p></li><li><p><code>Vx::AbstractArray</code>: <code>Vx</code> at its staggered grid points.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L1-L9" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.isvalid_c-Tuple{JustRelax.RockRatio, Any, Any}" href="#JustRelax.JustRelax3D.isvalid_c-Tuple{JustRelax.RockRatio, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.isvalid_c</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.center[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L114-L122" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.isvalid_v-Tuple{JustRelax.RockRatio, Any, Any}" href="#JustRelax.JustRelax3D.isvalid_v-Tuple{JustRelax.RockRatio, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.isvalid_v</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.vertex[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L138-L146" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.isvalid_vx-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N" href="#JustRelax.JustRelax3D.isvalid_vx-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N"><span class="jlbinding">JustRelax.JustRelax3D.isvalid_vx</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_vx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.Vx[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L161-L169" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.isvalid_vz-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N" href="#JustRelax.JustRelax3D.isvalid_vz-Union{Tuple{N}, Tuple{JustRelax.RockRatio, Vararg{Integer, N}}} where N"><span class="jlbinding">JustRelax.JustRelax3D.isvalid_vz</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isvalid_vz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, inds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Check if <code>ϕ.Vz[inds...]</code> is a not a nullspace.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The <code>RockRatio</code> object to check against.</p></li><li><p><code>inds</code>: Cartesian indices to check.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L206-L214" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.take-Tuple{String}" href="#JustRelax.JustRelax3D.take-Tuple{String}"><span class="jlbinding">JustRelax.JustRelax3D.take</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">take</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fldr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Create folder <code>fldr</code> if it does not exist.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L492-L496" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}" href="#JustRelax.JustRelax3D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}"><span class="jlbinding">JustRelax.JustRelax3D.tensor_invariant!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tensor_invariant!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.SymmetricTensor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the tensor invariant of the given symmetric tensor <code>A</code>.</p><p><strong>Arguments</strong></p><ul><li><code>A::JustRelax.SymmetricTensor</code>: The input symmetric tensor.</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/stokes/StressKernels.jl#L411-L418" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.thermal_bcs!-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.thermal_bcs!-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.thermal_bcs!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">thermal_bcs!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T, bcs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TemperatureBoundaryConditions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Apply the prescribed heat boundary conditions <code>bc</code> on the <code>T</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/boundaryconditions/BoundaryConditions.jl#L19-L23" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.update_dτV_α_β!-Union{Tuple{T}, Tuple{N}, Tuple{NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, Real}} where {N, T}" href="#JustRelax.JustRelax3D.update_dτV_α_β!-Union{Tuple{T}, Tuple{N}, Tuple{NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, NTuple{N, AbstractArray{T, N}}, Real}} where {N, T}"><span class="jlbinding">JustRelax.JustRelax3D.update_dτV_α_β!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_dτV_α_β!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dτV, βV, αV, cV, λmaxV, CFL_v)</span></span></code></pre></div><p>Generic N-dimensional version (2D and 3D) for updating pseudo-time step and acceleration parameters.</p><p>Computes the pseudo-time step <code>dτV</code> from the maximum eigenvalue estimate <code>λmaxV</code> and CFL number, then updates the damping parameters <code>βV</code> and acceleration parameters <code>αV</code> accordingly.</p><p><strong>Arguments</strong></p><ul><li><p><code>dτV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of pseudo-time steps for each velocity component</p></li><li><p><code>βV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of damping parameters β for each velocity component</p></li><li><p><code>αV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of acceleration parameters α for each velocity component</p></li><li><p><code>cV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of preconditioner diagonal entries for each velocity component</p></li><li><p><code>λmaxV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of maximum eigenvalue estimates for each velocity component</p></li><li><p><code>CFL_v::Real</code>: CFL number for velocity</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/Gershgorin.jl#L166-L181" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.update_phase_ratios_2D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T&lt;:AbstractMatrix, N}" href="#JustRelax.JustRelax3D.update_phase_ratios_2D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T&lt;:AbstractMatrix, N}"><span class="jlbinding">JustRelax.JustRelax3D.update_phase_ratios_2D!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustPIC.PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_arrays</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractMatrix}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, xvi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {B, T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, N}</span></span></code></pre></div><p>JustRelax routine based on <code>JustPIC._2D.update_phase_ratios!</code> or <code>JustPIC._3D.update_phase_ratios!</code>. Update the phase ratios in <code>phase_ratios</code> using the provided <code>phase_arrays</code>, <code>xci</code>, and <code>xvi</code>. The phase arrays need to be AbstractArrays and have values between 0 and 1.</p><p>#Example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx, ny </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_arrays </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (phase_1, phase_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Advect both phase arrays and update phase ratios</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phase_ratios, phase_arrays, xci, xvi)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/PhaseRatios.jl#L1-L22" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.update_phase_ratios_3D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T&lt;:AbstractArray, N}" href="#JustRelax.JustRelax3D.update_phase_ratios_3D!-Union{Tuple{N}, Tuple{T}, Tuple{B}, Tuple{JustPIC.PhaseRatios{B, T}, NTuple{N, AbstractMatrix}, Any, Any}} where {B, T&lt;:AbstractArray, N}"><span class="jlbinding">JustRelax.JustRelax3D.update_phase_ratios_3D!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustPIC.PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_arrays</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, AbstractArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, xvi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {B, T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, N}</span></span></code></pre></div><p>JustRelax routine based on <code>JustPIC._2D.update_phase_ratios!</code> or <code>JustPIC._3D.update_phase_ratios!</code>. Update the phase ratios in <code>phase_ratios</code> using the provided <code>phase_arrays</code>, <code>xci</code>, and <code>xvi</code>. The phase arrays need to be AbstractArrays and have values between 0 and 1.</p><p>#Example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nx, ny, nz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_1[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zeros</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nx, ny, nz)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_2[User_criterion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">phase_arrays </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (phase_1, phase_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Advect both phase arrays and update phase ratios</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_phase_ratios!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(phase_ratios, phase_arrays, xci, xvi)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/phases/PhaseRatios.jl#L36-L57" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.update_rock_ratio!-Union{Tuple{T}, Tuple{JustRelax.RockRatio{T, 2}, Any, Any}} where T" href="#JustRelax.JustRelax3D.update_rock_ratio!-Union{Tuple{T}, Tuple{JustRelax.RockRatio{T, 2}, Any, Any}} where T"><span class="jlbinding">JustRelax.JustRelax3D.update_rock_ratio!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_rock_ratio!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ϕ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JustRelax.RockRatio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_ratios, air_phase)</span></span></code></pre></div><p>Update the rock ratio <code>ϕ</code> based on the provided <code>phase_ratios</code> and <code>air_phase</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>ϕ::JustRelax.RockRatio</code>: The rock ratio object to be updated.</p></li><li><p><code>phase_ratios</code>: The ratios of different phases present.</p></li><li><p><code>air_phase</code>: The phase representing air.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/variational_stokes/mask.jl#L38-L47" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.update_α_β!-Union{Tuple{T}, Tuple{N}, NTuple{4, NTuple{N, AbstractArray{T, N}}}} where {N, T}" href="#JustRelax.JustRelax3D.update_α_β!-Union{Tuple{T}, Tuple{N}, NTuple{4, NTuple{N, AbstractArray{T, N}}}} where {N, T}"><span class="jlbinding">JustRelax.JustRelax3D.update_α_β!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">update_α_β!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(βV, αV, dτV, cV)</span></span></code></pre></div><p>Generic N-dimensional version (2D and 3D) of the acceleration parameters update.</p><p>Updates the damping parameters <code>βV</code> and <code>αV</code> for each velocity component based on the pseudo-time step <code>dτV</code> and the preconditioner diagonal <code>cV</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>βV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of damping parameters β for each velocity component</p></li><li><p><code>αV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of acceleration parameters α for each velocity component</p></li><li><p><code>dτV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of pseudo-time steps for each velocity component</p></li><li><p><code>cV::NTuple{N, AbstractArray{T, N}}</code>: Tuple of preconditioner diagonal entries for each velocity component</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/DYREL/Gershgorin.jl#L123-L136" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.velocity2vertex!-NTuple{6, Any}" href="#JustRelax.JustRelax3D.velocity2vertex!-NTuple{6, Any}"><span class="jlbinding">JustRelax.JustRelax3D.velocity2vertex!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity2vertex!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx_v, Vy_v, Vz_v, Vx, Vy, Vz)</span></span></code></pre></div><p>In-place interpolation of the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes onto the pre-allocated <code>Vx_d</code>, <code>Vy_d</code>, <code>Vz_d</code> 3D arrays located at the grid vertices.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L229-L234" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.velocity2vertex-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax3D.velocity2vertex-Tuple{Any, Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.velocity2vertex</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">velocity2vertex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Vx, Vy, Vz)</span></span></code></pre></div><p>Interpolate the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes onto the grid vertices.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Interpolations.jl#L209-L214" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@add-Tuple{Any, Vararg{Any}}" href="#JustRelax.JustRelax3D.@add-Tuple{Any, Vararg{Any}}"><span class="jlbinding">JustRelax.JustRelax3D.@add</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(I, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Add <code>I</code> to the scalars in <code>args</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L52-L56" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@copy-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.@copy-Tuple{Any, Any}"><span class="jlbinding">JustRelax.JustRelax3D.@copy</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(B, A)</span></span></code></pre></div><p>convenience macro to copy data from the array <code>A</code> into array <code>B</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L16-L20" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@displacement-Tuple{Any}" href="#JustRelax.JustRelax3D.@displacement-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@displacement</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@displacement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(U)</span></span></code></pre></div><p>Unpacks the displacement arrays <code>U</code> from the StokesArrays <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L94-L98" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@idx-Tuple" href="#JustRelax.JustRelax3D.@idx-Tuple"><span class="jlbinding">JustRelax.JustRelax3D.@idx</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Make a linear range from <code>1</code> to <code>args[i]</code>, with <code>i ∈ [1, ..., n]</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L2-L6" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@normal-Tuple{Any}" href="#JustRelax.JustRelax3D.@normal-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@normal</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@normal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the normal components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L259-L264" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@plastic_strain-Tuple{Any}" href="#JustRelax.JustRelax3D.@plastic_strain-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@plastic_strain</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@plastic_strain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the plastic strain rate tensor <code>ε_pl</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L166-L171" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@qT-Tuple{Any}" href="#JustRelax.JustRelax3D.@qT-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@qT</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@qT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the flux arrays <code>qT_i</code> from the ThermalArrays <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L110-L114" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@qT2-Tuple{Any}" href="#JustRelax.JustRelax3D.@qT2-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@qT2</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@qT2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the flux arrays <code>qT2_i</code> from the ThermalArrays <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L125-L129" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@residuals-Tuple{Any}" href="#JustRelax.JustRelax3D.@residuals-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@residuals</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@residuals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the momentum residuals from <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L347-L351" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@shear-Tuple{Any}" href="#JustRelax.JustRelax3D.@shear-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@shear</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@shear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L213-L218" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@shear_center-Tuple{Any}" href="#JustRelax.JustRelax3D.@shear_center-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@shear_center</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@shear_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L236-L241" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@strain-Tuple{Any}" href="#JustRelax.JustRelax3D.@strain-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@strain</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L142-L147" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@strain_center-Tuple{Any}" href="#JustRelax.JustRelax3D.@strain_center-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@strain_center</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L282-L287" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@strain_increment-Tuple{Any}" href="#JustRelax.JustRelax3D.@strain_increment-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@strain_increment</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@strain_increment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L154-L159" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@stress-Tuple{Any}" href="#JustRelax.JustRelax3D.@stress-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@stress</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@stress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L178-L183" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@stress_center-Tuple{Any}" href="#JustRelax.JustRelax3D.@stress_center-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@stress_center</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@stress_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L294-L299" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@tensor-Tuple{Any}" href="#JustRelax.JustRelax3D.@tensor-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@tensor</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@tensor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L190-L195" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@tensor_center-Tuple{Any}" href="#JustRelax.JustRelax3D.@tensor_center-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@tensor_center</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@tensor_center</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L306-L311" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@tensor_vertex-Tuple{Any}" href="#JustRelax.JustRelax3D.@tensor_vertex-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@tensor_vertex</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tensor_vertex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(A)</span></span></code></pre></div><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the vertices of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L329-L334" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.JustRelax3D.@velocity-Tuple{Any}" href="#JustRelax.JustRelax3D.@velocity-Tuple{Any}"><span class="jlbinding">JustRelax.JustRelax3D.@velocity</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@velocity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(V)</span></span></code></pre></div><p>Unpacks the velocity arrays <code>V</code> from the StokesArrays <code>A</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/Utils.jl#L79-L83" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.checkpoint_name-Tuple{Any}" href="#JustRelax.DataIO.checkpoint_name-Tuple{Any}"><span class="jlbinding">JustRelax.DataIO.checkpoint_name</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">checkpointing_jld2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dst, stokes, thermal, time, timestep, igg; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save necessary data in <code>dst</code> as a jld2 file to restart the model from the state at <code>time</code>. If run in parallel, the file will be named after the corresponidng rank e.g. <code>checkpoint0000.jld2</code> and thus can be loaded by the processor while restarting the simulation. If you want to restart your simulation from the checkpoint you can use load() and specify the MPI rank by providing a dollar sign and the rank number.</p><p><strong>Arguments</strong></p><ul><li><p><code>dst</code>: The destination directory where the checkpoint file will be saved.</p></li><li><p><code>stokes</code>: The stokes flow variables to be saved.</p></li><li><p><code>thermal</code>: (Optional) The thermal variables to be saved.</p></li><li><p><code>time</code>: The current simulation time.</p></li><li><p><code>timestep</code>: The current timestep.</p></li><li><p><code>igg</code>: (Optional) The IGG struct for parallel runs.</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code>: Additional variables to be saved in the checkpoint file. These will be added to the base checkpoint data. <strong>Example</strong><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span></code></pre></div></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/JLD2.jl#L1-L36" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.checkpointing_hdf5-NTuple{5, Any}" href="#JustRelax.DataIO.checkpointing_hdf5-NTuple{5, Any}"><span class="jlbinding">JustRelax.DataIO.checkpointing_hdf5</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">checkpointing_hdf5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dst, stokes, T, η, time, timestep)</span></span></code></pre></div><p>Save necessary data in <code>dst</code> as and HDF5 file to restart the model from the state at <code>time</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/H5.jl#L28-L32" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.load_checkpoint_hdf5-Tuple{Any}" href="#JustRelax.DataIO.load_checkpoint_hdf5-Tuple{Any}"><span class="jlbinding">JustRelax.DataIO.load_checkpoint_hdf5</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">load_checkpoint_hdf5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file_path)</span></span></code></pre></div><p>Load the state of the simulation from an .h5 file.</p><p><strong>Arguments</strong></p><ul><li><code>file_path</code>: The path to the .h5 file.</li></ul><p><strong>Returns</strong></p><ul><li><p><code>P</code>: The loaded state of the pressure variable.</p></li><li><p><code>T</code>: The loaded state of the temperature variable.</p></li><li><p><code>Vx</code>: The loaded state of the x-component of the velocity variable.</p></li><li><p><code>Vy</code>: The loaded state of the y-component of the velocity variable.</p></li><li><p><code>Vz</code>: The loaded state of the z-component of the velocity variable.</p></li><li><p><code>η</code>: The loaded state of the viscosity variable.</p></li><li><p><code>t</code>: The loaded simulation time.</p></li><li><p><code>dt</code>: The loaded simulation time.</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Define the path to the .h5 file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;path/to/your/file.h5&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use the load_checkpoint function to load the variables from the file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P, T, Vx, Vy, Vz, η, t, dt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `load_checkpoint(file_path)`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">`</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/H5.jl#L62-L88" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.load_checkpoint_jld2-Tuple{Any}" href="#JustRelax.DataIO.load_checkpoint_jld2-Tuple{Any}"><span class="jlbinding">JustRelax.DataIO.load_checkpoint_jld2</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">load_checkpoint_jld2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file_path)</span></span></code></pre></div><p>Load the state of the simulation from a .jld2 file.</p><p><strong>Arguments</strong></p><ul><li><code>file_path</code>: The path to the .jld2 file.</li></ul><p><strong>Returns</strong></p><ul><li><p><code>stokes</code>: The loaded state of the stokes variable.</p></li><li><p><code>thermal</code>: The loaded state of the thermal variable. Can be <code>nothing</code> if not present in the file.</p></li><li><p><code>time</code>: The loaded simulation time.</p></li><li><p><code>timestep</code>: The loaded time step.</p></li><li><p><code>igg</code>: The IGG struct if needed for parallel runs.</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">stokes, thermal, time, timestep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> load_checkpoint_jld2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;path/to/checkpoint.jld2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, igg)</span></span></code></pre></div><p>or without thermal</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">stokes, _, time, timestep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> load_checkpoint_jld2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;path/to/checkpoint.jld2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/JLD2.jl#L101-L124" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.metadata-Tuple{Any, Any, Vararg{Any}}" href="#JustRelax.DataIO.metadata-Tuple{Any, Any, Vararg{Any}}"><span class="jlbinding">JustRelax.DataIO.metadata</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(src, dst, files</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Copy <code>files...</code>, Manifest.toml, and Project.toml from <code>src</code> to <code>dst</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/DataIO.jl#L32-L36" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Any, Vararg{Any, N}}} where N" href="#JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Any, Vararg{Any, N}}} where N"><span class="jlbinding">JustRelax.DataIO.save_hdf5</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> save_hdf5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dst, fname, data)</span></span></code></pre></div><p>Save <code>data</code> as the <code>fname.h5</code> HDF5 file in the folder <code>dst</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/H5.jl#L107-L111" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Vararg{Any, N}}} where N" href="#JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Vararg{Any, N}}} where N"><span class="jlbinding">JustRelax.DataIO.save_hdf5</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> save_hdf5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname, data)</span></span></code></pre></div><p>Save <code>data</code> as the <code>fname.h5</code> HDF5 file</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/H5.jl#L133-L137" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.save_marker_chain-Tuple{String, Any}" href="#JustRelax.DataIO.save_marker_chain-Tuple{String, Any}"><span class="jlbinding">JustRelax.DataIO.save_marker_chain</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_marker_chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, chain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MarkerChain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; conversion</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0e3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save a vector of points as a line in a VTK file.</p><p><strong>Arguments</strong></p><ul><li><p><code>fname::String</code>: The name of the VTK file to save. The extension <code>.vtk</code> will be appended to the name.</p></li><li><p><code>chain::MarkerChain</code>: Marker chain object from JustPIC.jl.</p></li><li><p><code>conversion</code>: Conversion factor for coordinates (default: 1.0e3)</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename for time series</p></li><li><p><code>t::Number</code>: Time value (default: 0.0)</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L212-L223" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.save_particles-Tuple{Any, Any}" href="#JustRelax.DataIO.save_particles-Tuple{Any, Any}"><span class="jlbinding">JustRelax.DataIO.save_particles</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles{B, 2}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pPhases; conversion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./particles&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> B</span></span></code></pre></div><p>Save particle data and their material phase to a VTK file.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles::Particles{B, 2}</code>: The particle data, where <code>B</code> is the type of the particle coordinates.</p></li><li><p><code>pPhases</code>: The phases of the particles.</p></li><li><p><code>conversion</code>: A conversion factor for the particle coordinates (default is 1e3).</p></li><li><p><code>fname::String</code>: The name of the VTK file to save (default is &quot;./particles&quot;).</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename for time series</p></li><li><p><code>t::Number</code>: Time value (default: 0.0)</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L250-L262" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.save_particles-Tuple{Any}" href="#JustRelax.DataIO.save_particles-Tuple{Any}"><span class="jlbinding">JustRelax.DataIO.save_particles</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles{B, 2}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; conversion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./particles&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> B</span></span></code></pre></div><p>Save particle data to a VTK file.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles::Particles{B, 2}</code>: The particle data, where <code>B</code> is the type of the particle coordinates.</p></li><li><p><code>conversion</code>: A conversion factor for the particle coordinates (default is 1e3).</p></li><li><p><code>fname::String</code>: The name of the VTK file to save (default is &quot;./particles&quot;).</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename for time series</p></li><li><p><code>t::Number</code>: Time value (default: 0.0)</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L328-L339" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.save_vtk-Union{Tuple{T}, Tuple{N}, Tuple{String, Any, Any, NamedTuple, NamedTuple, NTuple{N, T}}} where {N, T}" href="#JustRelax.DataIO.save_vtk-Union{Tuple{T}, Tuple{N}, Tuple{String, Any, Any, NamedTuple, NamedTuple, NTuple{N, T}}} where {N, T}"><span class="jlbinding">JustRelax.DataIO.save_vtk</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xvi, xci, data_v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data_c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save VTK data with multiblock format containing both vertex and cell data.</p><p><strong>Arguments</strong></p><ul><li><p><code>fname::String</code>: The filename for the VTK file (without extension)</p></li><li><p><code>xvi</code>: Vertex coordinates (tuple of coordinate arrays)</p></li><li><p><code>xci</code>: Cell center coordinates (tuple of coordinate arrays)</p></li><li><p><code>data_v::NamedTuple</code>: Data defined at vertices</p></li><li><p><code>data_c::NamedTuple</code>: Data defined at cell centers</p></li><li><p><code>velocity::NTuple{N, T}</code>: Velocity field as a tuple of N-dimensional arrays</p></li><li><p><code>t::Number</code>: Time value (default: 0)</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename. If provided, the VTK file will be added to a time series collection. WriteVTK.jl automatically handles creating new collections or appending to existing ones.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Basic usage (backward compatible)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;output&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xvi, xci, data_v, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With ParaView collection for time series</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestep_001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xvi, xci, data_v, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;simulation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestep_002&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xvi, xci, data_v, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;simulation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># This creates simulation.pvd containing the time series</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Time series example</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">times </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i, t) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(times)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    fname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;timestep_</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(lpad(i, 3, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;0&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">))</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname, xvi, xci, data_v, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;full_simulation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L44-L76" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustRelax.DataIO.save_vtk-Union{Tuple{T}, Tuple{N}, Tuple{String, Any, NamedTuple, NTuple{N, T}}} where {N, T}" href="#JustRelax.DataIO.save_vtk-Union{Tuple{T}, Tuple{N}, Tuple{String, Any, NamedTuple, NTuple{N, T}}} where {N, T}"><span class="jlbinding">JustRelax.DataIO.save_vtk</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, data_c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save VTK data with cell-centered data and velocity field.</p><p><strong>Arguments</strong></p><ul><li><p><code>fname::String</code>: The filename for the VTK file (without extension)</p></li><li><p><code>xci</code>: Cell center coordinates (tuple of coordinate arrays)</p></li><li><p><code>data_c::NamedTuple</code>: Data defined at cell centers</p></li><li><p><code>velocity::NTuple{N, T}</code>: Velocity field as a tuple of N-dimensional arrays</p></li><li><p><code>t::Number</code>: Time value (default: nothing)</p></li><li><p><code>pvd::Union{Nothing, String}</code>: Optional ParaView collection filename. If provided, the VTK file will be added to a time series collection. WriteVTK.jl automatically handles creating new collections or appending to existing ones.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Basic usage</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;output&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With ParaView collection</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">save_vtk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;timestep_001&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, xci, data_c, velocity; t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pvd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;simulation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/PTsolvers/JustRelax.jl/blob/9b2fc4b39e02b584d355fdc6e0a7e169d5813dce/src/IO/VTK.jl#L129-L150" target="_blank" rel="noreferrer">source</a><!--]--></span></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/PTsolvers/JustRelax.jl/edit/main/docs/src/man/listfunctions.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/JustRelax.jl/previews/PR442/man/restart" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Restart</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/JustRelax.jl/previews/PR442/man/JustPIC" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>JustPIC</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2026 ⋅ The JustRelax Development Team.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"CAt84dQL\",\"man_advection.md\":\"CtVBWYqx\",\"man_authors.md\":\"CgK3dBlx\",\"man_backend.md\":\"sCQvPvFT\",\"man_blankenbach.md\":\"CXJuBDIQ\",\"man_boundary_conditions.md\":\"CGowVf-H\",\"man_checkpointing.md\":\"Z0xX8yts\",\"man_code_of_conduct.md\":\"6zP53-cd\",\"man_constitutive_equations.md\":\"fhW2Zn3N\",\"man_contributing.md\":\"wyEOA0B9\",\"man_dyrel.md\":\"B5ve1U0Q\",\"man_equations.md\":\"xLkJX6vo\",\"man_equations_apt.md\":\"Dc2Reg6R\",\"man_equations_basic.md\":\"DYVQzTcW\",\"man_equations_discretization.md\":\"CzKzSDl7\",\"man_equations_discretization0.md\":\"BxTdK81e\",\"man_geoparams.md\":\"aDhQVrYF\",\"man_installation.md\":\"3IYnQF10\",\"man_justpic.md\":\"kB4AW4eY\",\"man_license.md\":\"ClUb_jT-\",\"man_listfunctions.md\":\"_kcH8PR9\",\"man_material_physics.md\":\"s6ntck2M\",\"man_plume3d_plume3d.md\":\"1Kw_CtfI\",\"man_plume3d_rheology.md\":\"bhTHrP1C\",\"man_restart.md\":\"ask56oeb\",\"man_security.md\":\"D3QV2772\",\"man_shearbands.md\":\"Bf9xpTYy\",\"man_subduction2d_rheology.md\":\"BBiV3oak\",\"man_subduction2d_setup.md\":\"DRpObdHY\",\"man_subduction2d_subduction2d.md\":\"gMsFLv13\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"JustRelax.jl\",\"description\":\"Documentation for JustRelax.jl\",\"base\":\"/JustRelax.jl/previews/PR442/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Documentation\",\"link\":\"/man/installation\"},{\"text\":\"API\",\"link\":\"/man/listfunctions\"}],\"sidebar\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"User guide\",\"collapsed\":false,\"items\":[{\"text\":\"Installation\",\"link\":\"/man/installation\"},{\"text\":\"Backend\",\"link\":\"/man/backend\"},{\"text\":\"Equations\",\"collapsed\":false,\"items\":[{\"text\":\"Governing equations\",\"link\":\"/man/equations_basic\"},{\"text\":\"Constitutive equations\",\"link\":\"/man/constitutive_equations\"},{\"text\":\"APT equations\",\"link\":\"/man/equations_APT\"},{\"text\":\"Discretization\",\"link\":\"/man/equations_discretization\"}]},{\"text\":\"Boundary conditions\",\"link\":\"/man/boundary_conditions\"},{\"text\":\"Advection\",\"link\":\"/man/advection\"}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Blankenbach\",\"link\":\"/man/Blankenbach\"},{\"text\":\"Shear Bands\",\"link\":\"/man/ShearBands\"},{\"text\":\"Subduction 2D\",\"collapsed\":false,\"items\":[{\"text\":\"Model setup\",\"link\":\"/man/subduction2D/setup\"},{\"text\":\"Rheology\",\"link\":\"/man/subduction2D/rheology\"},{\"text\":\"Setting up the model\",\"link\":\"/man/subduction2D/subduction2D\"}]},{\"text\":\"Plume 3D\",\"collapsed\":false,\"items\":[{\"text\":\"Rheology\",\"link\":\"/man/plume3D/rheology\"},{\"text\":\"Setting up the model\",\"link\":\"/man/plume3D/plume3D\"}]},{\"text\":\"Self-tuned APT solver\",\"link\":\"/man/DYREL\"},{\"text\":\"Checkpointing/Restart\",\"collapsed\":false,\"items\":[{\"text\":\"Checkpointing\",\"link\":\"/man/checkpointing\"},{\"text\":\"Restart\",\"link\":\"/man/restart\"}]}]},{\"text\":\"List of functions\",\"link\":\"/man/listfunctions\"},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"JustPIC\",\"link\":\"/man/JustPIC\"},{\"text\":\"GeoParams\",\"link\":\"/man/GeoParams\"}]},{\"text\":\"Authors\",\"link\":\"/man/authors\"},{\"text\":\"Contributing\",\"link\":\"/man/contributing\"},{\"text\":\"Code of Conduct\",\"link\":\"/man/code_of_conduct\"},{\"text\":\"Security\",\"link\":\"/man/security\"},{\"text\":\"License\",\"link\":\"/man/license\"}],\"editLink\":{\"pattern\":\"https://github.com/PTsolvers/JustRelax.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/PTsolvers/JustRelax.jl\"},{\"icon\":\"slack\",\"link\":\"https://julialang.org/slack/\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2026 ⋅ The JustRelax Development Team.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>