<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>List of functions · JustRelax.jl</title><meta name="title" content="List of functions · JustRelax.jl"/><meta property="og:title" content="List of functions · JustRelax.jl"/><meta property="twitter:title" content="List of functions · JustRelax.jl"/><meta name="description" content="Documentation for JustRelax.jl."/><meta property="og:description" content="Documentation for JustRelax.jl."/><meta property="twitter:description" content="Documentation for JustRelax.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JustRelax.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../backend/">Backend</a></li><li><a class="tocitem" href="../equations/">Equations</a></li><li><a class="tocitem" href="../advection/">Advection</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Blankenbach/">Blankenbach</a></li><li><a class="tocitem" href="../ShearBands/">Shear Bands</a></li></ul></li><li class="is-active"><a class="tocitem" href>List of functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>List of functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>List of functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PTsolvers/JustRelax.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PTsolvers/JustRelax.jl/blob/main/docs/src/man/listfunctions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="List-of-all-functions"><a class="docs-heading-anchor" href="#List-of-all-functions">List of all functions</a><a id="List-of-all-functions-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-all-functions" title="Permalink"></a></h1><p>Here an overview of all functions:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.Geometry" href="#JustRelax.Geometry"><code>JustRelax.Geometry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Geometry{nDim,T}</code></pre><p>A struct representing the geometry of a topological object in nDim dimensions.</p><p><strong>Arguments</strong></p><ul><li><code>nDim</code>: The number of dimensions of the topological object.</li><li><code>T</code>: The type of the elements in the topological object.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/topology/Topology.jl#L15-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.cart2ind-Union{Tuple{N2}, Tuple{N1}, Tuple{Tuple{Vararg{Int64, N1}}, Vararg{Int64, N2}}} where {N1, N2}" href="#JustRelax.cart2ind-Union{Tuple{N2}, Tuple{N1}, Tuple{Tuple{Vararg{Int64, N1}}, Vararg{Int64, N2}}} where {N1, N2}"><code>JustRelax.cart2ind</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cart2ind(A)</code></pre><p>Return the linear index of a <code>n</code>-dimensional array corresponding to the cartesian indices <code>I</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/phases/CellArrays.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.element-Union{Tuple{D}, Tuple{Nc}, Tuple{N}, Tuple{T_elem}, Tuple{CellArrays.CellArray{StaticArraysCore.SVector, N, D, T_elem}, Int64, Vararg{Int64, Nc}}} where {T_elem, N, Nc, D}" href="#JustRelax.element-Union{Tuple{D}, Tuple{Nc}, Tuple{N}, Tuple{T_elem}, Tuple{CellArrays.CellArray{StaticArraysCore.SVector, N, D, T_elem}, Int64, Vararg{Int64, Nc}}} where {T_elem, N, Nc, D}"><code>JustRelax.element</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">element(A, element_indices..., cell_indices...)</code></pre><p>Return a the element with <code>element_indices</code> of the Cell with <code>cell_indices</code> of the CellArray <code>A</code>.</p><p><strong>Arguments</strong></p><ul><li><code>element_indices::Int|NTuple{N,Int}</code>: the <code>element_indices</code> that designate the field in accordance with <code>A</code>&#39;s cell type.</li><li><code>cell_indices::Int|NTuple{N,Int}</code>: the <code>cell_indices</code> that designate the cell in accordance with <code>A</code>&#39;s cell type.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/phases/CellArrays.jl#L33-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.setelement!-Union{Tuple{D}, Tuple{T_elem}, Tuple{N}, Tuple{T}, Tuple{N_array}, Tuple{Nj}, Tuple{Ni}, Tuple{Nc}, Tuple{CellArrays.CellArray{StaticArraysCore.SMatrix{Ni, Nj, T, N_array}, N, D, T_elem}, T, Any, Any, Vararg{Int64, Nc}}} where {Nc, Ni, Nj, N_array, T, N, T_elem, D}" href="#JustRelax.setelement!-Union{Tuple{D}, Tuple{T_elem}, Tuple{N}, Tuple{T}, Tuple{N_array}, Tuple{Nj}, Tuple{Ni}, Tuple{Nc}, Tuple{CellArrays.CellArray{StaticArraysCore.SMatrix{Ni, Nj, T, N_array}, N, D, T_elem}, T, Any, Any, Vararg{Int64, Nc}}} where {Nc, Ni, Nj, N_array, T, N, T_elem, D}"><code>JustRelax.setelement!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">setelement!(A, x, element_indices..., cell_indices...)</code></pre><p>Store the given value <code>x</code> at the given element with <code>element_indices</code> of the cell with the indices <code>cell_indices</code></p><p><strong>Arguments</strong></p><ul><li><code>x::Number</code>: value to be stored in the index <code>element_indices</code> of the cell with <code>cell_indices</code>.</li><li><code>element_indices::Int|NTuple{N,Int}</code>: the <code>element_indices</code> that designate the field in accordance with <code>A</code>&#39;s cell type.</li><li><code>cell_indices::Int|NTuple{N,Int}</code>: the <code>cell_indices</code> that designate the cell in accordance with <code>A</code>&#39;s cell type.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/phases/CellArrays.jl#L72-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.velocity_grids-Union{Tuple{T}, Tuple{Any, Any, Tuple{T, T}}} where T" href="#JustRelax.velocity_grids-Union{Tuple{T}, Tuple{Any, Any, Tuple{T, T}}} where T"><code>JustRelax.velocity_grids</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">velocity_grids(xci, xvi, di::NTuple{N,T}) where {N,T}</code></pre><p>Compute the velocity grids for N dimensionional problems.</p><p><strong>Arguments</strong></p><ul><li><code>xci</code>: The x-coordinate of the cell centers.</li><li><code>xvi</code>: The x-coordinate of the cell vertices.</li><li><code>di</code>: A tuple containing the cell dimensions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/topology/Topology.jl#L81-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.WENO5" href="#JustRelax.JustRelax2D.WENO5"><code>JustRelax.JustRelax2D.WENO5</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">WENO5{T, N, A, M} &lt;: AbstractWENO</code></pre><p>The <code>WENO5</code> is a structure representing the Weighted Essentially Non-Oscillatory (WENO) scheme of order 5 for the solution of hyperbolic partial differential equations.</p><p><strong>Fields</strong></p><ul><li><code>d0L</code>, <code>d1L</code>, <code>d2L</code>: Upwind constants.</li><li><code>d0R</code>, <code>d1R</code>, <code>d2R</code>: Downwind constants.</li><li><code>c1</code>, <code>c2</code>: Constants for betas.</li><li><code>sc1</code>, <code>sc2</code>, <code>sc3</code>, <code>sc4</code>, <code>sc5</code>: Stencil weights.</li><li><code>ϵ</code>: Tolerance.</li><li><code>ni</code>: Grid size.</li><li><code>ut</code>: Intermediate buffer array.</li><li><code>fL</code>, <code>fR</code>, <code>fB</code>, <code>fT</code>: Fluxes.</li><li><code>method</code>: Method (1:JS, 2:Z).</li></ul><p><strong>Description</strong></p><p>The <code>WENO5</code> structure contains the parameters and temporary variables used in the WENO scheme. These include the upwind and downwind constants, the constants for betas, the stencil candidate weights, the tolerance, the grid size, the fluxes, and the method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/advection/weno5.jl#L8-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.WENO_advection!-NTuple{5, Any}" href="#JustRelax.JustRelax2D.WENO_advection!-NTuple{5, Any}"><code>JustRelax.JustRelax2D.WENO_advection!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">WENO_advection!(u, Vxi, weno, di, ni, dt)</code></pre><p>Perform the advection step of the Weighted Essentially Non-Oscillatory (WENO) scheme for the solution of hyperbolic partial differential equations.</p><p><strong>Arguments</strong></p><ul><li><code>u</code>: field to be advected.</li><li><code>Vxi</code>: velocity field.</li><li><code>weno</code>: structure containing the WENO scheme parameters and temporary variables.</li><li><code>di</code>: grid spacing.</li><li><code>ni</code>: number of grid points.</li><li><code>dt</code>: time step.</li></ul><p><strong>Description</strong></p><p>The function first calculates the fluxes using the WENO scheme. Then it performs three steps of the WENO scheme. Each step involves calculating the right-hand side of the WENO equation and updating the solution <code>u</code>. The updating of the solution <code>u</code> is done using different combinations of the original solution and the temporary solution <code>weno.ut</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/advection/weno5.jl#L236-L251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D._compute_dt-Tuple{JustRelax.StokesArrays, Any, Any, IGG}" href="#JustRelax.JustRelax2D._compute_dt-Tuple{JustRelax.StokesArrays, Any, Any, IGG}"><code>JustRelax.JustRelax2D._compute_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_dt(S::JustRelax.StokesArrays, di, dt_diff)</code></pre><p>Compute the time step <code>dt</code> for the velocity field <code>S.V</code> and the diffusive maximum time step <code>dt_diff</code> for a regular gridwith grid spacing <code>di</code>. The implicit global grid variable <code>I</code> implies that the time step is calculated globally and not separately on each block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L441-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D._compute_dt-Tuple{JustRelax.StokesArrays, Any, Any}" href="#JustRelax.JustRelax2D._compute_dt-Tuple{JustRelax.StokesArrays, Any, Any}"><code>JustRelax.JustRelax2D._compute_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_dt(S::JustRelax.StokesArrays, di, dt_diff)</code></pre><p>Compute the time step <code>dt</code> for the velocity field <code>S.V</code> and the diffusive maximum time step <code>dt_diff</code> for a regular gridwith grid spacing <code>di</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L417-L422">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D._compute_dt-Tuple{JustRelax.StokesArrays, Any, IGG}" href="#JustRelax.JustRelax2D._compute_dt-Tuple{JustRelax.StokesArrays, Any, IGG}"><code>JustRelax.JustRelax2D._compute_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_dt(S::JustRelax.StokesArrays, di, igg)</code></pre><p>Compute the time step <code>dt</code> for the velocity field <code>S.V</code> for a regular gridwith grid spacing <code>di</code>. The implicit global grid variable <code>I</code> implies that the time step is calculated globally and not separately on each block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L431-L437">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D._compute_dt-Tuple{JustRelax.StokesArrays, Any}" href="#JustRelax.JustRelax2D._compute_dt-Tuple{JustRelax.StokesArrays, Any}"><code>JustRelax.JustRelax2D._compute_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_dt(S::JustRelax.StokesArrays, di)</code></pre><p>Compute the time step <code>dt</code> for the velocity field <code>S.V</code> for a regular grid with grid spacing <code>di</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L410-L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}" href="#JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}"><code>JustRelax.JustRelax2D._heatdiffusion_PT!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">heatdiffusion_PT!(thermal, pt_thermal, K, ρCp, dt, di; iterMax, nout, verbose)</code></pre><p>Heat diffusion solver using Pseudo-Transient iterations. Both <code>K</code> and <code>ρCp</code> are n-dimensional arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/thermal_diffusion/DiffusionPT_solver.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}" href="#JustRelax.JustRelax2D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}"><code>JustRelax.JustRelax2D._heatdiffusion_PT!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">heatdiffusion_PT!(thermal, pt_thermal, rheology, dt, di; iterMax, nout, verbose)</code></pre><p>Heat diffusion solver using Pseudo-Transient iterations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/thermal_diffusion/DiffusionPT_solver.jl#L98-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.allzero-Union{Tuple{Vararg{T, N}}, Tuple{N}, Tuple{T}} where {T, N}" href="#JustRelax.JustRelax2D.allzero-Union{Tuple{Vararg{T, N}}, Tuple{N}, Tuple{T}} where {T, N}"><code>JustRelax.JustRelax2D.allzero</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">allzero(x::Vararg{T,N}) where {T,N}</code></pre><p>Check if all elements in <code>x</code> are zero.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vararg{T,N}</code>: The input array.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if all elements in <code>x</code> are zero, <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L461-L471">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}" href="#JustRelax.JustRelax2D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}"><code>JustRelax.JustRelax2D.assign!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assign!(B::AbstractArray{T,N}, A::AbstractArray{T,N}) where {T,N}</code></pre><p>Assigns the values of array <code>A</code> to array <code>B</code> in parallel.</p><p><strong>Arguments</strong></p><ul><li><code>B::AbstractArray{T,N}</code>: The destination array.</li><li><code>A::AbstractArray{T,N}</code>: The source array.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L494-L502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Tuple{Vararg{GeoParams.MaterialParameters.MaterialParams, N}}, Any, Any, Any, Any, NamedTuple}} where N" href="#JustRelax.JustRelax2D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Tuple{Vararg{GeoParams.MaterialParameters.MaterialParams, N}}, Any, Any, Any, Any, NamedTuple}} where N"><code>JustRelax.JustRelax2D.compute_P!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>compute<em>P!(P, P0, RP, ∇V, ΔTc, η, rheology::NTuple{N,MaterialParams}, phase</em>ratio::C, dt, r, θ_dτ)</p><p>Compute the pressure field <code>P</code> and the residual <code>RP</code> for the compressible case. This function introduces thermal stresses after the implementation of Kiss et al. (2023). The temperature difference <code>ΔTc</code> on the cell center is used to compute this as well as α as the thermal expansivity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/stokes/PressureKernels.jl#L27-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any, Any}"><code>JustRelax.JustRelax2D.compute_buoyancy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_buoyancy(rheology, args, phase_ratios)</code></pre><p>Compute the buoyancy forces based on the given rheology, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><code>rheology</code>: The rheology used to compute the buoyancy forces.</li><li><code>args</code>: Additional arguments required by the rheology.</li><li><code>phase_ratios</code>: The ratios of the different phases.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L78-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.compute_buoyancy-Tuple{Any, Any}"><code>JustRelax.JustRelax2D.compute_buoyancy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_buoyancy(rheology, args)</code></pre><p>Compute the buoyancy forces based on the given rheology and arguments.</p><p><strong>Arguments</strong></p><ul><li><code>rheology</code>: The rheology used to compute the buoyancy forces.</li><li><code>args</code>: Additional arguments required for the computation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L65-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.compute_buoyancy-Tuple{GeoParams.MaterialParameters.MaterialParams, Any, Any}" href="#JustRelax.JustRelax2D.compute_buoyancy-Tuple{GeoParams.MaterialParameters.MaterialParams, Any, Any}"><code>JustRelax.JustRelax2D.compute_buoyancy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_buoyancy(rheology::MaterialParams, args, phase_ratios)</code></pre><p>Compute the buoyancy forces for a given set of material parameters, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><code>rheology</code>: The material parameters.</li><li><code>args</code>: The arguments.</li><li><code>phase_ratios</code>: The phase ratios.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L51-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.compute_buoyancy-Tuple{GeoParams.MaterialParameters.MaterialParams, Any}" href="#JustRelax.JustRelax2D.compute_buoyancy-Tuple{GeoParams.MaterialParameters.MaterialParams, Any}"><code>JustRelax.JustRelax2D.compute_buoyancy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_buoyancy(rheology::MaterialParams, args)</code></pre><p>Compute the buoyancy forces based on the given rheology parameters and arguments.</p><p><strong>Arguments</strong></p><ul><li><code>rheology::MaterialParams</code>: The material parameters for the rheology.</li><li><code>args</code>: The arguments for the computation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L38-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.compute_maxloc!-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.compute_maxloc!-Tuple{Any, Any}"><code>JustRelax.JustRelax2D.compute_maxloc!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">maxloc!(B, A; window)</code></pre><p>Compute the maximum value of <code>A</code> in the <code>window = (width_x, width_y, width_z)</code> and store the result in <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L328-L332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, Any, Any}"><code>JustRelax.JustRelax2D.compute_ρg!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_ρg!(ρg, rheology, args)</code></pre><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, JustRelax.PhaseRatio, Any, Any}" href="#JustRelax.JustRelax2D.compute_ρg!-Tuple{Any, JustRelax.PhaseRatio, Any, Any}"><code>JustRelax.JustRelax2D.compute_ρg!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_ρg!(ρg, phase_ratios, rheology, args)</code></pre><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>.  The <code>phase_ratios</code> are used to compute the density of the composite rheology.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L18-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T" href="#JustRelax.JustRelax2D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T"><code>JustRelax.JustRelax2D.continuation_log</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">continuation_log(x_new, x_old, ν)</code></pre><p>Do a continuation step <code>exp((1-ν)*log(x_old) + ν*log(x_new))</code> with damping parameter <code>ν</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L481-L485">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.flow_bcs!-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.flow_bcs!-Tuple{Any, Any}"><code>JustRelax.JustRelax2D.flow_bcs!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">flow_bcs!(stokes, bcs::FlowBoundaryConditions, di)</code></pre><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/boundaryconditions/BoundaryConditions.jl#L40-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, Tuple{Vararg{GeoParams.AbstractMaterialParamsStruct, N}}, Any}} where {N, F}" href="#JustRelax.JustRelax2D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, Tuple{Vararg{GeoParams.AbstractMaterialParamsStruct, N}}, Any}} where {N, F}"><code>JustRelax.JustRelax2D.fn_ratio</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fn_ratio(fn::F, rheology::NTuple{N, AbstractMaterialParamsStruct}, ratio) where {N, F}</code></pre><p>Average the function <code>fn</code> over the material phases in <code>rheology</code> using the phase ratios <code>ratio</code>.    </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/phases/phases.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}" href="#JustRelax.JustRelax2D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}"><code>JustRelax.JustRelax2D.interp_Vx_on_Vy!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">interp_Vx_on_Vy!(Vx_on_Vy, Vx)</code></pre><p>Interpolates the values of <code>Vx</code> onto the grid points of <code>Vy</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Vx_on_Vy::AbstractArray</code>: <code>Vx</code> at <code>Vy</code> grid points.</li><li><code>Vx::AbstractArray</code>: <code>Vx</code> at its staggered grid points.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Interpolations.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.nphases-Tuple{JustRelax.PhaseRatio}" href="#JustRelax.JustRelax2D.nphases-Tuple{JustRelax.PhaseRatio}"><code>JustRelax.JustRelax2D.nphases</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nphases(x::JustRelax.PhaseRatio)</code></pre><p>Return the number of phases in <code>x::JustRelax.PhaseRatio</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/phases/phases.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.rotate_stress!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Tuple{Vararg{T, N}}, Any, Any, Any}} where {N, T}" href="#JustRelax.JustRelax2D.rotate_stress!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Tuple{Vararg{T, N}}, Any, Any, Any}} where {N, T}"><code>JustRelax.JustRelax2D.rotate_stress!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Jaumann derivative</code></pre><p>τij<em>o += v</em>k * ∂τij<em>o/∂x</em>k - ω<em>ij * ∂τkj</em>o + ∂τkj<em>o * ω</em>ij</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/stokes/StressRotation.jl#L95-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.take-Tuple{String}" href="#JustRelax.JustRelax2D.take-Tuple{String}"><code>JustRelax.JustRelax2D.take</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">take(fldr::String)</code></pre><p>Create folder <code>fldr</code> if it does not exist.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L474-L478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}" href="#JustRelax.JustRelax2D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}"><code>JustRelax.JustRelax2D.tensor_invariant!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tensor_invariant!(A::JustRelax.SymmetricTensor)</code></pre><p>Compute the tensor invariant of the given symmetric tensor <code>A</code>.</p><p><strong>Arguments</strong></p><ul><li><code>A::JustRelax.SymmetricTensor</code>: The input symmetric tensor.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/stokes/StressKernels.jl#L338-L345">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.thermal_bcs!-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.thermal_bcs!-Tuple{Any, Any}"><code>JustRelax.JustRelax2D.thermal_bcs!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">thermal_bcs!(T, bcs::TemperatureBoundaryConditions)</code></pre><p>Apply the prescribed heat boundary conditions <code>bc</code> on the <code>T</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/boundaryconditions/BoundaryConditions.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.velocity2vertex!-NTuple{6, Any}" href="#JustRelax.JustRelax2D.velocity2vertex!-NTuple{6, Any}"><code>JustRelax.JustRelax2D.velocity2vertex!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">velocity2vertex!(Vx_v, Vy_v, Vz_v, Vx, Vy, Vz)</code></pre><p>In-place interpolation of the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes  onto the pre-allocated <code>Vx_d</code>, <code>Vy_d</code>, <code>Vz_d</code> 3D arrays located at the grid vertices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Interpolations.jl#L252-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.velocity2vertex-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax2D.velocity2vertex-Tuple{Any, Any, Any}"><code>JustRelax.JustRelax2D.velocity2vertex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">velocity2vertex(Vx, Vy, Vz)</code></pre><p>Interpolate the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes  onto the grid vertices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Interpolations.jl#L232-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@add-Tuple{Any, Vararg{Any}}" href="#JustRelax.JustRelax2D.@add-Tuple{Any, Vararg{Any}}"><code>JustRelax.JustRelax2D.@add</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@add(I, args...)</code></pre><p>Add <code>I</code> to the scalars in <code>args</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L65-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@copy-Tuple{Any, Any}" href="#JustRelax.JustRelax2D.@copy-Tuple{Any, Any}"><code>JustRelax.JustRelax2D.@copy</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">copy(B, A)</code></pre><p>convenience macro to copy data from the array <code>A</code> into array <code>B</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@idx-Tuple" href="#JustRelax.JustRelax2D.@idx-Tuple"><code>JustRelax.JustRelax2D.@idx</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@idx(args...)</code></pre><p>Make a linear range from <code>1</code> to <code>args[i]</code>, with <code>i ∈ [1, ..., n]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@normal-Tuple{Any}" href="#JustRelax.JustRelax2D.@normal-Tuple{Any}"><code>JustRelax.JustRelax2D.@normal</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@normal(A)</code></pre><p>Unpacks the normal components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L221-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@qT-Tuple{Any}" href="#JustRelax.JustRelax2D.@qT-Tuple{Any}"><code>JustRelax.JustRelax2D.@qT</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@qT(V)</code></pre><p>Unpacks the flux arrays <code>qT_i</code> from the ThermalArrays <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@qT2-Tuple{Any}" href="#JustRelax.JustRelax2D.@qT2-Tuple{Any}"><code>JustRelax.JustRelax2D.@qT2</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@qT2(V)</code></pre><p>Unpacks the flux arrays <code>qT2_i</code> from the ThermalArrays <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L122-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@residuals-Tuple{Any}" href="#JustRelax.JustRelax2D.@residuals-Tuple{Any}"><code>JustRelax.JustRelax2D.@residuals</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@residuals(A)</code></pre><p>Unpacks the momentum residuals from <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L291-L295">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@shear-Tuple{Any}" href="#JustRelax.JustRelax2D.@shear-Tuple{Any}"><code>JustRelax.JustRelax2D.@shear</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@shear(A)</code></pre><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L198-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@strain-Tuple{Any}" href="#JustRelax.JustRelax2D.@strain-Tuple{Any}"><code>JustRelax.JustRelax2D.@strain</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@strain(A)</code></pre><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L139-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@strain_center-Tuple{Any}" href="#JustRelax.JustRelax2D.@strain_center-Tuple{Any}"><code>JustRelax.JustRelax2D.@strain_center</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@strain_center(A)</code></pre><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L244-L249">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@strain_plastic-Tuple{Any}" href="#JustRelax.JustRelax2D.@strain_plastic-Tuple{Any}"><code>JustRelax.JustRelax2D.@strain_plastic</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@strain_plastic(A)</code></pre><p>Unpacks the plastic strain rate tensor <code>ε_pl</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L151-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@stress-Tuple{Any}" href="#JustRelax.JustRelax2D.@stress-Tuple{Any}"><code>JustRelax.JustRelax2D.@stress</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@stress(A)</code></pre><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L163-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@stress_center-Tuple{Any}" href="#JustRelax.JustRelax2D.@stress_center-Tuple{Any}"><code>JustRelax.JustRelax2D.@stress_center</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@stress_center(A)</code></pre><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L256-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@tensor-Tuple{Any}" href="#JustRelax.JustRelax2D.@tensor-Tuple{Any}"><code>JustRelax.JustRelax2D.@tensor</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@tensor(A)</code></pre><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L175-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@tensor_center-Tuple{Any}" href="#JustRelax.JustRelax2D.@tensor_center-Tuple{Any}"><code>JustRelax.JustRelax2D.@tensor_center</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@tensor_center(A)</code></pre><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L268-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax2D.@velocity-Tuple{Any}" href="#JustRelax.JustRelax2D.@velocity-Tuple{Any}"><code>JustRelax.JustRelax2D.@velocity</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@velocity(V)</code></pre><p>Unpacks the velocity arrays <code>V</code> from the StokesArrays <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L92-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.WENO5" href="#JustRelax.JustRelax3D.WENO5"><code>JustRelax.JustRelax3D.WENO5</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">WENO5{T, N, A, M} &lt;: AbstractWENO</code></pre><p>The <code>WENO5</code> is a structure representing the Weighted Essentially Non-Oscillatory (WENO) scheme of order 5 for the solution of hyperbolic partial differential equations.</p><p><strong>Fields</strong></p><ul><li><code>d0L</code>, <code>d1L</code>, <code>d2L</code>: Upwind constants.</li><li><code>d0R</code>, <code>d1R</code>, <code>d2R</code>: Downwind constants.</li><li><code>c1</code>, <code>c2</code>: Constants for betas.</li><li><code>sc1</code>, <code>sc2</code>, <code>sc3</code>, <code>sc4</code>, <code>sc5</code>: Stencil weights.</li><li><code>ϵ</code>: Tolerance.</li><li><code>ni</code>: Grid size.</li><li><code>ut</code>: Intermediate buffer array.</li><li><code>fL</code>, <code>fR</code>, <code>fB</code>, <code>fT</code>: Fluxes.</li><li><code>method</code>: Method (1:JS, 2:Z).</li></ul><p><strong>Description</strong></p><p>The <code>WENO5</code> structure contains the parameters and temporary variables used in the WENO scheme. These include the upwind and downwind constants, the constants for betas, the stencil candidate weights, the tolerance, the grid size, the fluxes, and the method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/advection/weno5.jl#L8-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.WENO_advection!-NTuple{5, Any}" href="#JustRelax.JustRelax3D.WENO_advection!-NTuple{5, Any}"><code>JustRelax.JustRelax3D.WENO_advection!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">WENO_advection!(u, Vxi, weno, di, ni, dt)</code></pre><p>Perform the advection step of the Weighted Essentially Non-Oscillatory (WENO) scheme for the solution of hyperbolic partial differential equations.</p><p><strong>Arguments</strong></p><ul><li><code>u</code>: field to be advected.</li><li><code>Vxi</code>: velocity field.</li><li><code>weno</code>: structure containing the WENO scheme parameters and temporary variables.</li><li><code>di</code>: grid spacing.</li><li><code>ni</code>: number of grid points.</li><li><code>dt</code>: time step.</li></ul><p><strong>Description</strong></p><p>The function first calculates the fluxes using the WENO scheme. Then it performs three steps of the WENO scheme. Each step involves calculating the right-hand side of the WENO equation and updating the solution <code>u</code>. The updating of the solution <code>u</code> is done using different combinations of the original solution and the temporary solution <code>weno.ut</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/advection/weno5.jl#L236-L251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D._compute_dt-Tuple{JustRelax.StokesArrays, Any, Any, IGG}" href="#JustRelax.JustRelax3D._compute_dt-Tuple{JustRelax.StokesArrays, Any, Any, IGG}"><code>JustRelax.JustRelax3D._compute_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_dt(S::JustRelax.StokesArrays, di, dt_diff)</code></pre><p>Compute the time step <code>dt</code> for the velocity field <code>S.V</code> and the diffusive maximum time step <code>dt_diff</code> for a regular gridwith grid spacing <code>di</code>. The implicit global grid variable <code>I</code> implies that the time step is calculated globally and not separately on each block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L441-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D._compute_dt-Tuple{JustRelax.StokesArrays, Any, Any}" href="#JustRelax.JustRelax3D._compute_dt-Tuple{JustRelax.StokesArrays, Any, Any}"><code>JustRelax.JustRelax3D._compute_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_dt(S::JustRelax.StokesArrays, di, dt_diff)</code></pre><p>Compute the time step <code>dt</code> for the velocity field <code>S.V</code> and the diffusive maximum time step <code>dt_diff</code> for a regular gridwith grid spacing <code>di</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L417-L422">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D._compute_dt-Tuple{JustRelax.StokesArrays, Any, IGG}" href="#JustRelax.JustRelax3D._compute_dt-Tuple{JustRelax.StokesArrays, Any, IGG}"><code>JustRelax.JustRelax3D._compute_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_dt(S::JustRelax.StokesArrays, di, igg)</code></pre><p>Compute the time step <code>dt</code> for the velocity field <code>S.V</code> for a regular gridwith grid spacing <code>di</code>. The implicit global grid variable <code>I</code> implies that the time step is calculated globally and not separately on each block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L431-L437">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D._compute_dt-Tuple{JustRelax.StokesArrays, Any}" href="#JustRelax.JustRelax3D._compute_dt-Tuple{JustRelax.StokesArrays, Any}"><code>JustRelax.JustRelax3D._compute_dt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_dt(S::JustRelax.StokesArrays, di)</code></pre><p>Compute the time step <code>dt</code> for the velocity field <code>S.V</code> for a regular grid with grid spacing <code>di</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L410-L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}" href="#JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, AbstractArray, AbstractArray, Any, Any}"><code>JustRelax.JustRelax3D._heatdiffusion_PT!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">heatdiffusion_PT!(thermal, pt_thermal, K, ρCp, dt, di; iterMax, nout, verbose)</code></pre><p>Heat diffusion solver using Pseudo-Transient iterations. Both <code>K</code> and <code>ρCp</code> are n-dimensional arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/thermal_diffusion/DiffusionPT_solver.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}" href="#JustRelax.JustRelax3D._heatdiffusion_PT!-Tuple{JustRelax.ThermalArrays, JustRelax.PTThermalCoeffs, TemperatureBoundaryConditions, Any, NamedTuple, Any, Any}"><code>JustRelax.JustRelax3D._heatdiffusion_PT!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">heatdiffusion_PT!(thermal, pt_thermal, rheology, dt, di; iterMax, nout, verbose)</code></pre><p>Heat diffusion solver using Pseudo-Transient iterations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/thermal_diffusion/DiffusionPT_solver.jl#L98-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.allzero-Union{Tuple{Vararg{T, N}}, Tuple{N}, Tuple{T}} where {T, N}" href="#JustRelax.JustRelax3D.allzero-Union{Tuple{Vararg{T, N}}, Tuple{N}, Tuple{T}} where {T, N}"><code>JustRelax.JustRelax3D.allzero</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">allzero(x::Vararg{T,N}) where {T,N}</code></pre><p>Check if all elements in <code>x</code> are zero.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vararg{T,N}</code>: The input array.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if all elements in <code>x</code> are zero, <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L461-L471">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}" href="#JustRelax.JustRelax3D.assign!-Union{Tuple{N}, Tuple{T}, Tuple{AbstractArray{T, N}, AbstractArray{T, N}, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}} where {T, N}"><code>JustRelax.JustRelax3D.assign!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assign!(B::AbstractArray{T,N}, A::AbstractArray{T,N}) where {T,N}</code></pre><p>Assigns the values of array <code>A</code> to array <code>B</code> in parallel.</p><p><strong>Arguments</strong></p><ul><li><code>B::AbstractArray{T,N}</code>: The destination array.</li><li><code>A::AbstractArray{T,N}</code>: The source array.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L494-L502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Tuple{Vararg{GeoParams.MaterialParameters.MaterialParams, N}}, Any, Any, Any, Any, NamedTuple}} where N" href="#JustRelax.JustRelax3D.compute_P!-Union{Tuple{N}, Tuple{Any, Any, Any, Any, Any, Tuple{Vararg{GeoParams.MaterialParameters.MaterialParams, N}}, Any, Any, Any, Any, NamedTuple}} where N"><code>JustRelax.JustRelax3D.compute_P!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>compute<em>P!(P, P0, RP, ∇V, ΔTc, η, rheology::NTuple{N,MaterialParams}, phase</em>ratio::C, dt, r, θ_dτ)</p><p>Compute the pressure field <code>P</code> and the residual <code>RP</code> for the compressible case. This function introduces thermal stresses after the implementation of Kiss et al. (2023). The temperature difference <code>ΔTc</code> on the cell center is used to compute this as well as α as the thermal expansivity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/stokes/PressureKernels.jl#L27-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any, Any}"><code>JustRelax.JustRelax3D.compute_buoyancy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_buoyancy(rheology, args, phase_ratios)</code></pre><p>Compute the buoyancy forces based on the given rheology, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><code>rheology</code>: The rheology used to compute the buoyancy forces.</li><li><code>args</code>: Additional arguments required by the rheology.</li><li><code>phase_ratios</code>: The ratios of the different phases.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L78-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.compute_buoyancy-Tuple{Any, Any}"><code>JustRelax.JustRelax3D.compute_buoyancy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_buoyancy(rheology, args)</code></pre><p>Compute the buoyancy forces based on the given rheology and arguments.</p><p><strong>Arguments</strong></p><ul><li><code>rheology</code>: The rheology used to compute the buoyancy forces.</li><li><code>args</code>: Additional arguments required for the computation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L65-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.compute_buoyancy-Tuple{GeoParams.MaterialParameters.MaterialParams, Any, Any}" href="#JustRelax.JustRelax3D.compute_buoyancy-Tuple{GeoParams.MaterialParameters.MaterialParams, Any, Any}"><code>JustRelax.JustRelax3D.compute_buoyancy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_buoyancy(rheology::MaterialParams, args, phase_ratios)</code></pre><p>Compute the buoyancy forces for a given set of material parameters, arguments, and phase ratios.</p><p><strong>Arguments</strong></p><ul><li><code>rheology</code>: The material parameters.</li><li><code>args</code>: The arguments.</li><li><code>phase_ratios</code>: The phase ratios.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L51-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.compute_buoyancy-Tuple{GeoParams.MaterialParameters.MaterialParams, Any}" href="#JustRelax.JustRelax3D.compute_buoyancy-Tuple{GeoParams.MaterialParameters.MaterialParams, Any}"><code>JustRelax.JustRelax3D.compute_buoyancy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_buoyancy(rheology::MaterialParams, args)</code></pre><p>Compute the buoyancy forces based on the given rheology parameters and arguments.</p><p><strong>Arguments</strong></p><ul><li><code>rheology::MaterialParams</code>: The material parameters for the rheology.</li><li><code>args</code>: The arguments for the computation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L38-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.compute_maxloc!-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.compute_maxloc!-Tuple{Any, Any}"><code>JustRelax.JustRelax3D.compute_maxloc!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">maxloc!(B, A; window)</code></pre><p>Compute the maximum value of <code>A</code> in the <code>window = (width_x, width_y, width_z)</code> and store the result in <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L328-L332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, Any, Any}"><code>JustRelax.JustRelax3D.compute_ρg!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_ρg!(ρg, rheology, args)</code></pre><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, JustRelax.PhaseRatio, Any, Any}" href="#JustRelax.JustRelax3D.compute_ρg!-Tuple{Any, JustRelax.PhaseRatio, Any, Any}"><code>JustRelax.JustRelax3D.compute_ρg!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_ρg!(ρg, phase_ratios, rheology, args)</code></pre><p>Calculate the buoyance forces <code>ρg</code> for the given GeoParams.jl <code>rheology</code> object and correspondent arguments <code>args</code>.  The <code>phase_ratios</code> are used to compute the density of the composite rheology.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/rheology/BuoyancyForces.jl#L18-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T" href="#JustRelax.JustRelax3D.continuation_log-Union{Tuple{T}, Tuple{T, T, Any}} where T"><code>JustRelax.JustRelax3D.continuation_log</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">continuation_log(x_new, x_old, ν)</code></pre><p>Do a continuation step <code>exp((1-ν)*log(x_old) + ν*log(x_new))</code> with damping parameter <code>ν</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L481-L485">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.flow_bcs!-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.flow_bcs!-Tuple{Any, Any}"><code>JustRelax.JustRelax3D.flow_bcs!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">flow_bcs!(stokes, bcs::FlowBoundaryConditions, di)</code></pre><p>Apply the prescribed flow boundary conditions <code>bc</code> on the <code>stokes</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/boundaryconditions/BoundaryConditions.jl#L40-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, Tuple{Vararg{GeoParams.AbstractMaterialParamsStruct, N}}, Any}} where {N, F}" href="#JustRelax.JustRelax3D.fn_ratio-Union{Tuple{F}, Tuple{N}, Tuple{F, Tuple{Vararg{GeoParams.AbstractMaterialParamsStruct, N}}, Any}} where {N, F}"><code>JustRelax.JustRelax3D.fn_ratio</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fn_ratio(fn::F, rheology::NTuple{N, AbstractMaterialParamsStruct}, ratio) where {N, F}</code></pre><p>Average the function <code>fn</code> over the material phases in <code>rheology</code> using the phase ratios <code>ratio</code>.    </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/phases/phases.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}" href="#JustRelax.JustRelax3D.interp_Vx_on_Vy!-Tuple{Any, Any, Tuple{UnitRange, UnitRange, UnitRange}, Int64, Int64, Int64}"><code>JustRelax.JustRelax3D.interp_Vx_on_Vy!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">interp_Vx_on_Vy!(Vx_on_Vy, Vx)</code></pre><p>Interpolates the values of <code>Vx</code> onto the grid points of <code>Vy</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Vx_on_Vy::AbstractArray</code>: <code>Vx</code> at <code>Vy</code> grid points.</li><li><code>Vx::AbstractArray</code>: <code>Vx</code> at its staggered grid points.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Interpolations.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.nphases-Tuple{JustRelax.PhaseRatio}" href="#JustRelax.JustRelax3D.nphases-Tuple{JustRelax.PhaseRatio}"><code>JustRelax.JustRelax3D.nphases</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nphases(x::JustRelax.PhaseRatio)</code></pre><p>Return the number of phases in <code>x::JustRelax.PhaseRatio</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/phases/phases.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.rotate_stress!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Tuple{Vararg{T, N}}, Any, Any, Any}} where {N, T}" href="#JustRelax.JustRelax3D.rotate_stress!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Tuple{Vararg{T, N}}, Any, Any, Any}} where {N, T}"><code>JustRelax.JustRelax3D.rotate_stress!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Jaumann derivative</code></pre><p>τij<em>o += v</em>k * ∂τij<em>o/∂x</em>k - ω<em>ij * ∂τkj</em>o + ∂τkj<em>o * ω</em>ij</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/stokes/StressRotation.jl#L95-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.take-Tuple{String}" href="#JustRelax.JustRelax3D.take-Tuple{String}"><code>JustRelax.JustRelax3D.take</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">take(fldr::String)</code></pre><p>Create folder <code>fldr</code> if it does not exist.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L474-L478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}" href="#JustRelax.JustRelax3D.tensor_invariant!-Tuple{JustRelax.SymmetricTensor}"><code>JustRelax.JustRelax3D.tensor_invariant!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tensor_invariant!(A::JustRelax.SymmetricTensor)</code></pre><p>Compute the tensor invariant of the given symmetric tensor <code>A</code>.</p><p><strong>Arguments</strong></p><ul><li><code>A::JustRelax.SymmetricTensor</code>: The input symmetric tensor.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/stokes/StressKernels.jl#L338-L345">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.thermal_bcs!-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.thermal_bcs!-Tuple{Any, Any}"><code>JustRelax.JustRelax3D.thermal_bcs!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">thermal_bcs!(T, bcs::TemperatureBoundaryConditions)</code></pre><p>Apply the prescribed heat boundary conditions <code>bc</code> on the <code>T</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/boundaryconditions/BoundaryConditions.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.velocity2vertex!-NTuple{6, Any}" href="#JustRelax.JustRelax3D.velocity2vertex!-NTuple{6, Any}"><code>JustRelax.JustRelax3D.velocity2vertex!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">velocity2vertex!(Vx_v, Vy_v, Vz_v, Vx, Vy, Vz)</code></pre><p>In-place interpolation of the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes  onto the pre-allocated <code>Vx_d</code>, <code>Vy_d</code>, <code>Vz_d</code> 3D arrays located at the grid vertices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Interpolations.jl#L252-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.velocity2vertex-Tuple{Any, Any, Any}" href="#JustRelax.JustRelax3D.velocity2vertex-Tuple{Any, Any, Any}"><code>JustRelax.JustRelax3D.velocity2vertex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">velocity2vertex(Vx, Vy, Vz)</code></pre><p>Interpolate the velocity field <code>Vx</code>, <code>Vy</code>, <code>Vz</code> from a staggered grid with ghost nodes  onto the grid vertices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Interpolations.jl#L232-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@add-Tuple{Any, Vararg{Any}}" href="#JustRelax.JustRelax3D.@add-Tuple{Any, Vararg{Any}}"><code>JustRelax.JustRelax3D.@add</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@add(I, args...)</code></pre><p>Add <code>I</code> to the scalars in <code>args</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L65-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@copy-Tuple{Any, Any}" href="#JustRelax.JustRelax3D.@copy-Tuple{Any, Any}"><code>JustRelax.JustRelax3D.@copy</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">copy(B, A)</code></pre><p>convenience macro to copy data from the array <code>A</code> into array <code>B</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@idx-Tuple" href="#JustRelax.JustRelax3D.@idx-Tuple"><code>JustRelax.JustRelax3D.@idx</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@idx(args...)</code></pre><p>Make a linear range from <code>1</code> to <code>args[i]</code>, with <code>i ∈ [1, ..., n]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@normal-Tuple{Any}" href="#JustRelax.JustRelax3D.@normal-Tuple{Any}"><code>JustRelax.JustRelax3D.@normal</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@normal(A)</code></pre><p>Unpacks the normal components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L221-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@qT-Tuple{Any}" href="#JustRelax.JustRelax3D.@qT-Tuple{Any}"><code>JustRelax.JustRelax3D.@qT</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@qT(V)</code></pre><p>Unpacks the flux arrays <code>qT_i</code> from the ThermalArrays <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L107-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@qT2-Tuple{Any}" href="#JustRelax.JustRelax3D.@qT2-Tuple{Any}"><code>JustRelax.JustRelax3D.@qT2</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@qT2(V)</code></pre><p>Unpacks the flux arrays <code>qT2_i</code> from the ThermalArrays <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L122-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@residuals-Tuple{Any}" href="#JustRelax.JustRelax3D.@residuals-Tuple{Any}"><code>JustRelax.JustRelax3D.@residuals</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@residuals(A)</code></pre><p>Unpacks the momentum residuals from <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L291-L295">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@shear-Tuple{Any}" href="#JustRelax.JustRelax3D.@shear-Tuple{Any}"><code>JustRelax.JustRelax3D.@shear</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@shear(A)</code></pre><p>Unpacks the shear components of the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L198-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@strain-Tuple{Any}" href="#JustRelax.JustRelax3D.@strain-Tuple{Any}"><code>JustRelax.JustRelax3D.@strain</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@strain(A)</code></pre><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L139-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@strain_center-Tuple{Any}" href="#JustRelax.JustRelax3D.@strain_center-Tuple{Any}"><code>JustRelax.JustRelax3D.@strain_center</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@strain_center(A)</code></pre><p>Unpacks the strain rate tensor <code>ε</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L244-L249">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@strain_plastic-Tuple{Any}" href="#JustRelax.JustRelax3D.@strain_plastic-Tuple{Any}"><code>JustRelax.JustRelax3D.@strain_plastic</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@strain_plastic(A)</code></pre><p>Unpacks the plastic strain rate tensor <code>ε_pl</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L151-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@stress-Tuple{Any}" href="#JustRelax.JustRelax3D.@stress-Tuple{Any}"><code>JustRelax.JustRelax3D.@stress</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@stress(A)</code></pre><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L163-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@stress_center-Tuple{Any}" href="#JustRelax.JustRelax3D.@stress_center-Tuple{Any}"><code>JustRelax.JustRelax3D.@stress_center</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@stress_center(A)</code></pre><p>Unpacks the deviatoric stress tensor <code>τ</code> from the StokesArrays <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L256-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@tensor-Tuple{Any}" href="#JustRelax.JustRelax3D.@tensor-Tuple{Any}"><code>JustRelax.JustRelax3D.@tensor</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@tensor(A)</code></pre><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the staggered grid. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L175-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@tensor_center-Tuple{Any}" href="#JustRelax.JustRelax3D.@tensor_center-Tuple{Any}"><code>JustRelax.JustRelax3D.@tensor_center</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@tensor_center(A)</code></pre><p>Unpacks the symmetric tensor <code>A</code>, where its components are defined in the center of the grid cells. Shear components are unpack following Voigt&#39;s notation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L268-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.JustRelax3D.@velocity-Tuple{Any}" href="#JustRelax.JustRelax3D.@velocity-Tuple{Any}"><code>JustRelax.JustRelax3D.@velocity</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@velocity(V)</code></pre><p>Unpacks the velocity arrays <code>V</code> from the StokesArrays <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/Utils.jl#L92-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.DataIO.checkpointing-NTuple{5, Any}" href="#JustRelax.DataIO.checkpointing-NTuple{5, Any}"><code>JustRelax.DataIO.checkpointing</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">checkpointing(dst, stokes, T, η, time)</code></pre><p>Save necessary data in <code>dst</code> as and HDF5 file to restart the model from the state at <code>time</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/IO/H5.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.DataIO.metadata-Tuple{Any, Any, Any}" href="#JustRelax.DataIO.metadata-Tuple{Any, Any, Any}"><code>JustRelax.DataIO.metadata</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">metadata(src, file, dst)</code></pre><p>Copy <code>file</code>, Manifest.toml, and, Project.toml from <code>src</code> to <code>dst</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/IO/DataIO.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Any, Vararg{Any, N}}} where N" href="#JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Any, Vararg{Any, N}}} where N"><code>JustRelax.DataIO.save_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function save_hdf5(dst, fname, data)</code></pre><p>Save <code>data</code> as the <code>fname.h5</code> HDF5 file in the folder <code>dst</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/IO/H5.jl#L29-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Vararg{Any, N}}} where N" href="#JustRelax.DataIO.save_hdf5-Union{Tuple{N}, Tuple{Any, Vararg{Any, N}}} where N"><code>JustRelax.DataIO.save_hdf5</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function save_hdf5(fname, data)</code></pre><p>Save <code>data</code> as the <code>fname.h5</code> HDF5 file</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PTsolvers/JustRelax.jl/blob/37fbce8aa2d2b542b87f7f600fc9a8c35667c951/src/IO/H5.jl#L55-L59">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ShearBands/">« Shear Bands</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Wednesday 29 May 2024 10:24">Wednesday 29 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
