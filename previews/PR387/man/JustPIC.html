<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>List of JustPIC functions | JustRelax.jl</title>
    <meta name="description" content="Documentation for JustRelax.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/JustRelax.jl/previews/PR387/assets/style.COYdR9T0.css" as="style">
    <link rel="preload stylesheet" href="/JustRelax.jl/previews/PR387/vp-icons.css" as="style">
    
    <script type="module" src="/JustRelax.jl/previews/PR387/assets/app.BCZ4tBLL.js"></script>
    <link rel="preload" href="/JustRelax.jl/previews/PR387/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/JustRelax.jl/previews/PR387/assets/chunks/theme.WGH3tFyG.js">
    <link rel="modulepreload" href="/JustRelax.jl/previews/PR387/assets/chunks/framework.Gxnoum42.js">
    <link rel="modulepreload" href="/JustRelax.jl/previews/PR387/assets/man_JustPIC.md.CIK4rIi9.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script src="/JustRelax.jl/versions.js"></script>
    <script src="/JustRelax.jl/previews/PR387/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/JustRelax.jl/previews/PR387/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/JustRelax.jl/previews/PR387/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>JustRelax.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/JustRelax.jl/previews/PR387/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/JustRelax.jl/previews/PR387/man/installation" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Documentation</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/JustRelax.jl/previews/PR387/man/listfunctions" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>API</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/PTsolvers/JustRelax.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/PTsolvers/JustRelax.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Home</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>User guide</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/installation" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Installation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/backend" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Backend</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Equations</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/equations_basic" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Governing equations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/constitutive_equations" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Constitutive equations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/equations_APT" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>APT equations</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/equations_discretization" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Discretization</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/boundary_conditions" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Boundary conditions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/advection" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Advection</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Examples</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/Blankenbach" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Blankenbach</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/ShearBands" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Shear Bands</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Subduction 2D</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/subduction2D/setup" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Model setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/subduction2D/rheology" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Rheology</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/subduction2D/subduction2D" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Setting up the model</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Plume 3D</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/plume3D/rheology" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Rheology</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/plume3D/plume3D" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Setting up the model</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Checkpointing/Restart</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/checkpointing" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Checkpointing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/restart" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Restart</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/listfunctions" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>List of functions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>References</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/JustPIC" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>JustPIC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/GeoParams" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>GeoParams</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><!----><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/authors" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Authors</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/contributing" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Contributing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/code_of_conduct" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Code of Conduct</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/security" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Security</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/JustRelax.jl/previews/PR387/man/license" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>License</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _JustRelax_jl_previews_PR387_man_JustPIC" data-v-83890dd9><div><h1 id="List-of-JustPIC-functions" tabindex="-1">List of JustPIC functions <a class="header-anchor" href="#List-of-JustPIC-functions" aria-label="Permalink to &quot;List of JustPIC functions {#List-of-JustPIC-functions}&quot;">​</a></h1><p>Here an overview of all functions in JustPIC.jl, , for a complete list see <a href="https://juliageodynamics.github.io/JustPIC.jl/dev/" target="_blank" rel="noreferrer">here</a>:</p><details class="jldocstring custom-block" open><summary><a id="JustPIC.Particles" href="#JustPIC.Particles"><span class="jlbinding">JustPIC.Particles</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Particles{Backend,N,I,T1,T2} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractParticles</span></span></code></pre></div><p>A struct representing a collection of particles.</p><p><strong>Arguments</strong></p><ul><li><p><code>backend</code>: The backend used for particle computations (CPUBackend, CUDABackend, AMDGPUBackend).</p></li><li><p><code>coords</code>: Coordinates of the particles</p></li><li><p><code>index</code>: Helper array flaggin active particles</p></li><li><p><code>nxcell</code>: Initial number of particles per cell</p></li><li><p><code>max_xcell</code>: Maximum number of particles per cell</p></li><li><p><code>min_xcell</code>: Minimum number of particles per cell</p></li><li><p><code>np</code>: Number of particles</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/particles.jl#L3-L16" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC.nphases-Tuple{JustPIC.PhaseRatios}" href="#JustPIC.nphases-Tuple{JustPIC.PhaseRatios}"><span class="jlbinding">JustPIC.nphases</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nphases</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PhaseRatios</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the number of phases in <code>x::PhaseRatios</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/PhaseRatios/PhaseRatios.jl#L22-L26" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.advection!-Union{Tuple{T}, Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, Any}} where {N, T}" href="#JustPIC._2D.advection!-Union{Tuple{T}, Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, Any}} where {N, T}"><span class="jlbinding">JustPIC._2D.advection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractAdvectionIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V, grid_vi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,NTuple{N,T}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt)</span></span></code></pre></div><p>Advects the particles using the advection scheme defined by <code>method</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: Particles object to be advected.</p></li><li><p><code>method</code>: Time integration method (<code>Euler</code> or <code>RungeKutta2</code>).</p></li><li><p><code>V</code>: Tuple containing <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>grid_vi</code>: Tuple containing the grids corresponding to <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>dt</code>: Time step.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/advection.jl#L2-L13" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.advection_LinP!-Union{Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T} where T}, Any}} where N" href="#JustPIC._2D.advection_LinP!-Union{Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T} where T}, Any}} where N"><span class="jlbinding">JustPIC._2D.advection_LinP!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractAdvectionIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V, grid_vi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,NTuple{N,T}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt)</span></span></code></pre></div><p>Advects the particles using the advection scheme defined by <code>method</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: Particles object to be advected.</p></li><li><p><code>method</code>: Time integration method (<code>Euler</code> or <code>RungeKutta2</code>).</p></li><li><p><code>V</code>: Tuple containing <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>grid_vi</code>: Tuple containing the grids corresponding to <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>dt</code>: Time step.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/advection_LinP.jl#L2-L13" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.advection_MQS!-Union{Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T} where T}, Any}} where N" href="#JustPIC._2D.advection_MQS!-Union{Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T} where T}, Any}} where N"><span class="jlbinding">JustPIC._2D.advection_MQS!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractAdvectionIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V, grid_vi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,NTuple{N,T}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt)</span></span></code></pre></div><p>Advects the particles using the advection scheme defined by <code>method</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: Particles object to be advected.</p></li><li><p><code>method</code>: Time integration method (<code>Euler</code> or <code>RungeKutta2</code>).</p></li><li><p><code>V</code>: Tuple containing <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>grid_vi</code>: Tuple containing the grids corresponding to <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>dt</code>: Time step.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/advection_MQS.jl#L2-L13" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.centroid2particle!-NTuple{4, Any}" href="#JustPIC._2D.centroid2particle!-NTuple{4, Any}"><span class="jlbinding">JustPIC._2D.centroid2particle!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">centroid2particle!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Fp, xci, F, particles)</span></span></code></pre></div><p>Interpolates properties <code>F</code> that are defined on a mesh at center points with location <code>xci</code> to particles <code>Fp</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Interpolations/centroid_to_particle.jl#L4-L8" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.checkpointing_particles-Tuple{Any, Any, String}" href="#JustPIC._2D.checkpointing_particles-Tuple{Any, Any, String}"><span class="jlbinding">JustPIC._2D.checkpointing_particles</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">checkpointing_particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dst, particles;phases</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, chain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, particle_args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save the state of particles and related data to a checkpoint file in a jld2 format. The name of the checkpoint file is <code>particles_checkpoint.jld2</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>dst</code>: The destination directory where the checkpoint file will be saved.</p></li><li><p><code>particles</code>: The array of particles to be saved.</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>phases</code>: The array of phases associated with the particles. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>phase_ratios</code>: The array of phase ratios. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>chain</code>: The chain data to be saved. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>t</code>: The current time to be saved. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>dt</code>: The timestep to be saved. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>particle_args</code>: Additional particle arguments to be saved. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>kwargs</code>: Additional keyword arguments to be saved in the checkpoint file.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/IO/JLD2.jl#L63-L81" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.fill_chain_from_chain!-Tuple{MarkerChain, Any, Any}" href="#JustPIC._2D.fill_chain_from_chain!-Tuple{MarkerChain, Any, Any}"><span class="jlbinding">JustPIC._2D.fill_chain_from_chain!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fill_chain!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(chain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MarkerChain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, topo_x, topo_y)</span></span></code></pre></div><p>Fill the given <code>chain</code> of markers with topographical data.</p><p><strong>Arguments</strong></p><ul><li><p><code>chain::MarkerChain</code>: The chain of markers to be filled.</p></li><li><p><code>topo_x</code>: The x-coordinates of the topography.</p></li><li><p><code>topo_y</code>: The y-coordinates of the topography.</p></li></ul><p><strong>Description</strong></p><p>This function populates the <code>chain</code> with markers based on the provided topographical data (<code>topo_x</code> and <code>topo_y</code>). The function modifies the <code>chain</code> in place.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/MarkerChain/init.jl#L54-L66" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.force_injection!-Union{Tuple{Backend}, Tuple{Particles{Backend}, Any}} where Backend" href="#JustPIC._2D.force_injection!-Union{Tuple{Backend}, Tuple{Particles{Backend}, Any}} where Backend"><span class="jlbinding">JustPIC._2D.force_injection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">force_injection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles{Backend}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, p_new) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {Backend}</span></span></code></pre></div><p>Forces the injection of new particles into the existing <code>particles</code> collection. This function modifies the <code>particles</code> in place by adding the new particles specified in <code>p_new</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles::Particles{Backend}</code>: The existing collection of particles to which new particles will be added. The type of backend is specified by the <code>Backend</code> parameter.</p></li><li><p><code>p_new</code>: The new particles to be injected into the existing collection.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/forced_injection.jl#L22-L30" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.force_injection!-Union{Tuple{N}, Tuple{Backend}, Tuple{Particles{Backend}, Any, NTuple{N, Any}, NTuple{N, Any}}} where {Backend, N}" href="#JustPIC._2D.force_injection!-Union{Tuple{N}, Tuple{Backend}, Tuple{Particles{Backend}, Any, NTuple{N, Any}, NTuple{N, Any}}} where {Backend, N}"><span class="jlbinding">JustPIC._2D.force_injection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">force_injection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles{Backend}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, p_new, fields</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, Any}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, values</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, Any}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {Backend, N}</span></span></code></pre></div><p>Forcefully injects new particles into the <code>particles</code> object. This function modifies the <code>particles</code> object in place.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles::Particles{Backend}</code>: The particles object to be modified.</p></li><li><p><code>p_new</code>: The new particles to be injected.</p></li><li><p><code>fields::NTuple{N, Any}</code>: A tuple containing the fields to be updated.</p></li><li><p><code>values::NTuple{N, Any}</code>: A tuple containing the values corresponding to the fields.</p></li></ul><p><strong>Returns</strong></p><ul><li>Nothing. This function modifies the <code>particles</code> object in place.</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/forced_injection.jl#L1-L14" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.init_particles-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, Any, Any, Vararg{N, T}}} where {N, T}" href="#JustPIC._2D.init_particles-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, Any, Any, Vararg{N, T}}} where {N, T}"><span class="jlbinding">JustPIC._2D.init_particles</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init_particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">( backend, nxcell, max_xcell, min_xcell, coords</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,AbstractArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dxᵢ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nᵢ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,I}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Initialize the particles object.</p><p><strong>Arguments</strong></p><ul><li><p><code>backend</code>: Device backend</p></li><li><p><code>nxcell</code>: Initial number of particles per cell</p></li><li><p><code>max_xcell</code>: Maximum number of particles per cell</p></li><li><p><code>min_xcell</code>: Minimum number of particles per cell</p></li><li><p><code>xvi</code>: Grid cells vertices</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/particles_utils.jl#L17-L28" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.inject_particles!-Union{Tuple{N}, Tuple{Particles, Any, NTuple{N, T} where T}} where N" href="#JustPIC._2D.inject_particles!-Union{Tuple{N}, Tuple{Particles, Any, NTuple{N, T} where T}} where N"><span class="jlbinding">JustPIC._2D.inject_particles!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">inject_particles!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args, grid)</span></span></code></pre></div><p>Injects particles if the number of particles in a given cell is such that <code>n &lt; particles.min_xcell</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: The particles object.</p></li><li><p><code>args</code>: <code>CellArrays</code>s containing particle fields.</p></li><li><p><code>grid</code>: The grid cell vertices.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/injection.jl#L3-L12" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.interpolate_velocity_to_markerchain!-Union{Tuple{T}, Tuple{N}, Tuple{MarkerChain, Any, Any, NTuple{N, NTuple{N, T}}}} where {N, T}" href="#JustPIC._2D.interpolate_velocity_to_markerchain!-Union{Tuple{T}, Tuple{N}, Tuple{MarkerChain, Any, Any, NTuple{N, NTuple{N, T}}}} where {N, T}"><span class="jlbinding">JustPIC._2D.interpolate_velocity_to_markerchain!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">interpolate_velocity_to_markerchain!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(chain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MarkerChain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, chain_V</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, CellArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V, grid_vi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, NTuple{N, T}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N, T}</span></span></code></pre></div><p>Interpolates the velocity field to the positions of the marker chain.</p><p><strong>Arguments</strong></p><ul><li><p><code>chain::MarkerChain</code>: The marker chain object containing the particle coordinates and indices.</p></li><li><p><code>chain_V::NTuple{N, CellArray}</code>: The output velocity field at the marker chain positions.</p></li><li><p><code>V</code>: The velocity field to be interpolated.</p></li><li><p><code>grid_vi::NTuple{N, NTuple{N, T}}</code>: The grid information for each dimension.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/MarkerChain/Advection/interp_velocity.jl#L1-L11" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.lerp-Union{Tuple{T}, Tuple{nD}, Tuple{Any, NTuple{nD, T}}} where {nD, T}" href="#JustPIC._2D.lerp-Union{Tuple{T}, Tuple{nD}, Tuple{Any, NTuple{nD, T}}} where {nD, T}"><span class="jlbinding">JustPIC._2D.lerp</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lerp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{nD,T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {nD,T}</span></span></code></pre></div><p>Linearly interpolates the value <code>v</code> between the elements of the tuple <code>t</code>. This function is specialized for tuples of length <code>nD</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>v</code>: The value to be interpolated.</p></li><li><p><code>t</code>: The tuple of values to interpolate between.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Interpolations/ndlerp.jl#L1-L10" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.move_particles!-Union{Tuple{N}, Tuple{AbstractParticles, NTuple{N, T} where T, Any}} where N" href="#JustPIC._2D.move_particles!-Union{Tuple{N}, Tuple{AbstractParticles, NTuple{N, T} where T, Any}} where N"><span class="jlbinding">JustPIC._2D.move_particles!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">move_particles!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractParticles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, grid, args)</span></span></code></pre></div><p>Move particles in the given <code>particles</code> container according to the provided <code>grid</code> and particles fields in <code>args</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: The container of particles to be moved.</p></li><li><p><code>grid</code>: The grid used for particle movement.</p></li><li><p><code>args</code>: <code>CellArrays</code>s containing particle fields.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/move_safe.jl#L1-L10" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.particle2centroid!-Tuple{Any, Any, NTuple{N, T} where {N, T}, Particles}" href="#JustPIC._2D.particle2centroid!-Tuple{Any, Any, NTuple{N, T} where {N, T}, Particles}"><span class="jlbinding">JustPIC._2D.particle2centroid!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">particle2centroid!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(F, Fp, xci</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Interpolates properties <code>Fp</code> from particles to the grid <code>F</code> at center points that are defined by 1D coordinate arrays in <code>xci</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Interpolations/particle_to_grid_centroid.jl#L2-L6" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.semilagrangian_advection!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}" href="#JustPIC._2D.semilagrangian_advection!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}"><span class="jlbinding">JustPIC._2D.semilagrangian_advection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">semilagrangian_advection!F, F0, integrator, V, grid_vi, grid, dt)</span></span></code></pre></div><p>Performs semi-Lagrangian advection by backtracking particle positions in a velocity field. This function updates the positions and/or properties of particles according to the semi-Lagrangian scheme.</p><p><strong>Arguments</strong></p><ul><li><p><code>F</code>: The new state of the grid field (e.g., density, temperature).</p></li><li><p><code>F0</code>: The current state of the grid field (used for interpolation).</p></li><li><p><code>integrator</code>: The numerical integrator to use for advection (e.g., Euler, Rk2, RK4).</p></li><li><p><code>V</code>: The velocity field at the particle positions.</p></li><li><p><code>grid_vi</code>: The grid cell indices for the velocity field.</p></li><li><p><code>grid</code>: The spatial grid information.</p></li><li><p><code>dt</code>: The time step for the advection.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/backtracking.jl#L1-L16" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.semilagrangian_advection_LinP!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}" href="#JustPIC._2D.semilagrangian_advection_LinP!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}"><span class="jlbinding">JustPIC._2D.semilagrangian_advection_LinP!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">semilagrangian_advection_LinP!, F0, integrator, V, grid_vi, grid, dt)</span></span></code></pre></div><p>Performs semi-Lagrangian advection by backtracking particle positions in a velocity field. This function updates the positions and/or properties of particles according to the semi-Lagrangian scheme.</p><p><strong>Arguments</strong></p><ul><li><p><code>F</code>: The new state of the grid field (e.g., density, temperature).</p></li><li><p><code>F0</code>: The current state of the grid field (used for interpolation).</p></li><li><p><code>integrator</code>: The numerical integrator to use for advection (e.g., Euler, Rk2, RK4).</p></li><li><p><code>V</code>: The velocity field at the particle positions.</p></li><li><p><code>grid_vi</code>: The grid cell indices for the velocity field.</p></li><li><p><code>grid</code>: The spatial grid information.</p></li><li><p><code>dt</code>: The time step for the advection.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/backtracking_LinP.jl#L1-L16" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.semilagrangian_advection_MQS!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}" href="#JustPIC._2D.semilagrangian_advection_MQS!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}"><span class="jlbinding">JustPIC._2D.semilagrangian_advection_MQS!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">semilagrangian_advection_MQS!, F0, integrator, V, grid_vi, grid, dt)</span></span></code></pre></div><p>Performs semi-Lagrangian advection by backtracking particle positions in a velocity field. This function updates the positions and/or properties of particles according to the semi-Lagrangian scheme.</p><p><strong>Arguments</strong></p><ul><li><p><code>F</code>: The new state of the grid field (e.g., density, temperature).</p></li><li><p><code>F0</code>: The current state of the grid field (used for interpolation).</p></li><li><p><code>integrator</code>: The numerical integrator to use for advection (e.g., Euler, Rk2, RK4).</p></li><li><p><code>V</code>: The velocity field at the particle positions.</p></li><li><p><code>grid_vi</code>: The grid cell indices for the velocity field.</p></li><li><p><code>grid</code>: The spatial grid information.</p></li><li><p><code>dt</code>: The time step for the advection.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/backtracking_MQS.jl#L1-L16" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._2D.@idx-Tuple" href="#JustPIC._2D.@idx-Tuple"><span class="jlbinding">JustPIC._2D.@idx</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Make a linear range from <code>1</code> to <code>args[i]</code>, with <code>i ∈ [1, ..., n]</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Utils.jl#L18-L22" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.advection!-Union{Tuple{T}, Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, Any}} where {N, T}" href="#JustPIC._3D.advection!-Union{Tuple{T}, Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, Any}} where {N, T}"><span class="jlbinding">JustPIC._3D.advection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractAdvectionIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V, grid_vi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,NTuple{N,T}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt)</span></span></code></pre></div><p>Advects the particles using the advection scheme defined by <code>method</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: Particles object to be advected.</p></li><li><p><code>method</code>: Time integration method (<code>Euler</code> or <code>RungeKutta2</code>).</p></li><li><p><code>V</code>: Tuple containing <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>grid_vi</code>: Tuple containing the grids corresponding to <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>dt</code>: Time step.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/advection.jl#L2-L13" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.advection_LinP!-Union{Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T} where T}, Any}} where N" href="#JustPIC._3D.advection_LinP!-Union{Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T} where T}, Any}} where N"><span class="jlbinding">JustPIC._3D.advection_LinP!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractAdvectionIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V, grid_vi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,NTuple{N,T}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt)</span></span></code></pre></div><p>Advects the particles using the advection scheme defined by <code>method</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: Particles object to be advected.</p></li><li><p><code>method</code>: Time integration method (<code>Euler</code> or <code>RungeKutta2</code>).</p></li><li><p><code>V</code>: Tuple containing <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>grid_vi</code>: Tuple containing the grids corresponding to <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>dt</code>: Time step.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/advection_LinP.jl#L2-L13" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.advection_MQS!-Union{Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T} where T}, Any}} where N" href="#JustPIC._3D.advection_MQS!-Union{Tuple{N}, Tuple{Particles, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T} where T}, Any}} where N"><span class="jlbinding">JustPIC._3D.advection_MQS!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">advection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractAdvectionIntegrator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V, grid_vi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,NTuple{N,T}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt)</span></span></code></pre></div><p>Advects the particles using the advection scheme defined by <code>method</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: Particles object to be advected.</p></li><li><p><code>method</code>: Time integration method (<code>Euler</code> or <code>RungeKutta2</code>).</p></li><li><p><code>V</code>: Tuple containing <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>grid_vi</code>: Tuple containing the grids corresponding to <code>Vx</code>, <code>Vy</code>; and <code>Vz</code> in 3D.</p></li><li><p><code>dt</code>: Time step.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/advection_MQS.jl#L2-L13" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.centroid2particle!-NTuple{4, Any}" href="#JustPIC._3D.centroid2particle!-NTuple{4, Any}"><span class="jlbinding">JustPIC._3D.centroid2particle!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">centroid2particle!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Fp, xci, F, particles)</span></span></code></pre></div><p>Interpolates properties <code>F</code> that are defined on a mesh at center points with location <code>xci</code> to particles <code>Fp</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Interpolations/centroid_to_particle.jl#L4-L8" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.checkpointing_particles-Tuple{Any, Any, String}" href="#JustPIC._3D.checkpointing_particles-Tuple{Any, Any, String}"><span class="jlbinding">JustPIC._3D.checkpointing_particles</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">checkpointing_particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dst, particles;phases</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, phase_ratios</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, chain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, particle_args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Save the state of particles and related data to a checkpoint file in a jld2 format. The name of the checkpoint file is <code>particles_checkpoint.jld2</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>dst</code>: The destination directory where the checkpoint file will be saved.</p></li><li><p><code>particles</code>: The array of particles to be saved.</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>phases</code>: The array of phases associated with the particles. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>phase_ratios</code>: The array of phase ratios. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>chain</code>: The chain data to be saved. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>t</code>: The current time to be saved. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>dt</code>: The timestep to be saved. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>particle_args</code>: Additional particle arguments to be saved. If nothing is stated, the default is <code>nothing</code>.</p></li><li><p><code>kwargs</code>: Additional keyword arguments to be saved in the checkpoint file.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/IO/JLD2.jl#L63-L81" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.fill_chain_from_chain!-Tuple{MarkerChain, Any, Any}" href="#JustPIC._3D.fill_chain_from_chain!-Tuple{MarkerChain, Any, Any}"><span class="jlbinding">JustPIC._3D.fill_chain_from_chain!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fill_chain!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(chain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MarkerChain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, topo_x, topo_y)</span></span></code></pre></div><p>Fill the given <code>chain</code> of markers with topographical data.</p><p><strong>Arguments</strong></p><ul><li><p><code>chain::MarkerChain</code>: The chain of markers to be filled.</p></li><li><p><code>topo_x</code>: The x-coordinates of the topography.</p></li><li><p><code>topo_y</code>: The y-coordinates of the topography.</p></li></ul><p><strong>Description</strong></p><p>This function populates the <code>chain</code> with markers based on the provided topographical data (<code>topo_x</code> and <code>topo_y</code>). The function modifies the <code>chain</code> in place.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/MarkerChain/init.jl#L54-L66" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.force_injection!-Union{Tuple{Backend}, Tuple{Particles{Backend}, Any}} where Backend" href="#JustPIC._3D.force_injection!-Union{Tuple{Backend}, Tuple{Particles{Backend}, Any}} where Backend"><span class="jlbinding">JustPIC._3D.force_injection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">force_injection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles{Backend}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, p_new) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {Backend}</span></span></code></pre></div><p>Forces the injection of new particles into the existing <code>particles</code> collection. This function modifies the <code>particles</code> in place by adding the new particles specified in <code>p_new</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles::Particles{Backend}</code>: The existing collection of particles to which new particles will be added. The type of backend is specified by the <code>Backend</code> parameter.</p></li><li><p><code>p_new</code>: The new particles to be injected into the existing collection.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/forced_injection.jl#L22-L30" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.force_injection!-Union{Tuple{N}, Tuple{Backend}, Tuple{Particles{Backend}, Any, NTuple{N, Any}, NTuple{N, Any}}} where {Backend, N}" href="#JustPIC._3D.force_injection!-Union{Tuple{N}, Tuple{Backend}, Tuple{Particles{Backend}, Any, NTuple{N, Any}, NTuple{N, Any}}} where {Backend, N}"><span class="jlbinding">JustPIC._3D.force_injection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">force_injection!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles{Backend}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, p_new, fields</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, Any}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, values</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, Any}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {Backend, N}</span></span></code></pre></div><p>Forcefully injects new particles into the <code>particles</code> object. This function modifies the <code>particles</code> object in place.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles::Particles{Backend}</code>: The particles object to be modified.</p></li><li><p><code>p_new</code>: The new particles to be injected.</p></li><li><p><code>fields::NTuple{N, Any}</code>: A tuple containing the fields to be updated.</p></li><li><p><code>values::NTuple{N, Any}</code>: A tuple containing the values corresponding to the fields.</p></li></ul><p><strong>Returns</strong></p><ul><li>Nothing. This function modifies the <code>particles</code> object in place.</li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/forced_injection.jl#L1-L14" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.init_particles-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, Any, Any, Vararg{N, T}}} where {N, T}" href="#JustPIC._3D.init_particles-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, Any, Any, Vararg{N, T}}} where {N, T}"><span class="jlbinding">JustPIC._3D.init_particles</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init_particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">( backend, nxcell, max_xcell, min_xcell, coords</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,AbstractArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dxᵢ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nᵢ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N,I}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Initialize the particles object.</p><p><strong>Arguments</strong></p><ul><li><p><code>backend</code>: Device backend</p></li><li><p><code>nxcell</code>: Initial number of particles per cell</p></li><li><p><code>max_xcell</code>: Maximum number of particles per cell</p></li><li><p><code>min_xcell</code>: Minimum number of particles per cell</p></li><li><p><code>xvi</code>: Grid cells vertices</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/particles_utils.jl#L17-L28" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.inject_particles!-Union{Tuple{N}, Tuple{Particles, Any, NTuple{N, T} where T}} where N" href="#JustPIC._3D.inject_particles!-Union{Tuple{N}, Tuple{Particles, Any, NTuple{N, T} where T}} where N"><span class="jlbinding">JustPIC._3D.inject_particles!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">inject_particles!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args, grid)</span></span></code></pre></div><p>Injects particles if the number of particles in a given cell is such that <code>n &lt; particles.min_xcell</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: The particles object.</p></li><li><p><code>args</code>: <code>CellArrays</code>s containing particle fields.</p></li><li><p><code>grid</code>: The grid cell vertices.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/injection.jl#L3-L12" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.interpolate_velocity_to_markerchain!-Union{Tuple{T}, Tuple{N}, Tuple{MarkerChain, Any, Any, NTuple{N, NTuple{N, T}}}} where {N, T}" href="#JustPIC._3D.interpolate_velocity_to_markerchain!-Union{Tuple{T}, Tuple{N}, Tuple{MarkerChain, Any, Any, NTuple{N, NTuple{N, T}}}} where {N, T}"><span class="jlbinding">JustPIC._3D.interpolate_velocity_to_markerchain!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">interpolate_velocity_to_markerchain!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(chain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MarkerChain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, chain_V</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, CellArray}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, V, grid_vi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{N, NTuple{N, T}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {N, T}</span></span></code></pre></div><p>Interpolates the velocity field to the positions of the marker chain.</p><p><strong>Arguments</strong></p><ul><li><p><code>chain::MarkerChain</code>: The marker chain object containing the particle coordinates and indices.</p></li><li><p><code>chain_V::NTuple{N, CellArray}</code>: The output velocity field at the marker chain positions.</p></li><li><p><code>V</code>: The velocity field to be interpolated.</p></li><li><p><code>grid_vi::NTuple{N, NTuple{N, T}}</code>: The grid information for each dimension.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/MarkerChain/Advection/interp_velocity.jl#L1-L11" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.lerp-Union{Tuple{T}, Tuple{nD}, Tuple{Any, NTuple{nD, T}}} where {nD, T}" href="#JustPIC._3D.lerp-Union{Tuple{T}, Tuple{nD}, Tuple{Any, NTuple{nD, T}}} where {nD, T}"><span class="jlbinding">JustPIC._3D.lerp</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lerp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v, t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple{nD,T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {nD,T}</span></span></code></pre></div><p>Linearly interpolates the value <code>v</code> between the elements of the tuple <code>t</code>. This function is specialized for tuples of length <code>nD</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>v</code>: The value to be interpolated.</p></li><li><p><code>t</code>: The tuple of values to interpolate between.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Interpolations/ndlerp.jl#L1-L10" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.move_particles!-Union{Tuple{N}, Tuple{AbstractParticles, NTuple{N, T} where T, Any}} where N" href="#JustPIC._3D.move_particles!-Union{Tuple{N}, Tuple{AbstractParticles, NTuple{N, T} where T, Any}} where N"><span class="jlbinding">JustPIC._3D.move_particles!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">move_particles!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractParticles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, grid, args)</span></span></code></pre></div><p>Move particles in the given <code>particles</code> container according to the provided <code>grid</code> and particles fields in <code>args</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>particles</code>: The container of particles to be moved.</p></li><li><p><code>grid</code>: The grid used for particle movement.</p></li><li><p><code>args</code>: <code>CellArrays</code>s containing particle fields.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/move_safe.jl#L1-L10" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.particle2centroid!-Tuple{Any, Any, NTuple{N, T} where {N, T}, Particles}" href="#JustPIC._3D.particle2centroid!-Tuple{Any, Any, NTuple{N, T} where {N, T}, Particles}"><span class="jlbinding">JustPIC._3D.particle2centroid!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">particle2centroid!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(F, Fp, xci</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, particles</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Particles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Interpolates properties <code>Fp</code> from particles to the grid <code>F</code> at center points that are defined by 1D coordinate arrays in <code>xci</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Interpolations/particle_to_grid_centroid.jl#L2-L6" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.semilagrangian_advection!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}" href="#JustPIC._3D.semilagrangian_advection!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}"><span class="jlbinding">JustPIC._3D.semilagrangian_advection!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">semilagrangian_advection!F, F0, integrator, V, grid_vi, grid, dt)</span></span></code></pre></div><p>Performs semi-Lagrangian advection by backtracking particle positions in a velocity field. This function updates the positions and/or properties of particles according to the semi-Lagrangian scheme.</p><p><strong>Arguments</strong></p><ul><li><p><code>F</code>: The new state of the grid field (e.g., density, temperature).</p></li><li><p><code>F0</code>: The current state of the grid field (used for interpolation).</p></li><li><p><code>integrator</code>: The numerical integrator to use for advection (e.g., Euler, Rk2, RK4).</p></li><li><p><code>V</code>: The velocity field at the particle positions.</p></li><li><p><code>grid_vi</code>: The grid cell indices for the velocity field.</p></li><li><p><code>grid</code>: The spatial grid information.</p></li><li><p><code>dt</code>: The time step for the advection.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/backtracking.jl#L1-L16" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.semilagrangian_advection_LinP!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}" href="#JustPIC._3D.semilagrangian_advection_LinP!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}"><span class="jlbinding">JustPIC._3D.semilagrangian_advection_LinP!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">semilagrangian_advection_LinP!, F0, integrator, V, grid_vi, grid, dt)</span></span></code></pre></div><p>Performs semi-Lagrangian advection by backtracking particle positions in a velocity field. This function updates the positions and/or properties of particles according to the semi-Lagrangian scheme.</p><p><strong>Arguments</strong></p><ul><li><p><code>F</code>: The new state of the grid field (e.g., density, temperature).</p></li><li><p><code>F0</code>: The current state of the grid field (used for interpolation).</p></li><li><p><code>integrator</code>: The numerical integrator to use for advection (e.g., Euler, Rk2, RK4).</p></li><li><p><code>V</code>: The velocity field at the particle positions.</p></li><li><p><code>grid_vi</code>: The grid cell indices for the velocity field.</p></li><li><p><code>grid</code>: The spatial grid information.</p></li><li><p><code>dt</code>: The time step for the advection.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/backtracking_LinP.jl#L1-L16" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.semilagrangian_advection_MQS!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}" href="#JustPIC._3D.semilagrangian_advection_MQS!-Union{Tuple{T}, Tuple{N}, Tuple{Any, Any, AbstractAdvectionIntegrator, Any, NTuple{N, NTuple{N, T}}, NTuple{N, T}, Any}} where {N, T}"><span class="jlbinding">JustPIC._3D.semilagrangian_advection_MQS!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">semilagrangian_advection_MQS!, F0, integrator, V, grid_vi, grid, dt)</span></span></code></pre></div><p>Performs semi-Lagrangian advection by backtracking particle positions in a velocity field. This function updates the positions and/or properties of particles according to the semi-Lagrangian scheme.</p><p><strong>Arguments</strong></p><ul><li><p><code>F</code>: The new state of the grid field (e.g., density, temperature).</p></li><li><p><code>F0</code>: The current state of the grid field (used for interpolation).</p></li><li><p><code>integrator</code>: The numerical integrator to use for advection (e.g., Euler, Rk2, RK4).</p></li><li><p><code>V</code>: The velocity field at the particle positions.</p></li><li><p><code>grid_vi</code>: The grid cell indices for the velocity field.</p></li><li><p><code>grid</code>: The spatial grid information.</p></li><li><p><code>dt</code>: The time step for the advection.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Particles/Advection/backtracking_MQS.jl#L1-L16" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="JustPIC._3D.@idx-Tuple" href="#JustPIC._3D.@idx-Tuple"><span class="jlbinding">JustPIC._3D.@idx</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@idx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Make a linear range from <code>1</code> to <code>args[i]</code>, with <code>i ∈ [1, ..., n]</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/JuliaGeodynamics/JustPIC.jl/blob/v0.5.11/src/Utils.jl#L18-L22" target="_blank" rel="noreferrer">source</a><!--]--></span></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/PTsolvers/JustRelax.jl/edit/main/docs/src/man/JustPIC.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/JustRelax.jl/previews/PR387/man/listfunctions" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>List of functions</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/JustRelax.jl/previews/PR387/man/GeoParams" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>GeoParams</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025 ⋅ The JustRelax Development Team.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"uMyw5_aL\",\"man_advection.md\":\"D9wMvo9v\",\"man_authors.md\":\"CwlTpKvK\",\"man_backend.md\":\"B38rV2zC\",\"man_blankenbach.md\":\"5KBvpgq-\",\"man_boundary_conditions.md\":\"BR9JoGEQ\",\"man_checkpointing.md\":\"DsIgtSXJ\",\"man_code_of_conduct.md\":\"CsJPxHnu\",\"man_constitutive_equations.md\":\"DgGlghX-\",\"man_contributing.md\":\"D_ZGpj5Q\",\"man_equations.md\":\"u5isl2Uk\",\"man_equations_apt.md\":\"CAw1l3H-\",\"man_equations_basic.md\":\"PJgkzoBo\",\"man_equations_discretization.md\":\"C7U0uxRz\",\"man_equations_discretization0.md\":\"BIX334vB\",\"man_geoparams.md\":\"Ya4uFLHz\",\"man_installation.md\":\"DuSoXgfW\",\"man_justpic.md\":\"CIK4rIi9\",\"man_license.md\":\"B5AzcnAX\",\"man_listfunctions.md\":\"BWF429Fg\",\"man_material_physics.md\":\"BumS3l16\",\"man_plume3d_plume3d.md\":\"DIHMtSSD\",\"man_plume3d_rheology.md\":\"CoOz0uRx\",\"man_restart.md\":\"B_qxPkq6\",\"man_security.md\":\"B1FeTYPU\",\"man_shearbands.md\":\"gPZJWRJi\",\"man_subduction2d_rheology.md\":\"DvakcpVH\",\"man_subduction2d_setup.md\":\"DjPfYxPS\",\"man_subduction2d_subduction2d.md\":\"DvH7N08I\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"JustRelax.jl\",\"description\":\"Documentation for JustRelax.jl\",\"base\":\"/JustRelax.jl/previews/PR387/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Documentation\",\"link\":\"/man/installation\"},{\"text\":\"API\",\"link\":\"/man/listfunctions\"}],\"sidebar\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"User guide\",\"collapsed\":false,\"items\":[{\"text\":\"Installation\",\"link\":\"/man/installation\"},{\"text\":\"Backend\",\"link\":\"/man/backend\"},{\"text\":\"Equations\",\"collapsed\":false,\"items\":[{\"text\":\"Governing equations\",\"link\":\"/man/equations_basic\"},{\"text\":\"Constitutive equations\",\"link\":\"/man/constitutive_equations\"},{\"text\":\"APT equations\",\"link\":\"/man/equations_APT\"},{\"text\":\"Discretization\",\"link\":\"/man/equations_discretization\"}]},{\"text\":\"Boundary conditions\",\"link\":\"/man/boundary_conditions\"},{\"text\":\"Advection\",\"link\":\"/man/advection\"}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Blankenbach\",\"link\":\"/man/Blankenbach\"},{\"text\":\"Shear Bands\",\"link\":\"/man/ShearBands\"},{\"text\":\"Subduction 2D\",\"collapsed\":false,\"items\":[{\"text\":\"Model setup\",\"link\":\"/man/subduction2D/setup\"},{\"text\":\"Rheology\",\"link\":\"/man/subduction2D/rheology\"},{\"text\":\"Setting up the model\",\"link\":\"/man/subduction2D/subduction2D\"}]},{\"text\":\"Plume 3D\",\"collapsed\":false,\"items\":[{\"text\":\"Rheology\",\"link\":\"/man/plume3D/rheology\"},{\"text\":\"Setting up the model\",\"link\":\"/man/plume3D/plume3D\"}]},{\"text\":\"Checkpointing/Restart\",\"collapsed\":false,\"items\":[{\"text\":\"Checkpointing\",\"link\":\"/man/checkpointing\"},{\"text\":\"Restart\",\"link\":\"/man/restart\"}]}]},{\"text\":\"List of functions\",\"link\":\"/man/listfunctions\"},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"JustPIC\",\"link\":\"/man/JustPIC\"},{\"text\":\"GeoParams\",\"link\":\"/man/GeoParams\"}]},{\"text\":\"Authors\",\"link\":\"/man/authors\"},{\"text\":\"Contributing\",\"link\":\"/man/contributing\"},{\"text\":\"Code of Conduct\",\"link\":\"/man/code_of_conduct\"},{\"text\":\"Security\",\"link\":\"/man/security\"},{\"text\":\"License\",\"link\":\"/man/license\"}],\"editLink\":{\"pattern\":\"https://github.com/PTsolvers/JustRelax.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/PTsolvers/JustRelax.jl\"},{\"icon\":\"slack\",\"link\":\"https://julialang.org/slack/\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025 ⋅ The JustRelax Development Team.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>